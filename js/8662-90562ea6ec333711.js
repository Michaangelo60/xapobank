(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8662],{12036:function(e,t,n){"use strict";n.d(t,{l:function(){return r}});var r=function(){var e="ampIntegrationContext";return"undefined"!=typeof globalThis&&void 0!==globalThis[e]?globalThis[e]:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==n.g?n.g:void 0}},20147:function(e,t,n){"use strict";let r,i,o,s;n.d(t,{fh:function(){return ng},S1:function(){return np},xr:function(){return nv}}),(a=u||(u={}))[a.None=0]="None",a[a.Error=1]="Error",a[a.Warn=2]="Warn",a[a.Verbose=3]="Verbose",a[a.Debug=4]="Debug";var a,u,c,l,d,h,f,p,v,g,y,m,b,w,S,_,I,E,C,x,O,P,k,D,T,M,A,j,R,L,N=function(e,t,n,r,i){return void 0===i&&(i=null),function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var a=n(),c=a.logger,l=a.logLevel;if(l&&l<u.Debug||!l||!c)return e.apply(i,o);var d={type:"invoke public method",name:t,args:o,stacktrace:(Error().stack||"").split("\n").slice(3).map(function(e){return e.trim()}),time:{start:new Date().toISOString()},states:{}};r&&d.states&&(d.states.before=r());var h=e.apply(i,o);return h&&h.promise?h.promise.then(function(){r&&d.states&&(d.states.after=r()),d.time&&(d.time.end=new Date().toISOString()),c.debug(JSON.stringify(d,null,2))}):(r&&d.states&&(d.states.after=r()),d.time&&(d.time.end=new Date().toISOString()),c.debug(JSON.stringify(d,null,2))),h}},F=n(5853),q="Amplitude Logger ",B=function(){function e(){this.logLevel=u.None}return e.prototype.disable=function(){this.logLevel=u.None},e.prototype.enable=function(e){void 0===e&&(e=u.Warn),this.logLevel=e},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<u.Verbose||console.log("".concat(q,"[Log]: ").concat(e.join(" ")))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<u.Warn||console.warn("".concat(q,"[Warn]: ").concat(e.join(" ")))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<u.Error||console.error("".concat(q,"[Error]: ").concat(e.join(" ")))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<u.Debug||console.log("".concat(q,"[Debug]: ").concat(e.join(" ")))},e}();(w=c||(c={})).Unknown="unknown",w.Skipped="skipped",w.Success="success",w.RateLimit="rate_limit",w.PayloadTooLarge="payload_too_large",w.Invalid="invalid",w.Failed="failed",w.Timeout="Timeout",w.SystemError="SystemError";var G=function(){function e(){}return e.prototype.send=function(e,t){return Promise.resolve(null)},e.prototype.buildResponse=function(e){if("object"!=typeof e)return null;var t,n,r,i,o,s,a,u,l,d,h,f,p,v,g,y,m,b,w,S,_,I,E=e.code||0,C=this.buildStatus(E);switch(C){case c.Success:return{status:C,statusCode:E,body:{eventsIngested:null!==(t=e.events_ingested)&&void 0!==t?t:0,payloadSizeBytes:null!==(n=e.payload_size_bytes)&&void 0!==n?n:0,serverUploadTime:null!==(r=e.server_upload_time)&&void 0!==r?r:0}};case c.Invalid:return{status:C,statusCode:E,body:{error:null!==(i=e.error)&&void 0!==i?i:"",missingField:null!==(o=e.missing_field)&&void 0!==o?o:"",eventsWithInvalidFields:null!==(s=e.events_with_invalid_fields)&&void 0!==s?s:{},eventsWithMissingFields:null!==(a=e.events_with_missing_fields)&&void 0!==a?a:{},eventsWithInvalidIdLengths:null!==(u=e.events_with_invalid_id_lengths)&&void 0!==u?u:{},epsThreshold:null!==(l=e.eps_threshold)&&void 0!==l?l:0,exceededDailyQuotaDevices:null!==(d=e.exceeded_daily_quota_devices)&&void 0!==d?d:{},silencedDevices:null!==(h=e.silenced_devices)&&void 0!==h?h:[],silencedEvents:null!==(f=e.silenced_events)&&void 0!==f?f:[],throttledDevices:null!==(p=e.throttled_devices)&&void 0!==p?p:{},throttledEvents:null!==(v=e.throttled_events)&&void 0!==v?v:[]}};case c.PayloadTooLarge:return{status:C,statusCode:E,body:{error:null!==(g=e.error)&&void 0!==g?g:""}};case c.RateLimit:return{status:C,statusCode:E,body:{error:null!==(y=e.error)&&void 0!==y?y:"",epsThreshold:null!==(m=e.eps_threshold)&&void 0!==m?m:0,throttledDevices:null!==(b=e.throttled_devices)&&void 0!==b?b:{},throttledUsers:null!==(w=e.throttled_users)&&void 0!==w?w:{},exceededDailyQuotaDevices:null!==(S=e.exceeded_daily_quota_devices)&&void 0!==S?S:{},exceededDailyQuotaUsers:null!==(_=e.exceeded_daily_quota_users)&&void 0!==_?_:{},throttledEvents:null!==(I=e.throttled_events)&&void 0!==I?I:[]}};case c.Timeout:default:return{status:C,statusCode:E}}},e.prototype.buildStatus=function(e){return e>=200&&e<300?c.Success:429===e?c.RateLimit:413===e?c.PayloadTooLarge:408===e?c.Timeout:e>=400&&e<500?c.Invalid:e>=500?c.Failed:c.Unknown},e}(),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,F.ZT)(t,e),t.prototype.send=function(e,t){return(0,F.mG)(this,void 0,void 0,function(){var n,r;return(0,F.Jh)(this,function(i){switch(i.label){case 0:if("undefined"==typeof fetch)throw Error("FetchTransport is not supported");return[4,fetch(e,{headers:{"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify(t),method:"POST"})];case 1:return[4,(n=i.sent()).text()];case 2:r=i.sent();try{return[2,this.buildResponse(JSON.parse(r))]}catch(e){return[2,this.buildResponse({code:n.status})]}return[2]}})})},t}(G),U="".concat("AMP","_unsent"),z="$default_instance",W="https://api2.amplitude.com/2/httpapi",K=function(){return{flushMaxRetries:12,flushQueueSize:200,flushIntervalMillis:1e4,instanceName:z,logLevel:u.Warn,loggerProvider:new B,offline:!1,optOut:!1,serverUrl:W,serverZone:"US",useBatch:!1}},$=function(){function e(e){this._optOut=!1;var t,n,r,i,o=K();this.apiKey=e.apiKey,this.flushIntervalMillis=null!==(t=e.flushIntervalMillis)&&void 0!==t?t:o.flushIntervalMillis,this.flushMaxRetries=e.flushMaxRetries||o.flushMaxRetries,this.flushQueueSize=e.flushQueueSize||o.flushQueueSize,this.instanceName=e.instanceName||o.instanceName,this.loggerProvider=e.loggerProvider||o.loggerProvider,this.logLevel=null!==(n=e.logLevel)&&void 0!==n?n:o.logLevel,this.minIdLength=e.minIdLength,this.plan=e.plan,this.ingestionMetadata=e.ingestionMetadata,this.offline=void 0!==e.offline?e.offline:o.offline,this.optOut=null!==(r=e.optOut)&&void 0!==r?r:o.optOut,this.serverUrl=e.serverUrl,this.serverZone=e.serverZone||o.serverZone,this.storageProvider=e.storageProvider,this.transportProvider=e.transportProvider,this.useBatch=null!==(i=e.useBatch)&&void 0!==i?i:o.useBatch,this.loggerProvider.enable(this.logLevel);var s=H(e.serverUrl,e.serverZone,e.useBatch);this.serverZone=s.serverZone,this.serverUrl=s.serverUrl}return Object.defineProperty(e.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut=e},enumerable:!1,configurable:!0}),e}(),H=function(e,t,n){if(void 0===e&&(e=""),void 0===t&&(t=K().serverZone),void 0===n&&(n=K().useBatch),e)return{serverUrl:e,serverZone:void 0};var r,i=["US","EU"].includes(t)?t:K().serverZone;return{serverZone:i,serverUrl:(r=n,"EU"===i?r?"https://api.eu.amplitude.com/batch":"https://api.eu.amplitude.com/2/httpapi":r?"https://api2.amplitude.com/batch":W)}};(function(){this.sdk={metrics:{histogram:{}}}}).prototype.recordHistogram=function(e,t){this.sdk.metrics.histogram[e]=t},(S=l||(l={})).US="US",S.EU="EU",S.STAGING="STAGING";var V="[Amplitude]",Z="".concat(V," Session Replay ID"),Q=l.US,X={enabled:!0},Y="".concat(V," Session Replay Debug"),ee="amp-mask";(_=d||(d={})).GET_SR_PROPS="get-sr-props",_.DEBUG_INFO="debug-info",_.FETCH_REQUEST="fetch-request",_.METADATA="metadata",_.TARGETING_DECISION="targeting-decision";var et=function(){function e(e){this.logger=e,this.log=this.getSafeMethod("log"),this.warn=this.getSafeMethod("warn"),this.error=this.getSafeMethod("error"),this.debug=this.getSafeMethod("debug")}return e.prototype.getSafeMethod=function(e){if(!this.logger)return function(){};var t,n=this.logger[e];return"function"==typeof n?(null!==(t=n.__rrweb_original__)&&void 0!==t?t:n).bind(this.logger):function(){}},e.prototype.enable=function(e){this.logger.enable(e)},e.prototype.disable=function(){this.logger.disable()},e}(),en=n(12036),er="medium",ei=function(e,t,n){switch(t){case"light":if("input"!==e)return!0;var r,i=n?(r=n.type,n.hasAttribute("data-rr-is-password")?"password":r?r.toLowerCase():null):"";if(!i)return!1;if(["password","hidden","email","tel"].includes(i)||n.autocomplete.startsWith("cc-"))return!0;return!1;case"medium":case"conservative":return!0;default:return ei(e,er,n)}},eo=function(e,t,n){var r,i,o;if(void 0===t&&(t={defaultMaskLevel:er}),n){if(n.closest("."+ee)||(null!==(r=t.maskSelector)&&void 0!==r?r:[]).some(function(e){return n.closest(e)}))return!0;if(n.closest(".amp-unmask")||(null!==(i=t.unmaskSelector)&&void 0!==i?i:[]).some(function(e){return n.closest(e)}))return!1}return ei(e,null!==(o=t.defaultMaskLevel)&&void 0!==o?o:er,n)},es=function(e,t){return function(n,r){return eo(e,t,r)?n.replace(/[^\s]/g,"*"):n}},ea=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t},eu=function(){var e=(0,en.l)();return(null==e?void 0:e.location)?e.location.href:""},ec=function(e,t){return t||(e===l.STAGING?"https://api-sr.stag2.amplitude.com/sessions/v2/track":e===l.EU?"https://api-sr.eu.amplitude.com/sessions/v2/track":"https://api-sr.amplitude.com/sessions/v2/track")},el=function(e){var t=e.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*").replace(/\?/g,".");return new RegExp("^".concat(t,"$"))},ed=function(e){if(!e.every(function(e){return"string"==typeof e.selector&&"string"==typeof e.replacement}))throw Error("ugcFilterRules must be an array of objects with selector and replacement properties");if(!e.every(function(e){var t;return"string"==typeof(t=e.selector)&&""!==t.trim()&&!!/^\/|^https?:\/\/[^\s]+$/.test(t)}))throw Error("ugcFilterRules must be an array of objects with valid globs")},eh=function(e,t){var n,r;try{for(var i=(0,F.XA)(t),o=i.next();!o.done;o=i.next()){var s=o.value,a=el(s.selector);if(a.test(e))return e.replace(a,s.replacement)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return e},ef=function(){return(0,F.mG)(void 0,void 0,void 0,function(){var e,t,n,r;return(0,F.Jh)(this,function(i){switch(i.label){case 0:if(i.trys.push([0,3,,4]),!(e=(0,en.l)()))return[3,2];return[4,e.navigator.storage.estimate()];case 1:return n=(t=i.sent()).usage,r=t.quota,[2,{totalStorageSize:n?Math.round(n/1024):0,percentOfQuota:n&&r?Math.round((n/r+Number.EPSILON)*1e3)/1e3:0,usageDetails:JSON.stringify(t.usageDetails)}];case 2:return[3,4];case 3:return i.sent(),[3,4];case 4:return[2,{totalStorageSize:0,percentOfQuota:0,usageDetails:""}]}})})},ep=function(e){var t=(0,F.pi)({},e),n=t.apiKey;return t.apiKey="****".concat(n.substring(n.length-4)),t},ev=function(){return{flushMaxRetries:2,logLevel:u.Warn,loggerProvider:new B,transportProvider:new J}},eg=function(e){function t(t,n){var r,i,o,s,a,u=this,c=ev();return(u=e.call(this,(0,F.pi)((0,F.pi)({transportProvider:c.transportProvider,loggerProvider:new et(n.loggerProvider||c.loggerProvider)},n),{apiKey:t}))||this).flushMaxRetries=void 0!==n.flushMaxRetries&&n.flushMaxRetries<=c.flushMaxRetries?n.flushMaxRetries:c.flushMaxRetries,u.apiKey=t,u.sampleRate=n.sampleRate||0,u.serverZone=n.serverZone||Q,u.configServerUrl=n.configServerUrl,u.trackServerUrl=n.trackServerUrl,u.shouldInlineStylesheet=n.shouldInlineStylesheet,u.version=n.version,u.performanceConfig=n.performanceConfig||X,u.storeType=null!==(r=n.storeType)&&void 0!==r?r:"idb",u.applyBackgroundColorToBlockedElements=null!==(i=n.applyBackgroundColorToBlockedElements)&&void 0!==i&&i,u.enableUrlChangePolling=null!==(o=n.enableUrlChangePolling)&&void 0!==o&&o,u.urlChangePollingInterval=null!==(s=n.urlChangePollingInterval)&&void 0!==s?s:1e3,u.captureDocumentTitle=null!==(a=n.captureDocumentTitle)&&void 0!==a&&a,n.privacyConfig&&(u.privacyConfig=n.privacyConfig),n.interactionConfig&&(u.interactionConfig=n.interactionConfig,u.interactionConfig.ugcFilterRules&&ed(u.interactionConfig.ugcFilterRules)),n.debugMode&&(u.debugMode=n.debugMode),n.experimental&&(u.experimental=n.experimental),n.omitElementTags&&(u.omitElementTags=n.omitElementTags),u}return(0,F.ZT)(t,e),t}($);(I=h||(h={})).SET="$set",I.SET_ONCE="$setOnce",I.ADD="$add",I.APPEND="$append",I.PREPEND="$prepend",I.REMOVE="$remove",I.PREINSERT="$preInsert",I.POSTINSERT="$postInsert",I.UNSET="$unset",I.CLEAR_ALL="$clearAll",(E=f||(f={})).IDENTIFY="$identify",E.GROUP_IDENTIFY="$groupidentify",E.REVENUE="revenue_amount";var ey=function(e){return{promise:e||Promise.resolve()}},em=function(){function e(){}return e.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:eb(),platform:"Web",os:void 0,deviceModel:void 0}},e}(),eb=function(){return"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},ew=function(){function e(){this.queue=[]}return e.prototype.logEvent=function(e){this.receiver?this.receiver(e):this.queue.length<512&&this.queue.push(e)},e.prototype.setEventReceiver=function(e){this.receiver=e,this.queue.length>0&&(this.queue.forEach(function(t){e(t)}),this.queue=[])},e}(),eS=function(){return(eS=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function e_(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function eI(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}"function"==typeof SuppressedError&&SuppressedError;var eE=function(e,t){var n,r,i=typeof e;if(i!==typeof t)return!1;try{for(var o=e_(["string","number","boolean","undefined"]),s=o.next();!s.done;s=o.next())if(s.value===i)return e===t}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}if(null==e&&null==t)return!0;if(null==e||null==t||e.length!==t.length)return!1;var a=Array.isArray(e),u=Array.isArray(t);if(a!==u)return!1;if(a&&u){for(var c=0;c<e.length;c++)if(!eE(e[c],t[c]))return!1}else{if(!eE(Object.keys(e).sort(),Object.keys(t).sort()))return!1;var l=!0;return Object.keys(e).forEach(function(n){eE(e[n],t[n])||(l=!1)}),l}return!0};Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=Array(n);n--;)r[n]=[t[n],e[t[n]]];return r});var eC=function(){function e(){this.identity={userProperties:{}},this.listeners=new Set}return e.prototype.editIdentity=function(){var e=this,t=eS({},this.identity.userProperties),n=eS(eS({},this.identity),{userProperties:t});return{setUserId:function(e){return n.userId=e,this},setDeviceId:function(e){return n.deviceId=e,this},setUserProperties:function(e){return n.userProperties=e,this},setOptOut:function(e){return n.optOut=e,this},updateUserProperties:function(e){var t,r,i,o,s,a,u=n.userProperties||{};try{for(var c=e_(Object.entries(e)),l=c.next();!l.done;l=c.next()){var d=eI(l.value,2),h=d[0],f=d[1];switch(h){case"$set":try{for(var p=(i=void 0,e_(Object.entries(f))),v=p.next();!v.done;v=p.next()){var g=eI(v.value,2),y=g[0],m=g[1];u[y]=m}}catch(e){i={error:e}}finally{try{v&&!v.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}break;case"$unset":try{for(var b=(s=void 0,e_(Object.keys(f))),w=b.next();!w.done;w=b.next()){var y=w.value;delete u[y]}}catch(e){s={error:e}}finally{try{w&&!w.done&&(a=b.return)&&a.call(b)}finally{if(s)throw s.error}}break;case"$clearAll":u={}}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}return n.userProperties=u,this},commit:function(){return e.setIdentity(n),this}}},e.prototype.getIdentity=function(){return eS({},this.identity)},e.prototype.setIdentity=function(e){var t=eS({},this.identity);this.identity=eS({},e),eE(t,this.identity)||this.listeners.forEach(function(t){t(e)})},e.prototype.addIdentityListener=function(e){this.listeners.add(e)},e.prototype.removeIdentityListener=function(e){this.listeners.delete(e)},e}(),ex="undefined"!=typeof globalThis?globalThis:void 0!==n.g?n.g:self,eO=function(){function e(){this.identityStore=new eC,this.eventBridge=new ew,this.applicationContextProvider=new em}return e.getInstance=function(t){return ex.analyticsConnectorInstances||(ex.analyticsConnectorInstances={}),ex.analyticsConnectorInstances[t]||(ex.analyticsConnectorInstances[t]=new e),ex.analyticsConnectorInstances[t]},e}(),eP=((C=eP||{})[C.DomContentLoaded=0]="DomContentLoaded",C[C.Load=1]="Load",C[C.FullSnapshot=2]="FullSnapshot",C[C.IncrementalSnapshot=3]="IncrementalSnapshot",C[C.Meta=4]="Meta",C[C.Custom=5]="Custom",C[C.Plugin=6]="Plugin",C),ek=((x=ek||{})[x.Mutation=0]="Mutation",x[x.MouseMove=1]="MouseMove",x[x.MouseInteraction=2]="MouseInteraction",x[x.Scroll=3]="Scroll",x[x.ViewportResize=4]="ViewportResize",x[x.Input=5]="Input",x[x.TouchMove=6]="TouchMove",x[x.MediaInteraction=7]="MediaInteraction",x[x.StyleSheetRule=8]="StyleSheetRule",x[x.CanvasMutation=9]="CanvasMutation",x[x.Font=10]="Font",x[x.Log=11]="Log",x[x.Drag=12]="Drag",x[x.StyleDeclaration=13]="StyleDeclaration",x[x.Selection=14]="Selection",x[x.AdoptedStyleSheet=15]="AdoptedStyleSheet",x[x.CustomElement=16]="CustomElement",x),eD=((O=eD||{})[O.MouseUp=0]="MouseUp",O[O.MouseDown=1]="MouseDown",O[O.Click=2]="Click",O[O.ContextMenu=3]="ContextMenu",O[O.DblClick=4]="DblClick",O[O.Focus=5]="Focus",O[O.Blur=6]="Blur",O[O.TouchStart=7]="TouchStart",O[O.TouchMove_Departed=8]="TouchMove_Departed",O[O.TouchEnd=9]="TouchEnd",O[O.TouchCancel=10]="TouchCancel",O),eT=((P=eT||{})[P.Mouse=0]="Mouse",P[P.Pen=1]="Pen",P[P.Touch=2]="Touch",P),eM=((k=eM||{})[k["2D"]=0]="2D",k[k.WebGL=1]="WebGL",k[k.WebGL2=2]="WebGL2",k),eA=((D=eA||{})[D.Play=0]="Play",D[D.Pause=1]="Pause",D[D.Seeked=2]="Seeked",D[D.VolumeChange=3]="VolumeChange",D[D.RateChange=4]="RateChange",D),ej=((T=ej||{}).Start="start",T.Pause="pause",T.Resume="resume",T.Resize="resize",T.Finish="finish",T.FullsnapshotRebuilded="fullsnapshot-rebuilded",T.LoadStylesheetStart="load-stylesheet-start",T.LoadStylesheetEnd="load-stylesheet-end",T.SkipStart="skip-start",T.SkipEnd="skip-end",T.MouseInteraction="mouse-interaction",T.EventCast="event-cast",T.CustomEvent="custom-event",T.Flush="flush",T.StateChange="state-change",T.PlayBack="play-back",T.Destroy="destroy",T),eR=((M=eR||{})[M.Document=0]="Document",M[M.DocumentType=1]="DocumentType",M[M.Element=2]="Element",M[M.Text=3]="Text",M[M.CDATA=4]="CDATA",M[M.Comment=5]="Comment",M);(A=p||(p={})).Unknown="unknown",A.Skipped="skipped",A.Success="success",A.RateLimit="rate_limit",A.PayloadTooLarge="payload_too_large",A.Invalid="invalid",A.Failed="failed",A.Timeout="Timeout",A.SystemError="SystemError";var eL=function(){function e(){}return e.prototype.send=function(e,t){return Promise.resolve(null)},e.prototype.buildResponse=function(e){if("object"!=typeof e)return null;var t,n,r,i,o,s,a,u,c,l,d,h,f,v,g,y,m,b,w,S,_,I,E=e.code||0,C=this.buildStatus(E);switch(C){case p.Success:return{status:C,statusCode:E,body:{eventsIngested:null!==(t=e.events_ingested)&&void 0!==t?t:0,payloadSizeBytes:null!==(n=e.payload_size_bytes)&&void 0!==n?n:0,serverUploadTime:null!==(r=e.server_upload_time)&&void 0!==r?r:0}};case p.Invalid:return{status:C,statusCode:E,body:{error:null!==(i=e.error)&&void 0!==i?i:"",missingField:null!==(o=e.missing_field)&&void 0!==o?o:"",eventsWithInvalidFields:null!==(s=e.events_with_invalid_fields)&&void 0!==s?s:{},eventsWithMissingFields:null!==(a=e.events_with_missing_fields)&&void 0!==a?a:{},eventsWithInvalidIdLengths:null!==(u=e.events_with_invalid_id_lengths)&&void 0!==u?u:{},epsThreshold:null!==(c=e.eps_threshold)&&void 0!==c?c:0,exceededDailyQuotaDevices:null!==(l=e.exceeded_daily_quota_devices)&&void 0!==l?l:{},silencedDevices:null!==(d=e.silenced_devices)&&void 0!==d?d:[],silencedEvents:null!==(h=e.silenced_events)&&void 0!==h?h:[],throttledDevices:null!==(f=e.throttled_devices)&&void 0!==f?f:{},throttledEvents:null!==(v=e.throttled_events)&&void 0!==v?v:[]}};case p.PayloadTooLarge:return{status:C,statusCode:E,body:{error:null!==(g=e.error)&&void 0!==g?g:""}};case p.RateLimit:return{status:C,statusCode:E,body:{error:null!==(y=e.error)&&void 0!==y?y:"",epsThreshold:null!==(m=e.eps_threshold)&&void 0!==m?m:0,throttledDevices:null!==(b=e.throttled_devices)&&void 0!==b?b:{},throttledUsers:null!==(w=e.throttled_users)&&void 0!==w?w:{},exceededDailyQuotaDevices:null!==(S=e.exceeded_daily_quota_devices)&&void 0!==S?S:{},exceededDailyQuotaUsers:null!==(_=e.exceeded_daily_quota_users)&&void 0!==_?_:{},throttledEvents:null!==(I=e.throttled_events)&&void 0!==I?I:[]}};case p.Timeout:default:return{status:C,statusCode:E}}},e.prototype.buildStatus=function(e){return e>=200&&e<300?p.Success:429===e?p.RateLimit:413===e?p.PayloadTooLarge:408===e?p.Timeout:e>=400&&e<500?p.Invalid:e>=500?p.Failed:p.Unknown},e}();(j=v||(v={})).US="US",j.EU="EU",j.STAGING="STAGING";var eN="Remote config fetch rejected due to timeout after 5 seconds",eF="Unexpected error occurred",eq=function(){function e(e){var t=e.localConfig,n=e.configKeys,r=this;this.retryTimeout=1e3,this.attempts=0,this.sessionTargetingMatch=!1,this.metrics={},this.getRemoteNamespaceConfig=function(e,t){return(0,F.mG)(r,void 0,void 0,function(){var n,r,i;return(0,F.Jh)(this,function(o){switch(o.label){case 0:return n=Date.now(),[4,this.fetchWithTimeout(t)];case 1:if((r=o.sent())&&(i=r.configs&&r.configs[e]))return this.metrics.fetchTimeAPISuccess=Date.now()-n,[2,i];return this.metrics.fetchTimeAPIFail=Date.now()-n,[2,void 0]}})})},this.getRemoteConfig=function(e,t,n){return(0,F.mG)(r,void 0,void 0,function(){var r;return(0,F.Jh)(this,function(i){switch(i.label){case 0:return[4,this.getRemoteNamespaceConfig(e,n)];case 1:return[2,null==(r=i.sent())?void 0:r[t]]}})})},this.fetchWithTimeout=function(e){return(0,F.mG)(r,void 0,void 0,function(){var t,n,r;return(0,F.Jh)(this,function(i){switch(i.label){case 0:return t=new AbortController,n=setTimeout(function(){return t.abort()},5e3),[4,this.fetchRemoteConfig(t.signal,e)];case 1:return r=i.sent(),clearTimeout(n),[2,r]}})})},this.fetchRemoteConfig=function(e,t){return(0,F.mG)(r,void 0,void 0,function(){var n,r,i,o,s,a,u,c,l,d,h;return(0,F.Jh)(this,function(f){switch(f.label){case 0:if(t===this.lastFetchedSessionId&&this.attempts>=this.localConfig.flushMaxRetries)return[2,this.completeRequest({err:"Remote config fetch rejected due to exceeded retry count"})];if(e.aborted)return[2,this.completeRequest({err:eN})];t!==this.lastFetchedSessionId&&(this.lastFetchedSessionId=t,this.attempts=0),f.label=1;case 1:f.trys.push([1,3,,4]),n=new URLSearchParams({api_key:this.localConfig.apiKey});try{for(i=(r=(0,F.XA)(this.configKeys)).next();!i.done;i=r.next())o=i.value,n.append("config_keys",o)}catch(e){l={error:e}}finally{try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(l)throw l.error}}return t&&n.set("session_id",String(t)),s={headers:{Accept:"*/*"},method:"GET"},a="".concat(this.getServerUrl(),"?").concat(n.toString()),this.attempts+=1,[4,fetch(a,(0,F.pi)((0,F.pi)({},s),{signal:e}))];case 2:if(null===(u=f.sent()))return[2,this.completeRequest({err:eF})];switch(new eL().buildStatus(u.status)){case p.Success:return this.attempts=0,[2,this.parseAndStoreConfig(u)];case p.Failed:return[2,this.retryFetch(e,t)];default:return[2,this.completeRequest({err:"Network error occurred, remote config fetch failed"})]}return[3,4];case 3:if(c=f.sent(),e.aborted)return[2,this.completeRequest({err:eN})];return[2,this.completeRequest({err:null!==(h=c.message)&&void 0!==h?h:eF})];case 4:return[2]}})})},this.retryFetch=function(e,t){return(0,F.mG)(r,void 0,void 0,function(){var n=this;return(0,F.Jh)(this,function(r){switch(r.label){case 0:return[4,new Promise(function(e){return setTimeout(e,n.attempts*n.retryTimeout)})];case 1:return r.sent(),[2,this.fetchRemoteConfig(e,t)]}})})},this.parseAndStoreConfig=function(e){return(0,F.mG)(r,void 0,void 0,function(){var t;return(0,F.Jh)(this,function(n){switch(n.label){case 0:return[4,e.json()];case 1:return t=n.sent(),this.completeRequest({success:"Remote config successfully fetched"}),[2,t]}})})},this.localConfig=t,this.configKeys=n}return e.prototype.getServerUrl=function(){return this.localConfig.configServerUrl?this.localConfig.configServerUrl:this.localConfig.serverZone===v.STAGING?"https://sr-client-cfg.stag2.amplitude.com/config":this.localConfig.serverZone===v.EU?"https://sr-client-cfg.eu.amplitude.com/config":"https://sr-client-cfg.amplitude.com/config"},e.prototype.completeRequest=function(e){var t=e.err,n=e.success;if(t)throw Error(t);n&&this.localConfig.loggerProvider.log(n)},e}(),eB=function(e){var t=e.localConfig,n=e.configKeys;return(0,F.mG)(void 0,void 0,void 0,function(){return(0,F.Jh)(this,function(e){return[2,new eq({localConfig:t,configKeys:n})]})})},eG=function(e,t){var n=document.createDocumentFragment(),r=function(e){if(void 0===e&&(e=[]),"string"==typeof e&&(e=[e]),0!==(e=e.filter(function(e){try{n.querySelector(e)}catch(n){return t.warn('[session-replay-browser] omitting selector "'.concat(e,'" because it is invalid')),!1}return!0})).length)return e};return e.blockSelector=r(e.blockSelector),e.maskSelector=r(e.maskSelector),e.unmaskSelector=r(e.unmaskSelector),e},eJ=function(){function e(e,t){this.localConfig=t,this.remoteConfigFetch=e}return e.prototype.generateJoinedConfig=function(e){var t,n,r,i;return(0,F.mG)(this,void 0,void 0,function(){var o,s,a,u,c,l,d,h,f,p,v,g,y,m,b,w,S,_,I,E,C,x;return(0,F.Jh)(this,function(O){switch(O.label){case 0:(o=(0,F.pi)({},this.localConfig)).optOut=this.localConfig.optOut,o.captureEnabled=!0,O.label=1;case 1:return O.trys.push([1,3,,4]),[4,this.remoteConfigFetch.getRemoteNamespaceConfig("sessionReplay",e)];case 2:return(a=O.sent())&&(u=a.sr_sampling_config,c=a.sr_privacy_config,l=a.sr_targeting_config,d=null===(t=o.interactionConfig)||void 0===t?void 0:t.ugcFilterRules,o.interactionConfig=a.sr_interaction_config,o.interactionConfig&&d&&(o.interactionConfig.ugcFilterRules=d),o.loggingConfig=a.sr_logging_config,(u||c||l)&&(s={},u&&(s.sr_sampling_config=u),c&&(s.sr_privacy_config=c),l&&(s.sr_targeting_config=l))),[3,4];case 3:return h=O.sent(),this.localConfig.loggerProvider.warn(h.message),o.captureEnabled=!1,[3,4];case 4:if(!s)return[2,{localConfig:this.localConfig,joinedConfig:o,remoteConfig:s}];if(f=s.sr_sampling_config,p=s.sr_privacy_config,v=s.sr_targeting_config,f&&Object.keys(f).length>0?(Object.prototype.hasOwnProperty.call(f,"capture_enabled")?o.captureEnabled=f.capture_enabled:o.captureEnabled=!1,Object.prototype.hasOwnProperty.call(f,"sample_rate")&&(o.sampleRate=f.sample_rate)):(o.captureEnabled=!0,this.localConfig.loggerProvider.debug("Remote config successfully fetched, but no values set for project, Session Replay capture enabled.")),p){g=null!==(n=o.privacyConfig)&&void 0!==n?n:{},y={defaultMaskLevel:null!==(i=null!==(r=p.defaultMaskLevel)&&void 0!==r?r:g.defaultMaskLevel)&&void 0!==i?i:"medium",blockSelector:[],maskSelector:[],unmaskSelector:[]},m=function(e){var t,n,r,i,o,s,a,u,c,l={};"string"==typeof e.blockSelector&&(e.blockSelector=[e.blockSelector]);try{for(var d=(0,F.XA)(null!==(a=e.blockSelector)&&void 0!==a?a:[]),h=d.next();!h.done;h=d.next()){var f=h.value;l[f]="block"}}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}try{for(var p=(0,F.XA)(null!==(u=e.maskSelector)&&void 0!==u?u:[]),v=p.next();!v.done;v=p.next()){var f=v.value;l[f]="mask"}}catch(e){r={error:e}}finally{try{v&&!v.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}try{for(var g=(0,F.XA)(null!==(c=e.unmaskSelector)&&void 0!==c?c:[]),y=g.next();!y.done;y=g.next()){var f=y.value;l[f]="unmask"}}catch(e){o={error:e}}finally{try{y&&!y.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}return l},b=(0,F.pi)((0,F.pi)({},m(g)),m(p));try{for(S=(w=(0,F.XA)(Object.entries(b))).next();!S.done;S=w.next())I=(_=(0,F.CR)(S.value,2))[0],E=_[1],"mask"===E?y.maskSelector.push(I):"block"===E?y.blockSelector.push(I):"unmask"===E&&y.unmaskSelector.push(I)}catch(e){C={error:e}}finally{try{S&&!S.done&&(x=w.return)&&x.call(w)}finally{if(C)throw C.error}}o.privacyConfig=eG(y,this.localConfig.loggerProvider)}return v&&Object.keys(v).length>0&&(o.targetingConfig=v),this.localConfig.loggerProvider.debug(JSON.stringify({name:"session replay joined config",config:ep(o)},null,2)),[2,{localConfig:this.localConfig,joinedConfig:o,remoteConfig:s}]}})})},e}(),eU=Uint8Array,ez=Uint16Array,eW=Uint32Array,eK=new eU([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e$=new eU([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),eH=new eU([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),eV=function(e,t){for(var n=new ez(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new eW(n[30]),r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return[n,i]},eZ=eV(eK,2),eQ=eZ[0],eX=eZ[1];eQ[28]=258,eX[258]=28;for(var eY=eV(e$,0),e0=(eY[0],eY[1]),e1=new ez(32768),e2=0;e2<32768;++e2){var e3=(43690&e2)>>>1|(21845&e2)<<1;e3=(61680&(e3=(52428&e3)>>>2|(13107&e3)<<2))>>>4|(3855&e3)<<4,e1[e2]=((65280&e3)>>>8|(255&e3)<<8)>>>1}for(var e4=function(e,t,n){for(var r,i=e.length,o=0,s=new ez(t);o<i;++o)++s[e[o]-1];var a=new ez(t);for(o=0;o<t;++o)a[o]=a[o-1]+s[o-1]<<1;if(n){r=new ez(1<<t);var u=15-t;for(o=0;o<i;++o)if(e[o])for(var c=o<<4|e[o],l=t-e[o],d=a[e[o]-1]++<<l,h=d|(1<<l)-1;d<=h;++d)r[e1[d]>>>u]=c}else for(o=0,r=new ez(i);o<i;++o)r[o]=e1[a[e[o]-1]++]>>>15-e[o];return r},e5=new eU(288),e2=0;e2<144;++e2)e5[e2]=8;for(var e2=144;e2<256;++e2)e5[e2]=9;for(var e2=256;e2<280;++e2)e5[e2]=7;for(var e2=280;e2<288;++e2)e5[e2]=8;for(var e6=new eU(32),e2=0;e2<32;++e2)e6[e2]=5;var e8=e4(e5,9,0),e9=e4(e6,5,0),e7=function(e){return(e/8>>0)+(7&e&&1)},te=function(e,t,n){(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof ez?ez:e instanceof eW?eW:eU)(n-t);return r.set(e.subarray(t,n)),r},tt=function(e,t,n){n<<=7&t;var r=t/8>>0;e[r]|=n,e[r+1]|=n>>>8},tn=function(e,t,n){n<<=7&t;var r=t/8>>0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},tr=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,o=n.slice();if(!i)return[new eU(0),0];if(1==i){var s=new eU(n[0].s+1);return s[n[0].s]=1,[s,1]}n.sort(function(e,t){return e.f-t.f}),n.push({s:-1,f:25001});var a=n[0],u=n[1],c=0,l=1,d=2;for(n[0]={s:-1,f:a.f+u.f,l:a,r:u};l!=i-1;)a=n[n[c].f<n[d].f?c++:d++],u=n[c!=l&&n[c].f<n[d].f?c++:d++],n[l++]={s:-1,f:a.f+u.f,l:a,r:u};for(var h=o[0].s,r=1;r<i;++r)o[r].s>h&&(h=o[r].s);var f=new ez(h+1),p=ti(n[l-1],f,0);if(p>t){var r=0,v=0,g=p-t,y=1<<g;for(o.sort(function(e,t){return f[t.s]-f[e.s]||e.f-t.f});r<i;++r){var m=o[r].s;if(f[m]>t)v+=y-(1<<p-f[m]),f[m]=t;else break}for(v>>>=g;v>0;){var b=o[r].s;f[b]<t?v-=1<<t-f[b]++-1:++r}for(;r>=0&&v;--r){var w=o[r].s;f[w]==t&&(--f[w],++v)}p=t}return[new eU(f),p]},ti=function(e,t,n){return -1==e.s?Math.max(ti(e.l,t,n+1),ti(e.r,t,n+1)):t[e.s]=n},to=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new ez(++t),r=0,i=e[0],o=1,s=function(e){n[r++]=e},a=1;a<=t;++a)if(e[a]==i&&a!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=e[a]}return[n.subarray(0,r),t]},ts=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},ta=function(e,t,n){var r=n.length,i=e7(t+2);e[i]=255&r,e[i+1]=r>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var o=0;o<r;++o)e[i+o+4]=n[o];return(i+4+r)*8},tu=function(e,t,n,r,i,o,s,a,u,c,l){tt(t,l++,n),++i[256];for(var d,h,f,p,v=tr(i,15),g=v[0],y=v[1],m=tr(o,15),b=m[0],w=m[1],S=to(g),_=S[0],I=S[1],E=to(b),C=E[0],x=E[1],O=new ez(19),P=0;P<_.length;++P)O[31&_[P]]++;for(var P=0;P<C.length;++P)O[31&C[P]]++;for(var k=tr(O,7),D=k[0],T=k[1],M=19;M>4&&!D[eH[M-1]];--M);var A=c+5<<3,j=ts(i,e5)+ts(o,e6)+s,R=ts(i,g)+ts(o,b)+s+14+3*M+ts(O,D)+(2*O[16]+3*O[17]+7*O[18]);if(A<=j&&A<=R)return ta(t,l,e.subarray(u,u+c));if(tt(t,l,1+(R<j)),l+=2,R<j){d=e4(g,y,0),h=g,f=e4(b,w,0),p=b;var L=e4(D,T,0);tt(t,l,I-257),tt(t,l+5,x-1),tt(t,l+10,M-4),l+=14;for(var P=0;P<M;++P)tt(t,l+3*P,D[eH[P]]);l+=3*M;for(var N=[_,C],F=0;F<2;++F)for(var q=N[F],P=0;P<q.length;++P){var B=31&q[P];tt(t,l,L[B]),l+=D[B],B>15&&(tt(t,l,q[P]>>>5&127),l+=q[P]>>>12)}}else d=e8,h=e5,f=e9,p=e6;for(var P=0;P<a;++P)if(r[P]>255){var B=r[P]>>>18&31;tn(t,l,d[B+257]),l+=h[B+257],B>7&&(tt(t,l,r[P]>>>23&31),l+=eK[B]);var G=31&r[P];tn(t,l,f[G]),l+=p[G],G>3&&(tn(t,l,r[P]>>>5&8191),l+=e$[G])}else tn(t,l,d[r[P]]),l+=h[r[P]];return tn(t,l,d[256]),l+h[256]},tc=new eW([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),tl=function(e,t,n,r,i,o){var s=e.length,a=new eU(r+s+5*(1+Math.floor(s/7e3))+i),u=a.subarray(r,a.length-i),c=0;if(!t||s<8)for(var l=0;l<=s;l+=65535){var d=l+65535;d<s?c=ta(u,c,e.subarray(l,d)):(u[l]=o,c=ta(u,c,e.subarray(l,s)))}else{for(var h=tc[t-1],f=h>>>13,p=8191&h,v=(1<<n)-1,g=new ez(32768),y=new ez(v+1),m=Math.ceil(n/3),b=2*m,w=function(t){return(e[t]^e[t+1]<<m^e[t+2]<<b)&v},S=new eW(25e3),_=new ez(288),I=new ez(32),E=0,C=0,l=0,x=0,O=0,P=0;l<s;++l){var k=w(l),D=32767&l,T=y[k];if(g[D]=T,y[k]=D,O<=l){var M=s-l;if((E>7e3||x>24576)&&M>423){c=tu(e,u,0,S,_,I,C,x,P,l-P,c),x=E=C=0,P=l;for(var A=0;A<286;++A)_[A]=0;for(var A=0;A<30;++A)I[A]=0}var j=2,R=0,L=p,N=D-T&32767;if(M>2&&k==w(l-N))for(var F=Math.min(f,M)-1,q=Math.min(32767,l),B=Math.min(258,M);N<=q&&--L&&D!=T;){if(e[l+j]==e[l+j-N]){for(var G=0;G<B&&e[l+G]==e[l+G-N];++G);if(G>j){if(j=G,R=N,G>F)break;for(var J=Math.min(N,G-2),U=0,A=0;A<J;++A){var z=l-N+A+32768&32767,W=g[z],K=z-W+32768&32767;K>U&&(U=K,T=z)}}}T=g[D=T],N+=D-T+32768&32767}if(R){S[x++]=268435456|eX[j]<<18|e0[R];var $=31&eX[j],H=31&e0[R];C+=eK[$]+e$[H],++_[257+$],++I[H],O=l+j,++E}else S[x++]=e[l],++_[e[l]]}}c=tu(e,u,o,S,_,I,C,x,P,l-P,c)}return te(a,0,r+e7(c)+i)},td=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,o=n.length,s=0;s!=o;){for(var a=Math.min(s+5552,o);s<a;++s)r+=n[s],i+=r;r%=65521,i%=65521}e=r,t=i},d:function(){return(e>>>8<<16|(255&t)<<8|t>>>8)+((255&e)<<23)*2}}},th=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},tf=function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;e[0]=120,e[1]=r<<6|(r?32-2*r:1)};let tp=e=>{var t,n,r,i,o;return function(e,t){var n="";if(!t&&"undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);for(var r=0;r<e.length;){var i=e[r++];i<128||t?n+=String.fromCharCode(i):i<224?n+=String.fromCharCode((31&i)<<6|63&e[r++]):i<240?n+=String.fromCharCode((15&i)<<12|(63&e[r++])<<6|63&e[r++]):n+=String.fromCharCode(55296|(i=((15&i)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536)>>10,56320|1023&i)}return n}((t=function(e,t){var n=e.length;if("undefined"!=typeof TextEncoder)return new TextEncoder().encode(e);for(var r=new eU(e.length+(e.length>>>1)),i=0,o=function(e){r[i++]=e},s=0;s<n;++s){if(i+5>r.length){var a=new eU(i+8+(n-s<<1));a.set(r),r=a}var u=e.charCodeAt(s);u<128?o(u):(u<2048?o(192|u>>>6):(u>55295&&u<57344?(o(240|(u=65536+(1047552&u)|1023&e.charCodeAt(++s))>>>18),o(128|u>>>12&63)):o(224|u>>>12),o(128|u>>>6&63)),o(128|63&u))}return te(r,0,i)}(JSON.stringify({...e,v:"v1"})),void 0===n&&(n={}),(r=td()).p(t),tf(o=tl(t,null==(i=n).level?6:i.level,null==i.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+i.mem,2,4,!0),n),th(o,o.length-4,r.d()),o),!0)};var tv=function(){function e(e,t,n,r){var i,o,s,a=this;this.taskQueue=[],this.isProcessing=!1,this.compressEvent=function(e){return JSON.stringify(tp(e))},this.addCompressedEventToManager=function(e,t){a.eventsManager&&a.deviceId&&a.eventsManager.addEvent({event:{type:"replay",data:e},sessionId:t,deviceId:a.deviceId})},this.addCompressedEvent=function(e,t){if(a.worker)a.worker.postMessage({event:e,sessionId:t});else{var n=a.compressEvent(e);a.addCompressedEventToManager(n,t)}},this.terminate=function(){var e;null===(e=a.worker)||void 0===e||e.terminate()};var u=(0,en.l)();this.canUseIdleCallback=u&&"requestIdleCallback"in u,this.eventsManager=e,this.config=t,this.deviceId=n,this.timeout=(null===(i=t.performanceConfig)||void 0===i?void 0:i.timeout)||2e3;var c=null!==(o=({}).COMPRESSION_WEBWORKER_BODY)&&void 0!==o?o:r;if((null===(s=this.config.experimental)||void 0===s?void 0:s.useWebWorker)&&u&&u.Worker&&c){t.loggerProvider.log("[Experimental] Enabling web worker for compression");var l=new Worker(URL.createObjectURL(new Blob([c],{type:"application/javascript"})));l.onerror=function(e){t.loggerProvider.error(e)},l.onmessage=function(e){var t=e.data,n=t.compressedEvent,r=t.sessionId;a.addCompressedEventToManager(n,r)},this.worker=l}}return e.prototype.scheduleIdleProcessing=function(){var e=this;this.isProcessing||(this.isProcessing=!0,requestIdleCallback(function(t){e.processQueue(t)},{timeout:this.timeout}))},e.prototype.enqueueEvent=function(e,t){var n;this.canUseIdleCallback&&(null===(n=this.config.performanceConfig)||void 0===n?void 0:n.enabled)?(this.config.loggerProvider.debug("Enqueuing event for processing during idle time."),this.taskQueue.push({event:e,sessionId:t}),this.scheduleIdleProcessing()):(this.config.loggerProvider.debug("Processing event without idle callback."),this.addCompressedEvent(e,t))},e.prototype.processQueue=function(e){for(var t=this;this.taskQueue.length>0&&(e.timeRemaining()>0||e.didTimeout);){var n=this.taskQueue.shift();if(n){var r=n.event,i=n.sessionId;this.addCompressedEvent(r,i)}}this.taskQueue.length>0?requestIdleCallback(function(e){t.processQueue(e)},{timeout:this.timeout}):this.isProcessing=!1},e}(),tg="Failed to store session replay events in IndexedDB",ty="1.28.1",tm=function(){function e(e){var t=e.trackServerUrl,n=e.loggerProvider,r=e.payloadBatcher;this.storageKey="",this.retryTimeout=1e3,this.scheduled=null,this.queue=[],this.loggerProvider=n,this.payloadBatcher=r||function(e){return e},this.trackServerUrl=t}return e.prototype.sendEventsList=function(e){this.addToQueue((0,F.pi)((0,F.pi)({},e),{attempts:0,timeout:0}))},e.prototype.addToQueue=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.filter(function(t){return t.attempts<(t.flushMaxRetries||0)?(t.attempts+=1,!0):(e.completeRequest({context:t,err:"Session replay event batch rejected due to exceeded retry count"}),!1)}).forEach(function(t){if(e.queue=e.queue.concat(t),0===t.timeout){e.schedule(0);return}setTimeout(function(){t.timeout=0,e.schedule(0)},t.timeout)})},e.prototype.schedule=function(e){var t=this;this.scheduled||(this.scheduled=setTimeout(function(){t.flush(!0).then(function(){t.queue.length>0&&t.schedule(e)})},e))},e.prototype.flush=function(e){return void 0===e&&(e=!1),(0,F.mG)(this,void 0,void 0,function(){var t,n,r=this;return(0,F.Jh)(this,function(i){switch(i.label){case 0:return t=[],n=[],this.queue.forEach(function(e){return 0===e.timeout?t.push(e):n.push(e)}),this.queue=n,this.scheduled&&(clearTimeout(this.scheduled),this.scheduled=null),[4,Promise.all(t.map(function(t){return r.send(t,e)}))];case 1:return i.sent(),[2]}})})},e.prototype.send=function(e,t){var n,r;return void 0===t&&(t=!0),(0,F.mG)(this,void 0,void 0,function(){var i,o,s,a,u,c,l,d,h,f,p,v;return(0,F.Jh)(this,function(g){switch(g.label){case 0:if(!(i=e.apiKey))return[2,this.completeRequest({context:e,err:"Session replay event batch not sent due to missing api key"})];if(!(o=e.deviceId))return[2,this.completeRequest({context:e,err:"Session replay event batch not sent due to missing device ID"})];if(s=eu(),a=ty,u=e.sampleRate,c=new URLSearchParams({device_id:o,session_id:"".concat(e.sessionId),type:"".concat(e.type)}),l="".concat((null===(n=e.version)||void 0===n?void 0:n.type)||"standalone","/").concat((null===(r=e.version)||void 0===r?void 0:r.version)||a),0===(d=this.payloadBatcher({version:1,events:e.events})).events.length)return this.completeRequest({context:e}),[2];g.label=1;case 1:return g.trys.push([1,3,,4]),h={headers:{"Content-Type":"application/json",Accept:"*/*",Authorization:"Bearer ".concat(i),"X-Client-Version":a,"X-Client-Library":l,"X-Client-Url":s.substring(0,1e3),"X-Client-Sample-Rate":"".concat(u)},body:JSON.stringify(d),method:"POST"},[4,fetch("".concat(ec(e.serverZone,this.trackServerUrl),"?").concat(c.toString()),h)];case 2:if(null===(f=g.sent()))return this.completeRequest({context:e,err:"Unexpected error occurred"}),[2];if(t)this.handleReponse(f.status,e);else{p="";try{p=JSON.stringify(f.body,null,2)}catch(e){}this.completeRequest({context:e,success:"".concat(f.status,": ").concat(p)})}return[3,4];case 3:return v=g.sent(),this.completeRequest({context:e,err:v}),[3,4];case 4:return[2]}})})},e.prototype.handleReponse=function(e,t){switch(new G().buildStatus(e)){case c.Success:this.handleSuccessResponse(t);break;case c.Failed:this.handleOtherResponse(t);break;default:this.completeRequest({context:t,err:"Network error occurred, event batch rejected"})}},e.prototype.handleSuccessResponse=function(e){var t=Math.round(new Blob(e.events).size/1024);this.completeRequest({context:e,success:"Session replay event batch tracked successfully for session id ".concat(e.sessionId,", size of events: ").concat(t," KB")})},e.prototype.handleOtherResponse=function(e){this.addToQueue((0,F.pi)((0,F.pi)({},e),{timeout:e.attempts*this.retryTimeout}))},e.prototype.completeRequest=function(e){var t=e.context,n=e.err,r=e.success;t.onComplete(),n?this.loggerProvider.warn(n):r&&this.loggerProvider.log(r)},e}();let tb=(e,t)=>t.some(t=>e instanceof t),tw=new WeakMap,tS=new WeakMap,t_=new WeakMap,tI={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return tw.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return tE(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function tE(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(tE(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)});return t_.set(t,e),t}(e);if(tS.has(e))return tS.get(e);let n="function"==typeof(t=e)?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(tC(this),e),tE(this.request)}:function(...e){return tE(t.apply(tC(this),e))}:(t instanceof IDBTransaction&&function(e){if(tw.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});tw.set(e,t)}(t),tb(t,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,tI):t;return n!==e&&(tS.set(e,n),t_.set(n,e)),n}let tC=e=>t_.get(e);function tx(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){let s=indexedDB.open(e,t),a=tE(s);return r&&s.addEventListener("upgradeneeded",e=>{r(tE(s.result),e.oldVersion,e.newVersion,tE(s.transaction),e)}),n&&s.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}let tO=["get","getKey","getAll","getAllKeys","count"],tP=["put","add","delete","clear"],tk=new Map;function tD(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(tk.get(t))return tk.get(t);let n=t.replace(/FromIndex$/,""),r=t!==n,i=tP.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||tO.includes(n)))return;let o=async function(e,...t){let o=this.transaction(e,i?"readwrite":"readonly"),s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&o.done]))[0]};return tk.set(t,o),o}tI={...o=tI,get:(e,t,n)=>tD(e,t)||o.get(e,t,n),has:(e,t)=>!!tD(e,t)||o.has(e,t)};let tT=["continue","continuePrimaryKey","advance"],tM={},tA=new WeakMap,tj=new WeakMap,tR={get(e,t){if(!tT.includes(t))return e[t];let n=tM[t];return n||(n=tM[t]=function(...e){tA.set(this,tj.get(this)[t](...e))}),n}};async function*tL(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let n=new Proxy(t,tR);for(tj.set(n,t),t_.set(n,tC(t));t;)yield n,t=await (tA.get(n)||t.continue()),tA.delete(n)}function tN(e,t){return t===Symbol.asyncIterator&&tb(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&tb(e,[IDBIndex,IDBObjectStore])}tI={...s=tI,get:(e,t,n)=>tN(e,t)?tL:s.get(e,t,n),has:(e,t)=>tN(e,t)||s.has(e,t)};var tF=function(){function e(e){var t,n,r,i=this;this.minInterval=500,this.maxInterval=1e4,this.maxPersistedEventsSize=1e6,this.interval=this.minInterval,this._timeAtLastSplit=Date.now(),this.shouldSplitEventsList=function(e,t){var n=i.getStringSize(t);return i.getEventsArraySize(e)+n>=i.maxPersistedEventsSize||Date.now()-i.timeAtLastSplit>i.interval&&!!e.length&&(i.interval=Math.min(i.maxInterval,i.interval+i.minInterval),i._timeAtLastSplit=Date.now(),!0)},this.loggerProvider=e.loggerProvider,this.minInterval=null!==(t=e.minInterval)&&void 0!==t?t:this.minInterval,this.maxInterval=null!==(n=e.maxInterval)&&void 0!==n?n:this.maxInterval,this.maxPersistedEventsSize=null!==(r=e.maxPersistedEventsSize)&&void 0!==r?r:this.maxPersistedEventsSize}return Object.defineProperty(e.prototype,"timeAtLastSplit",{get:function(){return this._timeAtLastSplit},enumerable:!1,configurable:!0}),e.prototype.getStringSize=function(e){return e.length},e.prototype.getEventsArraySize=function(e){var t,n,r=0;try{for(var i=(0,F.XA)(e),o=i.next();!o.done;o=i.next()){var s=o.value;r+=this.getStringSize(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r+(2+Math.max(0,e.length-1)+2*e.length)},e}();(R=g||(g={})).RECORDING="recording",R.SENT="sent";var tq="sessionCurrentSequence",tB="sequencesToSend",tG=function(){var e=(0,en.l)();return new Promise(function(t,n){if(!e)return n(Error("Global scope not found"));if(!e.indexedDB)return n(Error("Session Replay: cannot find indexedDB"));try{var r=e.indexedDB.open("keyval-store");r.onupgradeneeded=function(){1===r.result.version&&(r.result.close(),r.transaction&&r.transaction.abort(),e.indexedDB.deleteDatabase("keyval-store"),t())},r.onsuccess=function(){t(r.result)},r.onerror=function(){n(r.error)}}catch(e){n(e)}})},tJ=function(e){return(0,F.mG)(void 0,void 0,void 0,function(){return(0,F.Jh)(this,function(t){switch(t.label){case 0:if(!(e.length>0))return[3,2];return[4,Promise.all(e.splice(0,10))];case 1:return t.sent(),[3,0];case 2:return[2]}})})},tU=function(e){var t,n;return e.objectStoreNames.contains(tq)||(n=e.createObjectStore(tq,{keyPath:"sessionId"})),e.objectStoreNames.contains(tB)||(t=e.createObjectStore(tB,{keyPath:"sequenceId",autoIncrement:!0})).createIndex("sessionId","sessionId"),{sequencesStore:t,currentSequenceStore:n}},tz=function(e){function t(t){var n=e.call(this,t)||this;return n.getSequencesToSend=function(){return(0,F.mG)(n,void 0,void 0,function(){var e,t,n,r,i,o;return(0,F.Jh)(this,function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),e=[],[4,this.db.transaction("sequencesToSend").store.openCursor()];case 1:t=s.sent(),s.label=2;case 2:if(!t)return[3,4];return r=(n=t.value).sessionId,i=n.events,e.push({events:i,sequenceId:t.key,sessionId:r}),[4,t.continue()];case 3:return t=s.sent(),[3,2];case 4:return[2,e];case 5:return o=s.sent(),this.loggerProvider.warn("".concat(tg,": ").concat(o)),[3,6];case 6:return[2,void 0]}})})},n.storeCurrentSequence=function(e){return(0,F.mG)(n,void 0,void 0,function(){var t,n,r;return(0,F.Jh)(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),[4,this.db.get(tq,e)];case 1:if(!(t=i.sent()))return[2,void 0];return[4,this.db.put(tB,{sessionId:e,events:t.events})];case 2:return n=i.sent(),[4,this.db.put(tq,{sessionId:e,events:[]})];case 3:return i.sent(),[2,(0,F.pi)((0,F.pi)({},t),{sessionId:e,sequenceId:n})];case 4:return r=i.sent(),this.loggerProvider.warn("".concat(tg,": ").concat(r)),[3,5];case 5:return[2,void 0]}})})},n.addEventToCurrentSequence=function(e,t){return(0,F.mG)(n,void 0,void 0,function(){var n,r,i,o,s,a;return(0,F.Jh)(this,function(u){switch(u.label){case 0:return u.trys.push([0,10,,11]),[4,(n=this.db.transaction(tq,"readwrite")).store.get(e)];case 1:if(r=u.sent())return[3,3];return[4,n.store.put({sessionId:e,events:[t]})];case 2:return u.sent(),[2];case 3:if(i=void 0,!this.shouldSplitEventsList(r.events,t))return[3,5];return i=r.events,[4,n.store.put({sessionId:e,events:[t]})];case 4:return u.sent(),[3,7];case 5:return o=r.events.concat(t),[4,n.store.put({sessionId:e,events:o})];case 6:u.sent(),u.label=7;case 7:return[4,n.done];case 8:if(u.sent(),!i)return[2,void 0];return[4,this.storeSendingEvents(e,i)];case 9:if(!(s=u.sent()))return[2,void 0];return[2,{events:i,sessionId:e,sequenceId:s}];case 10:return a=u.sent(),this.loggerProvider.warn("".concat(tg,": ").concat(a)),[3,11];case 11:return[2,void 0]}})})},n.storeSendingEvents=function(e,t){return(0,F.mG)(n,void 0,void 0,function(){var n;return(0,F.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.db.put(tB,{sessionId:e,events:t})];case 1:return[2,r.sent()];case 2:return n=r.sent(),this.loggerProvider.warn("".concat(tg,": ").concat(n)),[3,3];case 3:return[2,void 0]}})})},n.cleanUpSessionEventsStore=function(e,t){return(0,F.mG)(n,void 0,void 0,function(){var e;return(0,F.Jh)(this,function(n){switch(n.label){case 0:if(!t)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.db.delete(tB,t)];case 2:return n.sent(),[3,4];case 3:return e=n.sent(),this.loggerProvider.warn("".concat(tg,": ").concat(e)),[3,4];case 4:return[2]}})})},n.transitionFromKeyValStore=function(e){return(0,F.mG)(n,void 0,void 0,function(){var t,n,r,i,o,s,a,u=this;return(0,F.Jh)(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,tG()];case 1:if(!(t=c.sent()))return[2];n=function(e,t){return(0,F.mG)(u,void 0,void 0,function(){var n,r,i=this;return(0,F.Jh)(this,function(o){switch(o.label){case 0:return n=t.sessionSequences,r=[],Object.keys(n).forEach(function(o){var s=parseInt(o,10),a=n[s];if(s===t.currentSequenceId){var u=a.events.map(function(t){return(0,F.mG)(i,void 0,void 0,function(){return(0,F.Jh)(this,function(n){return[2,this.addEventToCurrentSequence(e,t)]})})});r.push.apply(r,(0,F.ev)([],(0,F.CR)(u),!1))}else a.status!==g.SENT&&r.push(i.storeSendingEvents(e,a.events))}),[4,tJ(r)];case 1:return o.sent(),[2]}})})},r="".concat(U,"_").concat(this.apiKey.substring(0,10)),c.label=2;case 2:return c.trys.push([2,4,,5]),i=t.transaction("keyval").objectStore("keyval").getAll(r),[4,new Promise(function(t){i.onsuccess=function(r){return(0,F.mG)(u,void 0,void 0,function(){var i,o,s,a=this;return(0,F.Jh)(this,function(u){switch(u.label){case 0:if(!(o=(i=r&&r.target.result)&&i[0]))return[3,2];return s=[],Object.keys(o).forEach(function(t){var r=parseInt(t,10),i=o[r];if(e===r)s.push(n(r,i));else{var u=i.sessionSequences;Object.keys(u).forEach(function(e){var t=parseInt(e,10);u[t].status!==g.SENT&&s.push(a.storeSendingEvents(r,u[t].events))})}}),[4,tJ(s)];case 1:u.sent(),u.label=2;case 2:return t(),[2]}})})}})];case 3:return c.sent(),(o=(0,en.l)())&&o.indexedDB.deleteDatabase("keyval-store"),[3,5];case 4:return s=c.sent(),this.loggerProvider.warn("Failed to transition session replay events from keyval to new store: ".concat(s)),[3,5];case 5:return[3,7];case 6:return a=c.sent(),this.loggerProvider.warn("Failed to access keyval store: ".concat(a,". For more information, visit: https://www.docs.developers.amplitude.com/session-replay/sdks/standalone/#indexeddb-best-practices")),[3,7];case 7:return[2]}})})},n.apiKey=t.apiKey,n.db=t.db,n}return(0,F.ZT)(t,e),t.new=function(e,n,r){return(0,F.mG)(this,void 0,void 0,function(){var i,o,s,a;return(0,F.Jh)(this,function(u){switch(u.label){case 0:var c;return u.trys.push([0,3,,4]),i="replay"===e?"":"_".concat(e),[4,(c="".concat(n.apiKey.substring(0,10),"_amp_session_replay_events").concat(i),(0,F.mG)(void 0,void 0,void 0,function(){return(0,F.Jh)(this,function(e){switch(e.label){case 0:return[4,tx(c,1,{upgrade:tU})];case 1:return[2,e.sent()]}})}))];case 1:return o=u.sent(),[4,(s=new t((0,F.pi)((0,F.pi)({},n),{db:o}))).transitionFromKeyValStore(r)];case 2:return u.sent(),[2,s];case 3:return a=u.sent(),n.loggerProvider.warn("".concat(tg,": ").concat(a)),[3,4];case 4:return[2]}})})},t.prototype.getCurrentSequenceEvents=function(e){return(0,F.mG)(this,void 0,void 0,function(){var t,n,r,i,o,s;return(0,F.Jh)(this,function(a){switch(a.label){case 0:if(!e)return[3,2];return[4,this.db.get("sessionCurrentSequence",e)];case 1:if(!(t=a.sent()))return[2,void 0];return[2,[t]];case 2:n=[],a.label=3;case 3:return a.trys.push([3,8,9,10]),[4,this.db.getAll("sessionCurrentSequence")];case 4:i=(r=F.XA.apply(void 0,[a.sent()])).next(),a.label=5;case 5:if(i.done)return[3,7];t=i.value,n.push(t),a.label=6;case 6:return i=r.next(),[3,5];case 7:return[3,10];case 8:return o={error:a.sent()},[3,10];case 9:try{i&&!i.done&&(s=r.return)&&s.call(r)}finally{if(o)throw o.error}return[7];case 10:return[2,n]}})})},t}(tF),tW=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.finalizedSequences={},t.sequences={},t.sequenceId=0,t}return(0,F.ZT)(t,e),t.prototype.resetCurrentSequence=function(e){this.sequences[e]=[]},t.prototype.addSequence=function(e){var t=this.sequenceId++,n=(0,F.ev)([],(0,F.CR)(this.sequences[e]),!1);return this.finalizedSequences[t]={sessionId:e,events:n},this.resetCurrentSequence(e),{sequenceId:t,events:n,sessionId:e}},t.prototype.getSequencesToSend=function(){return(0,F.mG)(this,void 0,void 0,function(){return(0,F.Jh)(this,function(e){return[2,Object.entries(this.finalizedSequences).map(function(e){var t=(0,F.CR)(e,2),n=t[0],r=t[1],i=r.sessionId,o=r.events;return{sequenceId:Number(n),sessionId:i,events:o}})]})})},t.prototype.storeCurrentSequence=function(e){return(0,F.mG)(this,void 0,void 0,function(){return(0,F.Jh)(this,function(t){return this.sequences[e]?[2,this.addSequence(e)]:[2,void 0]})})},t.prototype.addEventToCurrentSequence=function(e,t){return(0,F.mG)(this,void 0,void 0,function(){var n;return(0,F.Jh)(this,function(r){return this.sequences[e]||this.resetCurrentSequence(e),this.shouldSplitEventsList(this.sequences[e],t)&&(n=this.addSequence(e)),this.sequences[e].push(t),[2,n]})})},t.prototype.storeSendingEvents=function(e,t){return(0,F.mG)(this,void 0,void 0,function(){return(0,F.Jh)(this,function(n){return this.finalizedSequences[this.sequenceId]={sessionId:e,events:t},[2,this.sequenceId++]})})},t.prototype.cleanUpSessionEventsStore=function(e,t){return(0,F.mG)(this,void 0,void 0,function(){return(0,F.Jh)(this,function(e){return void 0!==t&&delete this.finalizedSequences[t],[2]})})},t}(tF),tK=function(e){var t=e.config,n=e.sessionId,r=e.minInterval,i=e.maxInterval,o=e.type,s=e.payloadBatcher,a=e.storeType;return(0,F.mG)(void 0,void 0,void 0,function(){var e,u,c,l,d,h;function f(t){return void 0===t&&(t=!1),(0,F.mG)(this,void 0,void 0,function(){return(0,F.Jh)(this,function(n){return[2,e.flush(t)]})})}return(0,F.Jh)(this,function(p){switch(p.label){case 0:if(e=new tm((0,F.pi)((0,F.pi)({},t),{loggerProvider:t.loggerProvider,payloadBatcher:s})),u=function(){return new tW({loggerProvider:t.loggerProvider,maxInterval:i,minInterval:r})},c=function(){return(0,F.mG)(void 0,void 0,void 0,function(){var e;return(0,F.Jh)(this,function(s){switch(s.label){case 0:return[4,tz.new(o,{loggerProvider:t.loggerProvider,minInterval:r,maxInterval:i,apiKey:t.apiKey},n)];case 1:return e=s.sent(),t.loggerProvider.log("Failed to initialize idb store, falling back to memory store."),[2,null!=e?e:u()]}})})},"idb"!==a)return[3,2];return[4,c()];case 1:return d=p.sent(),[3,3];case 2:d=u(),p.label=3;case 3:return l=d,h=function(n){var r=n.events,i=n.sessionId,s=n.deviceId,a=n.sequenceId;t.debugMode&&ef().then(function(e){var n=e.totalStorageSize,r=e.percentOfQuota,i=e.usageDetails;t.loggerProvider.debug("Total storage size: ".concat(n," KB, percentage of quota: ").concat(r,"%, usage details: ").concat(i))}).catch(function(){}),e.sendEventsList({events:r,sessionId:i,flushMaxRetries:t.flushMaxRetries,apiKey:t.apiKey,deviceId:s,sampleRate:t.sampleRate,serverZone:t.serverZone,version:t.version,type:o,onComplete:function(){return(0,F.mG)(void 0,void 0,void 0,function(){return(0,F.Jh)(this,function(e){switch(e.label){case 0:return[4,l.cleanUpSessionEventsStore(i,a)];case 1:return e.sent(),[2]}})})}})},[2,{sendCurrentSequenceEvents:function(e){var n=e.sessionId,r=e.deviceId;l.storeCurrentSequence(n).then(function(e){e&&h({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:r})}).catch(function(e){t.loggerProvider.warn("Failed to get current sequence of session replay events for session:",e)})},addEvent:function(e){var n=e.event,r=e.sessionId,i=e.deviceId;l.addEventToCurrentSequence(r,n.data).then(function(e){return e&&h({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:i})}).catch(function(e){t.loggerProvider.warn("Failed to add event to session replay capture:",e)})},sendStoredEvents:function(e){var t=e.deviceId;return(0,F.mG)(void 0,void 0,void 0,function(){var e;return(0,F.Jh)(this,function(n){switch(n.label){case 0:return[4,l.getSequencesToSend()];case 1:return(e=n.sent())&&e.forEach(function(e){h({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:t})}),[2]}})})},flush:f}]}})})},t$=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=new Map;e.forEach(function(e){n.set(e.name,e.manager)}),this.managers=n}return e.prototype.sendStoredEvents=function(e){return(0,F.mG)(this,void 0,void 0,function(){var t;return(0,F.Jh)(this,function(n){switch(n.label){case 0:return t=[],this.managers.forEach(function(n){t.push(n.sendStoredEvents(e))}),[4,Promise.all(t)];case 1:return n.sent(),[2]}})})},e.prototype.addEvent=function(e){var t,n=e.sessionId,r=e.event,i=e.deviceId;null===(t=this.managers.get(r.type))||void 0===t||t.addEvent({sessionId:n,event:r,deviceId:i})},e.prototype.sendCurrentSequenceEvents=function(e){var t=e.sessionId,n=e.deviceId;this.managers.forEach(function(e){e.sendCurrentSequenceEvents({sessionId:t,deviceId:n})})},e.prototype.flush=function(e){return(0,F.mG)(this,void 0,void 0,function(){var t;return(0,F.Jh)(this,function(n){switch(n.label){case 0:return t=[],this.managers.forEach(function(n){t.push(n.flush(e))}),[4,Promise.all(t)];case 1:return n.sent(),[2]}})})},e}();let tH={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},tV={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},tZ={},tQ={},tX={parentElement:function(e){return function(e,t,n){var r;let i=`${e}.${String(n)}`;if(tQ[i])return tQ[i].call(t);let o=null==(r=Object.getOwnPropertyDescriptor(function(e){if(tZ[e])return tZ[e];let t=function(e){var t,n;let r=null==(n=null==(t=null==globalThis?void 0:globalThis.Zone)?void 0:t.__symbol__)?void 0:n.call(t,e);return r&&globalThis[r]?globalThis[r]:void 0}(e)||globalThis[e],n=t.prototype,r=e in tH?tH[e]:void 0,i=!!(r&&r.every(e=>{var t,r;return!!(null==(r=null==(t=Object.getOwnPropertyDescriptor(n,e))?void 0:t.get)?void 0:r.toString().includes("[native code]"))})),o=e in tV?tV[e]:void 0,s=!!(o&&o.every(e=>{var t;return"function"==typeof n[e]&&(null==(t=n[e])?void 0:t.toString().includes("[native code]"))}));if(i&&s)return tZ[e]=t.prototype,t.prototype;try{let r=document.createElement("iframe");document.body.appendChild(r);let i=r.contentWindow;if(!i)return t.prototype;let o=i[e].prototype;if(document.body.removeChild(r),!o)return n;return tZ[e]=o}catch{return n}}(e),n))?void 0:r.get;return o?(tQ[i]=o,o.call(t)):t[n]}("Node",e,"parentElement")}};function tY(){var e=(0,en.l)();return(null==e?void 0:e.innerHeight)||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight||0}function t0(){var e=(0,en.l)();return(null==e?void 0:e.innerWidth)||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth||0}function t1(e,t,n){for(var r=null,i=[],o=e,s=0;o&&"break"!==function(){var e,a,u,c,l=new Date().getTime()-b.getTime();if(void 0!==y.timeoutMs&&l>y.timeoutMs)throw Error("Timeout: Can't find a unique selector after ".concat(l,"ms"));var d=t7((e=o.getAttribute("id"))&&y.idName(e)?{name:"#"+CSS.escape(e),penalty:0}:null)||t7.apply(void 0,(0,F.ev)([],(0,F.CR)(Array.from(o.attributes).filter(function(e){return y.attr(e.name,e.value)}).map(function(e){return{name:"[".concat(CSS.escape(e.name),'="').concat(CSS.escape(e.value),'"]'),penalty:.5}})),!1))||t7.apply(void 0,(0,F.ev)([],(0,F.CR)(Array.from(o.classList).filter(y.className).map(function(e){return{name:"."+CSS.escape(e),penalty:1}})),!1))||t7((a=o.tagName.toLowerCase(),y.tagName(a)?{name:a,penalty:2}:null))||[t6()],h=function(e){var t=e.parentNode;if(!t)return null;var n=t.firstChild;if(!n)return null;for(var r=0;n&&(n.nodeType===Node.ELEMENT_NODE&&r++,n!==e);)n=n.nextSibling;return r}(o);if("all"==t)h&&(d=d.concat(d.filter(t9).map(function(e){return t8(e,h)})));else if("two"==t)d=d.slice(0,1),h&&(d=d.concat(d.filter(t9).map(function(e){return t8(e,h)})));else if("one"==t){var f=(0,F.CR)(d=d.slice(0,1),1)[0];h&&t9(f)&&(d=[t8(f,h)])}else"none"==t&&(d=[t6()],h&&(d=[t8(d[0],h)]));try{for(var p=(u=void 0,(0,F.XA)(d)),v=p.next();!v.done;v=p.next()){var f=v.value;f.level=s}}catch(e){u={error:e}}finally{try{v&&!v.done&&(c=p.return)&&c.call(p)}finally{if(u)throw u.error}}if(i.push(d),i.length>=y.seedMinLength&&(r=t2(i,n)))return"break";o=o.parentElement,s++}(););return(r||(r=t2(i,n)),!r&&n)?n():r}function t2(e,t){var n,r,i=nt(function e(t,n){var r,i,o,s,a;return void 0===n&&(n=[]),(0,F.Jh)(this,function(u){switch(u.label){case 0:if(!(t.length>0))return[3,9];u.label=1;case 1:u.trys.push([1,6,7,8]),i=(r=(0,F.XA)(t[0])).next(),u.label=2;case 2:if(i.done)return[3,5];return o=i.value,[5,(0,F.XA)(e(t.slice(1,t.length),n.concat(o)))];case 3:u.sent(),u.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s={error:u.sent()},[3,8];case 7:try{i&&!i.done&&(a=r.return)&&a.call(r)}finally{if(s)throw s.error}return[7];case 8:return[3,11];case 9:return[4,n];case 10:u.sent(),u.label=11;case 11:return[2]}})}(e));if(i.length>y.threshold)return t?t():null;try{for(var o=(0,F.XA)(i),s=o.next();!s.done;s=o.next()){var a=s.value;if(t5(a))return a}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return null}function t3(e){for(var t=e[0],n=t.name,r=1;r<e.length;r++){var i=e[r].level||0;n=t.level===i-1?"".concat(e[r].name," > ").concat(n):"".concat(e[r].name," ").concat(n),t=e[r]}return n}function t4(e){return e.map(function(e){return e.penalty}).reduce(function(e,t){return e+t},0)}function t5(e){var t=t3(e);switch(m.querySelectorAll(t).length){case 0:throw Error("Can't select any node with this selector: ".concat(t));case 1:return!0;default:return!1}}function t6(){return{name:"*",penalty:3}}function t8(e,t){return{name:e.name+":nth-child(".concat(t,")"),penalty:e.penalty+1}}function t9(e){return"html"!==e.name&&!e.name.startsWith("#")}function t7(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter(ne);return n.length>0?n:null}function ne(e){return null!=e}function nt(e){return(0,F.ev)([],(0,F.CR)(e),!1).sort(function(e,t){return t4(e)-t4(t)})}var nn=function(e){var t=e.version,n=e.events,r=[];return n.forEach(function(e){var t=JSON.parse(e);t.count=1,"click"===t.type&&r.push(t)}),{version:t,events:r}},nr=function(e){var t=e.version,n=e.events,r=[];return n.forEach(function(e){var t=JSON.parse(e);"click"===t.type&&r.push(t)}),{version:t,events:Object.values(r.reduce(function(e,t){var n=t.x,r=t.y,i=t.selector,o=t.timestamp,s=o-o%36e5,a="".concat(n,":").concat(r,":").concat(null!=i?i:"",":").concat(s);return e[a]?e[a].count+=1:e[a]=(0,F.pi)((0,F.pi)({},t),{timestamp:s,count:1}),e},{}))}},ni=function(e,t){var n=t.eventsManager,r=t.sessionId,i=t.deviceIdFn,o=t.mirror,s=t.ugcFilterRules;return function(t){if(t.type===eD.Click){var a,u,c,l,d,h,f=(0,en.l)();if(f){var p=f.location,v=f.innerHeight,g=f.innerWidth;if(p){var w=t.x,S=t.y;if(void 0!==w&&void 0!==S){var _=o.getNode(t.id);if(_)try{h=function(e,t){if(b=new Date,e.nodeType!==Node.ELEMENT_NODE)throw Error("Can't generate CSS selector for non-element node type.");if("html"===e.tagName.toLowerCase())return"html";var n,r={root:document.body,idName:function(e){return!0},className:function(e){return!0},tagName:function(e){return!0},attr:function(e,t){return!1},seedMinLength:1,optimizedMinLength:2,threshold:1e3,maxNumberOfTries:1e4,timeoutMs:void 0};m=(n=(y=(0,F.pi)((0,F.pi)({},r),void 0)).root).nodeType===Node.DOCUMENT_NODE?n:n===r.root?n.ownerDocument:n;var i=t1(e,"all",function(){return t1(e,"two",function(){return t1(e,"one",function(){return t1(e,"none")})})});if(i){var o=nt(function e(t,n,r){var i,o,s;return void 0===r&&(r={counter:0,visited:new Map}),(0,F.Jh)(this,function(a){switch(a.label){case 0:if(!(t.length>2&&t.length>y.optimizedMinLength))return[3,5];i=1,a.label=1;case 1:var u;if(!(i<t.length-1))return[3,5];if(r.counter>y.maxNumberOfTries||(r.counter+=1,(o=(0,F.ev)([],(0,F.CR)(t),!1)).splice(i,1),s=t3(o),r.visited.has(s)))return[2];if(!(t5(o)&&(u=o,m.querySelector(t3(u))===n)))return[3,4];return[4,o];case 2:return a.sent(),r.visited.set(s,!0),[5,(0,F.XA)(e(o,n,r))];case 3:a.sent(),a.label=4;case 4:return i++,[3,1];case 5:return[2]}})}(i,e));return o.length>0&&(i=o[0]),t3(i)}throw Error("Selector was not found.")}(_)}catch(t){e.debug("error resolving selector from finder")}var I={left:(d=f.document).scrollingElement?d.scrollingElement.scrollLeft:void 0!==f.pageXOffset?f.pageXOffset:d.documentElement.scrollLeft||(null==d?void 0:d.body)&&(null===(a=tX.parentElement(d.body))||void 0===a?void 0:a.scrollLeft)||(null===(u=null==d?void 0:d.body)||void 0===u?void 0:u.scrollLeft)||0,top:d.scrollingElement?d.scrollingElement.scrollTop:void 0!==f.pageYOffset?f.pageYOffset:(null==d?void 0:d.documentElement.scrollTop)||(null==d?void 0:d.body)&&(null===(c=tX.parentElement(d.body))||void 0===c?void 0:c.scrollTop)||(null===(l=null==d?void 0:d.body)||void 0===l?void 0:l.scrollTop)||0},E={x:w+I.left,y:S+I.top,selector:h,viewportHeight:v,viewportWidth:g,pageUrl:eh(p.href,s),timestamp:Date.now(),type:"click"},C=i();C&&n.addEvent({sessionId:r,event:{type:"interaction",data:JSON.stringify(E)},deviceId:C})}}}}}},no=function(){function e(e,t){var n=(0,en.l)();n&&n.navigator&&"function"==typeof n.navigator.sendBeacon?this.sendBeacon=function(e,t){try{if(n.navigator.sendBeacon(e,JSON.stringify(t)))return!0}catch(e){}return!1}:this.sendBeacon=function(){return!1},this.sendXhr=function(e,t){var n=new XMLHttpRequest;return n.open("POST",e,!0),n.setRequestHeader("Accept","*/*"),n.send(JSON.stringify(t)),!0},this.basePageUrl=ec(t.serverZone,t.trackServerUrl),this.apiKey=t.apiKey,this.context=e}return e.prototype.send=function(e,t){var n=this.context,r=n.sessionId,i=n.type,o=new URLSearchParams({device_id:e,session_id:String(r),type:String(i),api_key:this.apiKey}),s="".concat(this.basePageUrl,"?").concat(o.toString());this.sendBeacon(s,t)||this.sendXhr(s,t)},e}(),ns=function(){function e(e,t){var n=this;this.timestamp=Date.now(),this.hook=function(e){n.update(e)},this.send=function(e){return function(t){var r,i,o=e(),s=(0,en.l)();s&&o&&n.transport.send(o,{version:1,events:[{maxScrollX:n._maxScrollX,maxScrollY:n._maxScrollY,maxScrollWidth:n._maxScrollWidth,maxScrollHeight:n._maxScrollHeight,viewportHeight:tY(),viewportWidth:t0(),pageUrl:eh(s.location.href,null!==(i=null===(r=n.config.interactionConfig)||void 0===r?void 0:r.ugcFilterRules)&&void 0!==i?i:[]),timestamp:n.timestamp,type:"scroll"}]})}},this._maxScrollX=0,this._maxScrollY=0,this._maxScrollWidth=t0(),this._maxScrollHeight=tY(),this.config=t,this.transport=e}return e.default=function(t,n){return new e(new no(t,n),n)},Object.defineProperty(e.prototype,"maxScrollX",{get:function(){return this._maxScrollX},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollY",{get:function(){return this._maxScrollY},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollWidth",{get:function(){return this._maxScrollWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollHeight",{get:function(){return this._maxScrollHeight},enumerable:!1,configurable:!0}),e.prototype.update=function(e){var t=Date.now();if(e.x>this._maxScrollX){var n=t0();this._maxScrollX=e.x;var r=e.x+n;r>this._maxScrollWidth&&(this._maxScrollWidth=r),this.timestamp=t}if(e.y>this._maxScrollY){var i=tY();this._maxScrollY=e.y;var o=e.y+i;o>this._maxScrollHeight&&(this._maxScrollHeight=o),this.timestamp=t}},e}(),na=function(e){var t=e.sessionId,n=e.deviceId;this.deviceId=n,this.sessionId=t,t&&n&&(this.sessionReplayId="".concat(n,"/").concat(t))},nu=new function(){var e=this;this.dbs={},this.createStore=function(t){return(0,F.mG)(e,void 0,void 0,function(){return(0,F.Jh)(this,function(e){switch(e.label){case 0:return[4,tx(t,1,{upgrade:function(e){e.objectStoreNames.contains("sessionTargetingMatch")||e.createObjectStore("sessionTargetingMatch",{keyPath:"sessionId"})}})];case 1:return[2,e.sent()]}})})},this.openOrCreateDB=function(t){return(0,F.mG)(e,void 0,void 0,function(){var e,n;return(0,F.Jh)(this,function(r){switch(r.label){case 0:if(this.dbs&&this.dbs[t])return[2,this.dbs[t]];return e="".concat(t.substring(0,10),"_amp_session_replay_targeting"),[4,this.createStore(e)];case 1:return n=r.sent(),this.dbs[t]=n,[2,n]}})})},this.getTargetingMatchForSession=function(t){var n=t.loggerProvider,r=t.apiKey,i=t.sessionId;return(0,F.mG)(e,void 0,void 0,function(){var e,t,o,s;return(0,F.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,this.openOrCreateDB(r)];case 1:return e=a.sent(),t=String(i),[4,e.get("sessionTargetingMatch",t)];case 2:return[2,null==(o=a.sent())?void 0:o.targetingMatch];case 3:return s=a.sent(),n.warn("Failed to get targeting match for session id ".concat(i,": ").concat(s)),[3,4];case 4:return[2,void 0]}})})},this.storeTargetingMatchForSession=function(t){var n=t.loggerProvider,r=t.apiKey,i=t.sessionId,o=t.targetingMatch;return(0,F.mG)(e,void 0,void 0,function(){var e,t,s;return(0,F.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,this.openOrCreateDB(r)];case 1:return e=a.sent(),t=String(i),[4,e.put("sessionTargetingMatch",{targetingMatch:o,sessionId:t,lastUpdated:Date.now()})];case 2:return[2,a.sent()];case 3:return s=a.sent(),n.warn("Failed to store targeting match for session id ".concat(i,": ").concat(s)),[3,4];case 4:return[2,void 0]}})})},this.clearStoreOfOldSessions=function(t){var n=t.loggerProvider,r=t.apiKey,i=t.currentSessionId;return(0,F.mG)(e,void 0,void 0,function(){var e,t,o,s,a,u,c,l;return(0,F.Jh)(this,function(d){switch(d.label){case 0:return d.trys.push([0,8,,9]),[4,this.openOrCreateDB(r)];case 1:return e=d.sent(),t=String(i),[4,(o=e.transaction("sessionTargetingMatch","readwrite")).store.getAll()];case 2:s=d.sent(),a=0,d.label=3;case 3:if(!(a<s.length))return[3,6];if(u=s[a],c=Date.now()-u.lastUpdated,!(u.sessionId!==t&&c>1728e5))return[3,5];return[4,o.store.delete(u.sessionId)];case 4:d.sent(),d.label=5;case 5:return a++,[3,3];case 6:return[4,o.done];case 7:return d.sent(),[3,9];case 8:return l=d.sent(),n.warn("Failed to clear old targeting matches for sessions: ".concat(l)),[3,9];case 9:return[2]}})})}},nc=function(e){var t=e.sessionId,r=e.targetingConfig,i=e.loggerProvider,o=e.apiKey,s=e.targetingParams;return(0,F.mG)(void 0,void 0,void 0,function(){var e,a,u;return(0,F.Jh)(this,function(c){switch(c.label){case 0:return[4,nu.clearStoreOfOldSessions({loggerProvider:i,apiKey:o,currentSessionId:t})];case 1:return c.sent(),[4,nu.getTargetingMatchForSession({loggerProvider:i,apiKey:o,sessionId:t})];case 2:if(!0===c.sent())return[2,!0];e=!0,c.label=3;case 3:return c.trys.push([3,6,,7]),[4,Promise.all([n.e(6434),n.e(5419)]).then(n.bind(n,25419))];case 4:return[4,(0,c.sent().evaluateTargeting)((0,F.pi)((0,F.pi)({},s),{flag:r,sessionId:t,apiKey:o,loggerProvider:i}))];case 5:return(a=c.sent())&&a.sr_targeting_config&&(e="on"===a.sr_targeting_config.key),nu.storeTargetingMatchForSession({loggerProvider:i,apiKey:o,sessionId:t,targetingMatch:e}),[3,7];case 6:return u=c.sent(),i.warn(u.message),[3,7];case 7:return[2,e]}})})};function nl(e){return void 0===e&&(e={}),{name:"amplitude/url-tracking@1",observer:function(t,n,r){var i,o,s,a=(0,F.pi)((0,F.pi)({},e),r),u=a.ugcFilterRules||[],c=null!==(i=a.enablePolling)&&void 0!==i&&i,l=null!==(o=a.pollingInterval)&&void 0!==o?o:1e3,d=null!==(s=a.captureDocumentTitle)&&void 0!==s&&s;if(!n)return function(){};var h=void 0,f=function(){return n.location&&n.location.href||""},p=function(){var e=n.innerHeight,t=n.innerWidth,r=n.document,i=f(),o="";return d&&(o=(null==r?void 0:r.title)||""),{href:u.length>0?eh(i,u):i,title:o,viewportHeight:e,viewportWidth:t,type:"url-change-event"}},v=function(){var e=f();(void 0===h||e!==h)&&(h=e,t(p()))},g=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.apply(this,t);return v(),r}},y=function(){v()};if(c){var m=n.setInterval(function(){v()},l);return v(),function(){m&&n.clearInterval(m)}}if(n.history){var b=n.history.pushState.bind(n.history),w=n.history.replaceState.bind(n.history);return n.history.pushState=g(b),n.history.replaceState=g(w),n.addEventListener("popstate",v),n.addEventListener("hashchange",y),v(),function(){n.history.pushState=b,n.history.replaceState=w,n.removeEventListener("popstate",v),n.removeEventListener("hashchange",y)}}return n.addEventListener("hashchange",y),v(),function(){n.removeEventListener("hashchange",y)}},options:e}}nl();var nd=function(){function e(){var e=this;this.name="@amplitude/session-replay-browser",this.recordCancelCallback=null,this.eventCount=0,this.sessionTargetingMatch=!1,this.pageLeaveFns=[],this.recordFunction=null,this.teardownEventListeners=function(t){var n=(0,en.l)();n&&(n.removeEventListener("blur",e.blurListener),n.removeEventListener("focus",e.focusListener),t||n.addEventListener("blur",e.blurListener),t||n.addEventListener("focus",e.focusListener),n.self&&"onpagehide"in n.self?(n.removeEventListener("pagehide",e.pageLeaveListener),t||n.addEventListener("pagehide",e.pageLeaveListener)):(n.removeEventListener("beforeunload",e.pageLeaveListener),t||n.addEventListener("beforeunload",e.pageLeaveListener)))},this.blurListener=function(){e.sendEvents()},this.focusListener=function(){e.recordEvents(!1)},this.pageLeaveListener=function(t){e.pageLeaveFns.forEach(function(e){e(t)})},this.evaluateTargetingAndCapture=function(t,n){return void 0===n&&(n=!1),(0,F.mG)(e,void 0,void 0,function(){var e,r;return(0,F.Jh)(this,function(i){switch(i.label){case 0:if(!this.identifiers||!this.identifiers.sessionId||!this.config)return this.identifiers&&!this.identifiers.sessionId?this.loggerProvider.log("Session ID has not been set yet, cannot evaluate targeting for Session Replay."):this.loggerProvider.warn("Session replay init has not been called, cannot evaluate targeting."),[2];if(this.lastTargetingParams=t,!(this.config.targetingConfig&&!this.sessionTargetingMatch))return[3,2];return(e=t.event)&&Object.values(f).includes(e.event_type)&&(e=void 0),r=this,[4,nc({sessionId:this.identifiers.sessionId,targetingConfig:this.config.targetingConfig,loggerProvider:this.loggerProvider,apiKey:this.config.apiKey,targetingParams:{userProperties:t.userProperties,event:e}})];case 1:r.sessionTargetingMatch=i.sent(),i.label=2;case 2:if(!n)return[3,3];return this.initialize(!0),[3,5];case 3:return[4,this.recordEvents()];case 4:i.sent(),i.label=5;case 5:return[2]}})})},this.addCustomRRWebEvent=function(t,n,r){return void 0===n&&(n={}),void 0===r&&(r=!0),(0,F.mG)(e,void 0,void 0,function(){var e,i,o,s;return(0,F.Jh)(this,function(a){switch(a.label){case 0:if(a.trys.push([0,3,,4]),e=void 0,!((i=this.config)&&t!==d.METADATA)||(e={config:ep(i),version:ty},!r))return[3,2];return[4,ef()];case 1:o=a.sent(),e=(0,F.pi)((0,F.pi)({},o),e),a.label=2;case 2:return this.recordCancelCallback&&this.recordFunction?this.recordFunction.addCustomEvent(t,(0,F.pi)((0,F.pi)({},n),e)):this.loggerProvider.debug("Not able to add custom replay capture event ".concat(t," due to no ongoing recording.")),[3,4];case 3:return s=a.sent(),this.loggerProvider.debug("Error while adding custom replay capture event: ",s),[3,4];case 4:return[2]}})})},this.stopRecordingEvents=function(){var t;try{e.loggerProvider.log("Session Replay capture stopping."),e.recordCancelCallback&&e.recordCancelCallback(),e.recordCancelCallback=null,null===(t=e.networkObservers)||void 0===t||t.stop()}catch(t){e.loggerProvider.warn("Error occurred while stopping replay capture: ".concat(t.toString()))}},this.loggerProvider=new et(new B)}return e.prototype.init=function(e,t){return ey(this._init(e,t))},e.prototype._init=function(e,t){var n,r,i,o,s,a;return(0,F.mG)(this,void 0,void 0,function(){var u,c,l,d,h,f,p,v,g,y,m,b;return(0,F.Jh)(this,function(w){switch(w.label){case 0:return this.loggerProvider=new et(t.loggerProvider||new B),Object.prototype.hasOwnProperty.call(t,"logLevel")&&this.loggerProvider.enable(t.logLevel),this.identifiers=new na({sessionId:t.sessionId,deviceId:t.deviceId}),u=this,[4,(0,F.mG)(void 0,void 0,void 0,function(){var n;return(0,F.Jh)(this,function(r){switch(r.label){case 0:return[4,eB({localConfig:n=new eg(e,t),configKeys:["sessionReplay"]})];case 1:return[2,new eJ(r.sent(),n)]}})})];case 1:return u.joinedConfigGenerator=w.sent(),[4,this.joinedConfigGenerator.generateJoinedConfig(this.identifiers.sessionId)];case 2:l=(c=w.sent()).joinedConfig,d=c.localConfig,h=c.remoteConfig,this.config=l,this.setMetadata(t.sessionId,l,d,h,null===(n=t.version)||void 0===n?void 0:n.version,ty,null===(r=t.version)||void 0===r?void 0:r.type),t.sessionId&&(null===(i=this.config.interactionConfig)||void 0===i?void 0:i.enabled)&&(f=ns.default({sessionId:t.sessionId,type:"interaction"},this.config),this.pageLeaveFns=[f.send(this.getDeviceId.bind(this)).bind(f)],this.scrollHook=f.hook.bind(f)),p=[],"idb"!==(v=this.config.storeType)||(null===(o=(0,en.l)())||void 0===o?void 0:o.indexedDB)||(v="memory",this.loggerProvider.warn("Could not use preferred indexedDB storage, reverting to in memory option.")),this.loggerProvider.log("Using ".concat(v," for event storage.")),w.label=3;case 3:return w.trys.push([3,5,,6]),[4,tK({config:this.config,sessionId:this.identifiers.sessionId,type:"replay",storeType:v})];case 4:return g=w.sent(),p.push({name:"replay",manager:g}),[3,6];case 5:return y=w.sent(),this.loggerProvider.warn("Error occurred while creating replay events manager: ".concat(y.toString())),[3,6];case 6:if(!(null===(s=this.config.interactionConfig)||void 0===s?void 0:s.enabled))return[3,10];m=this.config.interactionConfig.batch?nr:nn,w.label=7;case 7:return w.trys.push([7,9,,10]),[4,tK({config:this.config,sessionId:this.identifiers.sessionId,type:"interaction",minInterval:null!==(a=this.config.interactionConfig.trackEveryNms)&&void 0!==a?a:3e4,maxInterval:6e4,payloadBatcher:m,storeType:v})];case 8:return b=w.sent(),p.push({name:"interaction",manager:b}),[3,10];case 9:return y=w.sent(),this.loggerProvider.warn("Error occurred while creating interaction events manager: ".concat(y.toString())),[3,10];case 10:return this.eventsManager=new(t$.bind.apply(t$,(0,F.ev)([void 0],(0,F.CR)(p),!1))),this.eventCompressor&&this.eventCompressor.terminate(),this.eventCompressor=new tv(this.eventsManager,this.config,this.getDeviceId()),[4,this.initializeNetworkObservers()];case 11:return w.sent(),this.loggerProvider.log("Installing @amplitude/session-replay-browser."),this.teardownEventListeners(!1),[4,this.evaluateTargetingAndCapture({userProperties:t.userProperties},!0)];case 12:return w.sent(),[2]}})})},e.prototype.setSessionId=function(e,t){return ey(this.asyncSetSessionId(e,t))},e.prototype.asyncSetSessionId=function(e,t,n){return(0,F.mG)(this,void 0,void 0,function(){var r,i,o;return(0,F.Jh)(this,function(s){switch(s.label){case 0:if(this.sessionTargetingMatch=!1,this.lastShouldRecordDecision=void 0,(r=this.identifiers&&this.identifiers.sessionId)&&this.sendEvents(r),i=t||this.getDeviceId(),this.identifiers=new na({sessionId:e,deviceId:i}),!(this.joinedConfigGenerator&&r))return[3,2];return[4,this.joinedConfigGenerator.generateJoinedConfig(this.identifiers.sessionId)];case 1:o=s.sent().joinedConfig,this.config=o,s.label=2;case 2:return[4,this.evaluateTargetingAndCapture({userProperties:null==n?void 0:n.userProperties})];case 3:return s.sent(),[2]}})})},e.prototype.getSessionReplayProperties=function(){var e,t=this.config,n=this.identifiers;if(!t||!n)return this.loggerProvider.warn("Session replay init has not been called, cannot get session replay properties."),{};var r=this.getShouldRecord(),i={};return r&&((e={})[Z]=n.sessionReplayId?n.sessionReplayId:null,i=e,t.debugMode&&(i[Y]=JSON.stringify({appHash:ea(t.apiKey).toString()}))),this.addCustomRRWebEvent(d.GET_SR_PROPS,{shouldRecord:r,eventProperties:i},10===this.eventCount),10===this.eventCount&&(this.eventCount=0),this.eventCount++,i},e.prototype.sendEvents=function(e){var t,n=e||(null===(t=this.identifiers)||void 0===t?void 0:t.sessionId),r=this.getDeviceId();this.eventsManager&&n&&r&&this.eventsManager.sendCurrentSequenceEvents({sessionId:n,deviceId:r})},e.prototype.initialize=function(e){var t;return void 0===e&&(e=!1),(0,F.mG)(this,void 0,void 0,function(){var n;return(0,F.Jh)(this,function(r){return(null===(t=this.identifiers)||void 0===t?void 0:t.sessionId)?(n=this.getDeviceId())?(this.eventsManager&&e&&this.eventsManager.sendStoredEvents({deviceId:n}),[2,this.recordEvents()]):(this.loggerProvider.log("Session is not being recorded due to lack of device id."),[2,Promise.resolve()]):(this.loggerProvider.log("Session is not being recorded due to lack of session id."),[2,Promise.resolve()])})})},e.prototype.shouldOptOut=function(){if(null===(t=this.config)||void 0===t?void 0:t.instanceName){var e,t,n,r;r=(void 0===(e=this.config.instanceName)&&(e=z),eO.getInstance(e)).identityStore.getIdentity().optOut}return void 0!==r?r:null===(n=this.config)||void 0===n?void 0:n.optOut},e.prototype.getShouldRecord=function(){if(!this.identifiers||!this.config||!this.identifiers.sessionId)return this.loggerProvider.warn("Session is not being recorded due to lack of config, please call sessionReplay.init."),!1;if(!this.config.captureEnabled)return this.loggerProvider.log("Session ".concat(this.identifiers.sessionId," not being captured due to capture being disabled for project or because the remote config could not be fetched.")),!1;if(this.shouldOptOut())return this.loggerProvider.log("Opting session ".concat(this.identifiers.sessionId," out of recording due to optOut config.")),!1;var e,t,n=!1,r="",i=!1;return this.config.targetingConfig?this.sessionTargetingMatch?(r="Capturing replays for session ".concat(this.identifiers.sessionId," due to matching targeting conditions."),this.loggerProvider.log(r),n=!0,i=!0):(r="Not capturing replays for session ".concat(this.identifiers.sessionId," due to not matching targeting conditions."),this.loggerProvider.log(r),n=!1,i=!1):(e=this.identifiers.sessionId,t=this.config.sampleRate,31*Math.abs(ea(e.toString()))%1e6/1e6<t)?(n=!0,i=!0):(r="Opting session ".concat(this.identifiers.sessionId," out of recording due to sample rate."),this.loggerProvider.log(r),n=!1,i=!1),this.lastShouldRecordDecision!==n&&this.config.targetingConfig&&(this.addCustomRRWebEvent(d.TARGETING_DECISION,{message:r,sessionId:this.identifiers.sessionId,matched:i,targetingParams:this.lastTargetingParams}),this.lastShouldRecordDecision=n),n},e.prototype.getBlockSelectors=function(){var e,t,n,r=null!==(n=null===(t=null===(e=this.config)||void 0===e?void 0:e.privacyConfig)||void 0===t?void 0:t.blockSelector)&&void 0!==n?n:[];if(0!==r.length)return r},e.prototype.getMaskTextSelectors=function(){if((null===(t=null===(e=this.config)||void 0===e?void 0:e.privacyConfig)||void 0===t?void 0:t.defaultMaskLevel)==="conservative")return"*";var e,t,n,r,i=null===(r=null===(n=this.config)||void 0===n?void 0:n.privacyConfig)||void 0===r?void 0:r.maskSelector;if(i)return i},e.prototype.getRecordingPlugins=function(e){var t,r,i,o,s,a;return(0,F.mG)(this,void 0,void 0,function(){var u,c,l,d;return(0,F.Jh)(this,function(h){switch(h.label){case 0:u=[];try{c=nl({ugcFilterRules:(null===(r=null===(t=this.config)||void 0===t?void 0:t.interactionConfig)||void 0===r?void 0:r.ugcFilterRules)||[],enablePolling:(null===(i=this.config)||void 0===i?void 0:i.enableUrlChangePolling)||!1,pollingInterval:null===(o=this.config)||void 0===o?void 0:o.urlChangePollingInterval,captureDocumentTitle:null===(s=this.config)||void 0===s?void 0:s.captureDocumentTitle}),u.push(c)}catch(e){this.loggerProvider.warn("Failed to create URL tracking plugin:",e)}if(!(null===(a=null==e?void 0:e.console)||void 0===a?void 0:a.enabled))return[3,4];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,Promise.all([n.e(9721),n.e(6434)]).then(n.bind(n,85809))];case 2:return l=h.sent().getRecordConsolePlugin,u.push(l({level:e.console.levels})),[3,4];case 3:return d=h.sent(),this.loggerProvider.warn("Failed to load console plugin:",d),[3,4];case 4:return[2,u.length>0?u:void 0]}})})},e.prototype.getRecordFunction=function(){return(0,F.mG)(this,void 0,void 0,function(){var e,t;return(0,F.Jh)(this,function(r){switch(r.label){case 0:if(this.recordFunction)return[2,this.recordFunction];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Promise.all([n.e(2215),n.e(6434)]).then(n.bind(n,39465))];case 2:return e=r.sent().record,this.recordFunction=e,[2,e];case 3:return t=r.sent(),this.loggerProvider.warn("Failed to load rrweb-record module:",t),[2,null];case 4:return[2]}})})},e.prototype.recordEvents=function(e){var t,n,r,i,o;return void 0===e&&(e=!0),(0,F.mG)(this,void 0,void 0,function(){var s,a,u,c,l,h,f,p,v,g,y,m,b,w=this;return(0,F.Jh)(this,function(S){switch(S.label){case 0:if(s=this.config,a=this.getShouldRecord(),u=null===(t=this.identifiers)||void 0===t?void 0:t.sessionId,!a||!u||!s)return[2];return this.stopRecordingEvents(),[4,this.getRecordFunction()];case 1:if(!(c=S.sent()))return[2];return[4,this.initializeNetworkObservers()];case 2:S.sent(),null===(n=this.networkObservers)||void 0===n||n.start(function(e){w.addCustomRRWebEvent(d.FETCH_REQUEST,e)}),l=s.privacyConfig,h=s.interactionConfig,f=s.loggingConfig,p=(null==h?void 0:h.enabled)?{mouseInteraction:this.eventsManager&&ni(this.loggerProvider,{eventsManager:this.eventsManager,sessionId:u,deviceIdFn:this.getDeviceId.bind(this),mirror:c.mirror,ugcFilterRules:null!==(r=h.ugcFilterRules)&&void 0!==r?r:[]}),scroll:this.scrollHook}:{},v=(null==h?void 0:h.enabled)&&h.ugcFilterRules?h.ugcFilterRules:[],this.loggerProvider.log("Session Replay capture beginning for ".concat(u,".")),S.label=3;case 3:return S.trys.push([3,5,,6]),g=this,y=c,b={emit:function(e){if(w.shouldOptOut()){w.loggerProvider.log("Opting session ".concat(u," out of recording due to optOut config.")),w.stopRecordingEvents(),w.sendEvents();return}e.type===eP.Meta&&(e.data.href=eh(e.data.href,v)),w.eventCompressor&&w.eventCompressor.enqueueEvent(e,u)},inlineStylesheet:s.shouldInlineStylesheet,hooks:p,maskAllInputs:!0,maskTextClass:ee,blockClass:"amp-block",blockSelector:this.getBlockSelectors(),applyBackgroundColorToBlockedElements:s.applyBackgroundColorToBlockedElements,maskInputFn:es("input",l),maskTextFn:es("text",l),maskTextSelector:this.getMaskTextSelectors(),recordCanvas:!1,slimDOMOptions:{script:null===(i=s.omitElementTags)||void 0===i?void 0:i.script,comment:null===(o=s.omitElementTags)||void 0===o?void 0:o.comment},errorHandler:function(e){if(e.message.includes("insertRule")&&e.message.includes("CSSStyleSheet")||e._external_)throw e;return w.loggerProvider.warn("Error while capturing replay: ",e.toString()),!0}},[4,this.getRecordingPlugins(f)];case 4:return g.recordCancelCallback=y.apply(void 0,[(b.plugins=S.sent(),b)]),this.addCustomRRWebEvent(d.DEBUG_INFO),e&&this.addCustomRRWebEvent(d.METADATA,this.metadata),[3,6];case 5:return m=S.sent(),this.loggerProvider.warn("Failed to initialize session replay:",m),[3,6];case 6:return[2]}})})},e.prototype.getDeviceId=function(){var e;return null===(e=this.identifiers)||void 0===e?void 0:e.deviceId},e.prototype.getSessionId=function(){var e;return null===(e=this.identifiers)||void 0===e?void 0:e.sessionId},e.prototype.flush=function(e){var t;return void 0===e&&(e=!1),(0,F.mG)(this,void 0,void 0,function(){return(0,F.Jh)(this,function(n){return[2,null===(t=this.eventsManager)||void 0===t?void 0:t.flush(e)]})})},e.prototype.shutdown=function(){this.teardownEventListeners(!0),this.stopRecordingEvents(),this.sendEvents()},e.prototype.mapSDKType=function(e){return"plugin"===e?"@amplitude/plugin-session-replay-browser":"segment"===e?"@amplitude/segment-session-replay-plugin":null},e.prototype.setMetadata=function(e,t,n,r,i,o,s){var a=(null==e?void 0:e.toString())?ea(e.toString()):void 0;this.metadata={joinedConfig:t,localConfig:n,remoteConfig:r,sessionId:e,hashValue:a,sampleRate:t.sampleRate,replaySDKType:this.mapSDKType(s),replaySDKVersion:i,standaloneSDKType:"@amplitude/session-replay-browser",standaloneSDKVersion:o}},e.prototype.initializeNetworkObservers=function(){var e,t,r;return(0,F.mG)(this,void 0,void 0,function(){var i,o;return(0,F.Jh)(this,function(s){switch(s.label){case 0:if(!((null===(r=null===(t=null===(e=this.config)||void 0===e?void 0:e.loggingConfig)||void 0===t?void 0:t.network)||void 0===r?void 0:r.enabled)&&!this.networkObservers))return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,n.e(2708).then(n.bind(n,52708))];case 2:return i=s.sent().NetworkObservers,this.networkObservers=new i,[3,4];case 3:return o=s.sent(),this.loggerProvider.warn("Failed to import or instantiate NetworkObservers:",o),[3,4];case 4:return[2]}})})},e}(),nh=function(e){return function(){var t=e.config||ev();return{logger:t.loggerProvider,logLevel:t.logLevel}}},nf={init:N((L=new nd).init.bind(L),"init",nh(L)),evaluateTargetingAndCapture:N(L.evaluateTargetingAndCapture.bind(L),"evaluateTargetingAndRecord",nh(L)),setSessionId:N(L.setSessionId.bind(L),"setSessionId",nh(L)),getSessionId:N(L.getSessionId.bind(L),"getSessionId",nh(L)),getSessionReplayProperties:N(L.getSessionReplayProperties.bind(L),"getSessionReplayProperties",nh(L)),flush:N(L.flush.bind(L),"flush",nh(L)),shutdown:N(L.shutdown.bind(L),"shutdown",nh(L))},np=nf.init,nv=nf.setSessionId,ng=(nf.getSessionId,nf.getSessionReplayProperties);nf.flush,nf.shutdown,nf.evaluateTargetingAndCapture},40230:function(e,t,n){"use strict";n.d(t,{BH:function(){return _},DV:function(){return F},GJ:function(){return L},L:function(){return h},LL:function(){return D},P0:function(){return w},Sg:function(){return I},UI:function(){return B},US:function(){return c},Wl:function(){return A},Yr:function(){return x},ZR:function(){return k},aH:function(){return S},b$:function(){return C},cI:function(){return M},dS:function(){return W},eu:function(){return P},g5:function(){return s},gK:function(){return z},gQ:function(){return U},h$:function(){return d},hl:function(){return O},hu:function(){return o},m9:function(){return $},p$:function(){return p},r3:function(){return N},uI:function(){return E},ug:function(){return K},vZ:function(){return function e(t,n){if(t===n)return!0;let r=Object.keys(t),i=Object.keys(n);for(let o of r){if(!i.includes(o))return!1;let r=t[o],s=n[o];if(G(r)&&G(s)){if(!e(r,s))return!1}else if(r!==s)return!1}for(let e of i)if(!r.includes(e))return!1;return!0}},w9:function(){return R},xO:function(){return J},xb:function(){return q}});var r=n(25566);let i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(e,t){if(!e)throw s(t)},s=function(e){return Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},a=function(e){let t=[],n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:((64512&i)==55296&&r+1<e.length&&(64512&e.charCodeAt(r+1))==56320?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128):t[n++]=i>>12|224,t[n++]=i>>6&63|128),t[n++]=63&i|128)}return t},u=function(e){let t=[],n=0,r=0;for(;n<e.length;){let i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){let o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{let o=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){let i=e[t],o=t+1<e.length,s=o?e[t+1]:0,a=t+2<e.length,u=a?e[t+2]:0,c=i>>2,l=(3&i)<<4|s>>4,d=(15&s)<<2|u>>6,h=63&u;a||(h=64,o||(d=64)),r.push(n[c],n[l],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):u(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){let i=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0,s=++t<e.length?n[e.charAt(t)]:64,a=++t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==o||null==s||null==a)throw new l;let u=i<<2|o>>4;if(r.push(u),64!==s){let e=o<<4&240|s>>2;if(r.push(e),64!==a){let e=s<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class l extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let d=function(e){let t=a(e);return c.encodeByteArray(t,!0)},h=function(e){return d(e).replace(/\./g,"")},f=function(e){try{return c.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function p(e){return function e(t,n){if(!(n instanceof Object))return n;switch(n.constructor){case Date:return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return n}for(let r in n)n.hasOwnProperty(r)&&"__proto__"!==r&&(t[r]=e(t[r],n[r]));return t}(void 0,e)}let v=()=>(function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw Error("Unable to locate global object.")})().__FIREBASE_DEFAULTS__,g=()=>{if(void 0===r||void 0===r.env)return;let e=r.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},y=()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&f(e[1]);return t&&JSON.parse(t)},m=()=>{try{return v()||g()||y()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},b=e=>{var t,n;return null===(n=null===(t=m())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},w=e=>{let t=b(e);if(!t)return;let n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},S=()=>{var e;return null===(e=m())||void 0===e?void 0:e.config};class _{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function I(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[h(JSON.stringify({alg:"none",type:"JWT"})),h(JSON.stringify(o)),""].join(".")}function E(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}function C(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function x(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN}function O(){try{return"object"==typeof indexedDB}catch(e){return!1}}function P(){return new Promise((e,t)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})}class k extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,k.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,D.prototype.create)}}class D{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){let n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?i.replace(T,(e,t)=>{let r=n[t];return null!=r?String(r):`<${t}?>`}):"Error",s=`${this.serviceName}: ${o} (${r}).`;return new k(r,s,n)}}let T=/\{\$([^}]+)}/g;function M(e){return JSON.parse(e)}function A(e){return JSON.stringify(e)}let j=function(e){let t={},n={},r={},i="";try{let o=e.split(".");t=M(f(o[0])||""),n=M(f(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},R=function(e){let t=j(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},L=function(e){let t=j(e).claims;return"object"==typeof t&&!0===t.admin};function N(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function F(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function q(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function B(e,t,n){let r={};for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function G(e){return null!==e&&"object"==typeof e}function J(e){let t=[];for(let[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}class U{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){let n,r;t||(t=0);let i=this.W_;if("string"==typeof e)for(let n=0;n<16;n++)i[n]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let n=0;n<16;n++)i[n]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){let t=i[e-3]^i[e-8]^i[e-14]^i[e-16];i[e]=(t<<1|t>>>31)&4294967295}let o=this.chain_[0],s=this.chain_[1],a=this.chain_[2],u=this.chain_[3],c=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(n=u^s&(a^u),r=1518500249):(n=s^a^u,r=1859775393):e<60?(n=s&a|u&(s|a),r=2400959708):(n=s^a^u,r=3395469782);let t=(o<<5|o>>>27)+n+c+r+i[e]&4294967295;c=u,u=a,a=(s<<30|s>>>2)&4294967295,s=o,o=t}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);let n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;for(;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}function z(e,t){return`${e} failed: ${t} argument `}let W=function(e){let t=[],n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){let t=i-55296;o(++r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return t},K=function(e){let t=0;for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function $(e){return e&&e._delegate?e._delegate:e}},13102:function(e,t,n){"use strict";n.d(t,{K:function(){return O}});class r extends Error{constructor(e,t){super(t),this.name=e}}class i extends r{constructor(e,t){2==arguments.length&&(e+=` (Received: ${JSON.stringify(t)})`),super("ValidationError",`[Validation] ${e}`)}}function o(e,t){if("function"!=typeof e)throw new i(`${t} is not a function`,e)}function s(e,t){if(null===e||"object"!=typeof e)throw new i(`${t} is not an object`,e)}function a(e){let t=!0;if(e&&"object"==typeof e&&!Array.isArray(e)){for(let n in t=!1,e)if("boolean"!=typeof e[n]){t=!0;break}}if(t)throw new i("Consent Categories should be {[categoryName: string]: boolean}",e)}class u{get debugLoggingEnabled(){return!0===window.SEGMENT_CONSENT_WRAPPER_DEBUG_MODE}enableDebugLogging(){window.SEGMENT_CONSENT_WRAPPER_DEBUG_MODE=!0}debug(...e){this.debugLoggingEnabled&&console.log("[consent wrapper debug]",...e)}}let c=new u;class l{constructor(){this.isAbortCalled=!1,this.isLoadCalled=!1,this.abortLoadOptions={loadSegmentNormally:!0},this.loadOptions={consentModel:"opt-in"}}load(e){this.isLoadCalled=!0,this.loadOptions={...this.loadOptions,...e},c.debug("ctx.load called",this.loadOptions)}abort(e){this.isAbortCalled=!0,this.abortLoadOptions={...this.abortLoadOptions,...e},c.debug("Abort consent wrapper",this.loadOptions)}validate(){if(this.isAbortCalled&&this.isLoadCalled)throw new i("both abort and load should not be called")}}let d=e=>async()=>{let t=new l;return await e?.(t),t.validate(),t};var h=n(94730);let f=(e,...t)=>{let n=t.reduce((e,t)=>n=>t(e(n)),e=>e);return(...t)=>n(e(...t))},p=e=>Array.from(new Set(e)),v=e=>{if(e&&"object"==typeof e&&"consentSettings"in e&&"object"==typeof e.consentSettings&&e.consentSettings&&"categories"in e.consentSettings&&Array.isArray(e.consentSettings.categories))return e.consentSettings.categories||void 0},g=e=>p(Object.values(e).reduce((e,t)=>e.concat(t))),y=(e,t)=>!!t&&!t.hasUnmappedDestinations&&Object.keys(e).filter(t=>e[t]).every(e=>!t.allCategories.includes(e)),m=(e,t)=>!e||!e.length||e.every(e=>t[e]),b=(e,t,n,r={})=>{let{integrationCategoryMappings:i,shouldEnableIntegration:o}=r,s=(i?i[e]:v(t.integrations[e]))??[];return o?o(s,n,{creationName:e}):m(s,n)},w=(e,t,n)=>{let{remotePlugins:r,integrations:i}=e,{integrationCategoryMappings:o,shouldEnableIntegration:s}=n,a={...e,remotePlugins:[...r||[]],integrations:{...i}},u=n=>b(n,e,t,{integrationCategoryMappings:o,shouldEnableIntegration:s});for(let e in i)u(e)?c.debug(`Enabled (opt-in): ${e}`):(c.debug(`Disabled (opt-in): ${e}`),a.remotePlugins=r?.filter(t=>t.creationName!==e),delete a.integrations[e]);return a},S=(e,t,n)=>{let r=async({integration:t,payload:r,next:i})=>{let o=await e,s=r.obj.context.consent.categoryPreferences,a=!b(t,o,s,n);if(c.debug(`Destination middleware called: ${t}`,{DROPPED:a,categoryPreferences:s,payload:r.obj,filterSettings:n}),a)return null;i(r)};t.addDestinationMiddleware("*",r);let i=async({payload:t,next:r})=>{let i=await e,o=t.obj.context.consent.categoryPreferences,s=n.integrationCategoryMappings?{hasUnmappedDestinations:!1,allCategories:g(n.integrationCategoryMappings)}:i.consentSettings,a=y(o,s);if(c.debug("Source middleware called",{DROPPED:a,categoryPreferences:o,payload:t.obj,filterSettings:n,consentSettings:s}),a)return null;r(t)};t.addSourceMiddleware(i)},_=e=>async({payload:t,next:n})=>{t.obj.context.consent={...t.obj.context.consent,categoryPreferences:await e()},n(t)},I=(e,t)=>t.reduce((t,n)=>(n in e&&(t[n]=e[n]),t),{}),E=(e,t)=>{if(!t.length)throw new i("Invariant: No consent categories defined in Segment",[]);return I(e,t)};class C{get analytics(){return x(this.uninitializedAnalytics)}get cdnSettings(){return this.cdnSettingsDeferred.promise}async getAllCategories(){return(this.settings.integrationCategoryMappings?g(this.settings.integrationCategoryMappings):(await this.cdnSettings).consentSettings?.allCategories)??[]}async getCategories(){let e=await this.settings.getCategories();return a(e),e}constructor(e,t){this.cdnSettingsDeferred=(0,h.d)(),this.createDisableOption=(e,t)=>!0===t||(n=>y(e,n.consentSettings)||"function"==typeof t&&t(n)),function(e){if(s(e,"analytics"),!("load"in e)||!("addSourceMiddleware"in e)||!("addDestinationMiddleware"in e)||!("track"in e))throw new i("analytics is not an Analytics instance",e)}(e),this.settings=t,this.uninitializedAnalytics=e,this.ogAnalyticsLoad=e.load.bind(e)}async loadWithFilteredDeviceModeDestinations(...[e,t]){let n=await this.getCategories();return this.load(e,{...t,updateCDNSettings:f(e=>w(e,n,{shouldEnableIntegration:this.settings.shouldEnableIntegration,integrationCategoryMappings:this.settings.integrationCategoryMappings}),t?.updateCDNSettings??(e=>e)),disable:this.createDisableOption(n,t?.disable)})}load(...[e,t]){return this.ogAnalyticsLoad(e,{...t,updateCDNSettings:f(t?.updateCDNSettings||(e=>e),e=>(c.debug("CDN settings loaded",e),this.cdnSettingsDeferred.resolve(e),e))})}replaceLoadMethod(e){this.analytics.load=e}page(){this.analytics.page()}configureBlockingMiddlewareForOptOut(){S(this.cdnSettings,this.analytics,{integrationCategoryMappings:this.settings.integrationCategoryMappings,shouldEnableIntegration:this.settings.shouldEnableIntegration})}configureConsentStampingMiddleware(){let{pruneUnmappedCategories:e}=this.settings,t=_(async()=>{let t=await this.getCategories();return e?E(t,await this.getAllCategories()):t});this.analytics.addSourceMiddleware(t)}consentChange(e){c.debug("Consent change",e);try{a(e)}catch(e){return console.error(e)}this.analytics.track("Segment Consent Preference Updated",void 0,{consent:{categoryPreferences:e}})}}let x=e=>{if(Array.isArray(e)){let t=e._loadOptions??{},n=window[t?.globalAnalyticsKey??"analytics"];if(n?.initialized)return n}return e},O=(...[e])=>{!function(e){if("object"!=typeof e||!e)throw new i("Options should be an object",e);o(e.getCategories,"getCategories"),e.shouldLoadSegment&&o(e.shouldLoadSegment,"shouldLoadSegment"),e.shouldEnableIntegration&&o(e.shouldEnableIntegration,"shouldEnableIntegration"),e.shouldDisableSegment&&o(e.shouldDisableSegment,"shouldDisableSegment"),e.integrationCategoryMappings&&s(e.integrationCategoryMappings,"integrationCategoryMappings"),e.registerOnConsentChanged&&o(e.registerOnConsentChanged,"registerOnConsentChanged")}(e);let{shouldDisableSegment:t,getCategories:n,shouldLoadSegment:r,integrationCategoryMappings:a,shouldEnableIntegration:u,registerOnConsentChanged:l,shouldLoadWrapper:h,enableDebugLogging:f}=e;return e=>{let i=new C(e,{integrationCategoryMappings:a,shouldEnableIntegration:u,getCategories:n});f&&c.enableDebugLogging();let o=h?.()||Promise.resolve();o.then(()=>{l?.(e=>i.consentChange(e))});let s=async(e,n)=>{if(n?.initialPageview&&(i.page(),n={...n,initialPageview:!1}),await t?.())return;await o;let s=await d(r)();if(s.isAbortCalled){s.abortLoadOptions?.loadSegmentNormally===!0&&i.load(e,n);return}if(i.configureConsentStampingMiddleware(),"opt-in"===s.loadOptions.consentModel){await i.loadWithFilteredDeviceModeDestinations(e,n);return}if("opt-out"===s.loadOptions.consentModel){i.configureBlockingMiddlewareForOptOut(),i.load(e,n);return}!function(e){throw Error(`Unhandled discriminated union member: ${JSON.stringify(e)}`)}(s.loadOptions.consentModel)};return i.replaceLoadMethod(s),e}}},65660:function(e,t,n){"use strict";async function r(e,t){return new Promise((n,r)=>{if(e()){n();return}let i=()=>setTimeout(()=>{e()?n():i()},t);i()})}n.d(t,{K:function(){return r}})},28554:function(e,t,n){"use strict";function r(e,t){return new Promise(function(n,r){var i=setTimeout(function(){r(Error("Promise timed out"))},t);e.then(function(e){return clearTimeout(i),n(e)}).catch(r)})}function i(e,t,n){var i=function(){try{return Promise.resolve(t(e))}catch(e){return Promise.reject(e)}};return new Promise(function(e){return setTimeout(e,n)}).then(function(){return r(i(),1e3)}).catch(function(t){null==e||e.log("warn","Callback Error",{error:t}),null==e||e.stats.increment("callback_error")}).then(function(){return e})}n.d(t,{FJ:function(){return r},UI:function(){return i}})},23790:function(e,t,n){"use strict";n.d(t,{Y:function(){return u},_:function(){return c}});var r=n(58590),i=n(91938),o=n(5853),s=function(){function e(){this._logs=[]}return e.prototype.log=function(e,t,n){var r=new Date;this._logs.push({level:e,message:t,time:r,extras:n})},Object.defineProperty(e.prototype,"logs",{get:function(){return this._logs},enumerable:!1,configurable:!0}),e.prototype.flush=function(){if(this.logs.length>1){var e=this._logs.reduce(function(e,t){var n,r,i,s=(0,o.pi)((0,o.pi)({},t),{json:JSON.stringify(t.extras,null," "),extras:t.extras});delete s.time;var a=null!==(i=null===(r=t.time)||void 0===r?void 0:r.toISOString())&&void 0!==i?i:"";return e[a]&&(a="".concat(a,"-").concat(Math.random())),(0,o.pi)((0,o.pi)({},e),((n={})[a]=s,n))},{});console.table?console.table(e):console.log(e)}else this.logs.forEach(function(e){var t=e.level,n=e.message,r=e.extras;"info"===t||"debug"===t?console.log(n,null!=r?r:""):console[t](n,null!=r?r:"")});this._logs=[]},e}(),a=n(23990),u=function(e){var t,n,r;this.retry=null===(t=e.retry)||void 0===t||t,this.type=null!==(n=e.type)&&void 0!==n?n:"plugin Error",this.reason=null!==(r=e.reason)&&void 0!==r?r:""},c=function(){function e(e,t,n,i){void 0===t&&(t=(0,r.v4)()),void 0===n&&(n=new a.i),void 0===i&&(i=new s),this.attempts=0,this.event=e,this._id=t,this.logger=i,this.stats=n}return e.system=function(){},e.prototype.isSame=function(e){return e.id===this.id},e.prototype.cancel=function(e){if(e)throw e;throw new u({reason:"Context Cancel"})},e.prototype.log=function(e,t,n){this.logger.log(e,t,n)},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),e.prototype.updateEvent=function(e,t){var n;if("integrations"===e.split(".")[0]){var r=e.split(".")[1];if((null===(n=this.event.integrations)||void 0===n?void 0:n[r])===!1)return this.event}return(0,i.N)(this.event,e,t),this.event},e.prototype.failedDelivery=function(){return this._failedDelivery},e.prototype.setFailedDelivery=function(e){this._failedDelivery=e},e.prototype.logs=function(){return this.logger.logs},e.prototype.flush=function(){this.logger.flush(),this.stats.flush()},e.prototype.toJSON=function(){return{id:this._id,event:this.event,logs:this.logger.logs,metrics:this.stats.metrics}},e}()},19203:function(e,t,n){"use strict";n.d(t,{M:function(){return o},Z:function(){return s}});var r=n(5853),i=n(9182),o="onRemoveFromFuture",s=function(e){function t(t,n,r){var i=e.call(this)||this;return i.future=[],i.maxAttempts=t,i.queue=n,i.seen=null!=r?r:{},i}return(0,r.ZT)(t,e),t.prototype.push=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.map(function(t){return!(e.updateAttempts(t)>e.maxAttempts||e.includes(t))&&(e.queue.push(t),!0)});return this.queue=this.queue.sort(function(t,n){return e.getAttempts(t)-e.getAttempts(n)}),r},t.prototype.pushWithBackoff=function(e){var t,n,r,i,s=this;if(0===this.getAttempts(e))return this.push(e)[0];var a=this.updateAttempts(e);return!(a>this.maxAttempts||this.includes(e))&&(setTimeout(function(){s.queue.push(e),s.future=s.future.filter(function(t){return t.id!==e.id}),s.emit(o)},(n=(t={attempt:a-1}).minTimeout,Math.min((Math.random()+1)*(void 0===n?500:n)*Math.pow(void 0===(r=t.factor)?2:r,t.attempt),void 0===(i=t.maxTimeout)?1/0:i))),this.future.push(e),!0)},t.prototype.getAttempts=function(e){var t;return null!==(t=this.seen[e.id])&&void 0!==t?t:0},t.prototype.updateAttempts=function(e){return this.seen[e.id]=this.getAttempts(e)+1,this.getAttempts(e)},t.prototype.includes=function(e){return this.queue.includes(e)||this.future.includes(e)||!!this.queue.find(function(t){return t.id===e.id})||!!this.future.find(function(t){return t.id===e.id})},t.prototype.pop=function(){return this.queue.shift()},Object.defineProperty(t.prototype,"length",{get:function(){return this.queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"todo",{get:function(){return this.queue.length+this.future.length},enumerable:!1,configurable:!0}),t}(i.Q)},24147:function(e,t,n){"use strict";n.d(t,{a:function(){return o},z:function(){return s}});var r=n(5853),i=n(23790);function o(e,t){e.log("debug","plugin",{plugin:t.name});var n=new Date().getTime(),o=t[e.event.type];return void 0===o?Promise.resolve(e):(function(e){return(0,r.mG)(this,void 0,void 0,function(){return(0,r.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e()];case 1:return[2,t.sent()];case 2:return[2,Promise.reject(t.sent())];case 3:return[2]}})})})(function(){return o.apply(t,[e])}).then(function(e){var r=new Date().getTime()-n;return e.stats.gauge("plugin_time",r,["plugin:".concat(t.name)]),e}).catch(function(n){if(n instanceof i.Y&&"middleware_cancellation"===n.type)throw n;return n instanceof i.Y?e.log("warn",n.type,{plugin:t.name,error:n}):(e.log("error","plugin Error",{plugin:t.name,error:n}),e.stats.increment("plugin_error",1,["plugin:".concat(t.name)])),n})}function s(e,t){return o(e,t).then(function(t){if(t instanceof i._)return t;e.log("debug","Context canceled"),e.stats.increment("context_canceled"),e.cancel(t)})}},23990:function(e,t,n){"use strict";n.d(t,{i:function(){return o},s:function(){return i}});var r=n(5853),i=function(){function e(){this.metrics=[]}return e.prototype.increment=function(e,t,n){void 0===t&&(t=1),this.metrics.push({metric:e,value:t,tags:null!=n?n:[],type:"counter",timestamp:Date.now()})},e.prototype.gauge=function(e,t,n){this.metrics.push({metric:e,value:t,tags:null!=n?n:[],type:"gauge",timestamp:Date.now()})},e.prototype.flush=function(){var e=this.metrics.map(function(e){return(0,r.pi)((0,r.pi)({},e),{tags:e.tags.join(",")})});console.table?console.table(e):console.log(e),this.metrics=[]},e.prototype.serialize=function(){return this.metrics.map(function(e){return{m:e.metric,v:e.value,t:e.tags,k:({gauge:"g",counter:"c"})[e.type],e:e.timestamp}})},e}(),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.prototype.gauge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.increment=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.flush=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.serialize=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return[]},t}(i)},75068:function(e,t,n){"use strict";function r(e){return"string"==typeof e}function i(e){return"number"==typeof e}function o(e){return"function"==typeof e}function s(e){return null!=e}function a(e){return"object"===Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}n.d(t,{Gg:function(){return s},HD:function(){return r},PO:function(){return a},hj:function(){return i},mf:function(){return o}})},94730:function(e,t,n){"use strict";n.d(t,{d:function(){return r}});var r=function(){var e,t,n=!1,r=new Promise(function(r,i){e=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n=!0,r.apply(void 0,e)},t=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n=!0,i.apply(void 0,e)}});return{resolve:e,reject:t,promise:r,isSettled:function(){return n}}}},9182:function(e,t,n){"use strict";n.d(t,{Q:function(){return r}});var r=function(){function e(e){var t;this.callbacks={},this.warned=!1,this.maxListeners=null!==(t=null==e?void 0:e.maxListeners)&&void 0!==t?t:10}return e.prototype.warnIfPossibleMemoryLeak=function(e){!this.warned&&this.maxListeners&&this.callbacks[e].length>this.maxListeners&&(console.warn("Event Emitter: Possible memory leak detected; ".concat(String(e)," has exceeded ").concat(this.maxListeners," listeners.")),this.warned=!0)},e.prototype.on=function(e,t){return this.callbacks[e]?(this.callbacks[e].push(t),this.warnIfPossibleMemoryLeak(e)):this.callbacks[e]=[t],this},e.prototype.once=function(e,t){var n=this,r=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];n.off(e,r),t.apply(n,i)};return this.on(e,r),this},e.prototype.off=function(e,t){var n,r=(null!==(n=this.callbacks[e])&&void 0!==n?n:[]).filter(function(e){return e!==t});return this.callbacks[e]=r,this},e.prototype.emit=function(e){for(var t,n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return(null!==(t=this.callbacks[e])&&void 0!==t?t:[]).forEach(function(e){e.apply(n,r)}),this},e}()},97558:function(e,t,n){"use strict";n.d(t,{b:function(){return eU}});var r,i,o=n(5853),s=n(25566);function a(){return void 0!==s&&s.env?s.env:{}}var u=n(45481),c=n(74683),l=n(75068);function d(e,t,n,r){var i,o=[e,t,n,r],s=(0,l.PO)(e)?e.event:e;if(!s||!(0,l.HD)(s))throw Error("Event missing");var a=(0,l.PO)(e)?null!==(i=e.properties)&&void 0!==i?i:{}:(0,l.PO)(t)?t:{},u={};return(0,l.mf)(n)||(u=null!=n?n:{}),(0,l.PO)(e)&&!(0,l.mf)(t)&&(u=null!=t?t:{}),[s,a,u,o.find(l.mf)]}function h(e,t,n,r,i){var o,s,a=null,u=null,c=[e,t,n,r,i],d=c.filter(l.HD);void 0!==d[0]&&void 0!==d[1]&&(a=d[0],u=d[1]),1===d.length&&(a=null,u=d[0]);var h=c.find(l.mf),f=c.filter(function(e){return null===u?(0,l.PO)(e):(0,l.PO)(e)||null===e}),p=null!==(o=f[0])&&void 0!==o?o:{},v=null!==(s=f[1])&&void 0!==s?s:{};return[a,u,p,v,h]}var f=function(e){return function(){for(var t,n,r,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];for(var s={},a=["callback","options","traits","id"],u=0;u<i.length;u++){var c=i[u],d=a.pop();if("id"===d){if((0,l.HD)(c)||(0,l.hj)(c)){s.id=c.toString();continue}if(null==c)continue;d=a.pop()}if(("traits"===d||"options"===d)&&(null==c||(0,l.PO)(c))&&(s[d]=c),(0,l.mf)(c)){s.callback=c;break}}return[null!==(t=s.id)&&void 0!==t?t:e.id(),null!==(n=s.traits)&&void 0!==n?n:{},null!==(r=s.options)&&void 0!==r?r:{},s.callback]}};function p(e,t,n,r){(0,l.hj)(e)&&(e=e.toString()),(0,l.hj)(t)&&(t=t.toString());var i=[e,t,n,r],o=i.filter(l.HD),s=o[0],a=void 0===s?e:s,u=o[1],c=i.filter(l.PO)[0];return[a,void 0===u?null:u,void 0===c?{}:c,i.find(l.mf)]}var v=n(88775),g=n(52322),y=n(28554),m=n(9182),b=n(58590),w=function(e,t,n,r,i,o){return{__t:"bpc",c:t,p:r,u:e,s:n,t:i,r:o}},S=Object.keys(w("","","","","","")),_=function(e){var t=e.indexOf("#");return -1===t?e:e.slice(0,t)},I=function(e){try{return new URL(e).pathname}catch(t){return"/"===e[0]?e:"/"+e}},E=function(e){var t=e.c,n=e.p,r=e.s,i=e.u,o=e.r,s=e.t,a=t?I(t):n,u=t?t.indexOf("?")>-1?t:t+r:_(i);return{path:a,referrer:o,search:r,title:s,url:u}},C=function(){var e=document.querySelector("link[rel='canonical']");return w(location.href,e&&e.getAttribute("href")||void 0,location.search,location.pathname,document.title,document.referrer)},x=function(e,t){void 0===t&&(t=E(C()));var n,r,i,s=e.context;"page"===e.type&&(i=e.properties&&(n=e.properties,r=Object.keys(t),Object.assign.apply(Object,(0,o.ev)([{}],r.map(function(e){var t;if(n&&Object.prototype.hasOwnProperty.call(n,e))return(t={})[e]=n[e],t}),!1))),e.properties=(0,o.pi)((0,o.pi)((0,o.pi)({},t),e.properties),e.name?{name:e.name}:{})),s.page=(0,o.pi)((0,o.pi)((0,o.pi)({},t),i),s.page)},O=n(91938),P=function(e){function t(t,n){var r=e.call(this,"".concat(t," ").concat(n))||this;return r.field=t,r}return(0,o.ZT)(t,e),t}(Error),k="is not a string",D="is not an object",T=function(e){var t,n;this.settings=e,this.createMessageId=e.createMessageId,this.onEventMethodCall=null!==(t=e.onEventMethodCall)&&void 0!==t?t:function(){},this.onFinishedEvent=null!==(n=e.onFinishedEvent)&&void 0!==n?n:function(){}},M=function(e){function t(t){var n=e.call(this,{createMessageId:function(){return"ajs-next-".concat(Date.now(),"-").concat((0,b.v4)())},onEventMethodCall:function(e){var t=e.options;n.maybeUpdateAnonId(t)},onFinishedEvent:function(e){return n.addIdentity(e),e}})||this;return n.user=t,n}return(0,o.ZT)(t,e),t.prototype.maybeUpdateAnonId=function(e){(null==e?void 0:e.anonymousId)&&this.user.anonymousId(e.anonymousId)},t.prototype.addIdentity=function(e){this.user.id()&&(e.userId=this.user.id()),this.user.anonymousId()&&(e.anonymousId=this.user.anonymousId())},t.prototype.track=function(t,n,r,i,o){var s=e.prototype.track.call(this,t,n,r,i);return x(s,o),s},t.prototype.page=function(t,n,r,i,o,s){var a=e.prototype.page.call(this,t,n,r,i,o);return x(a,s),a},t.prototype.screen=function(t,n,r,i,o,s){var a=e.prototype.screen.call(this,t,n,r,i,o);return x(a,s),a},t.prototype.identify=function(t,n,r,i,o){var s=e.prototype.identify.call(this,t,n,r,i);return x(s,o),s},t.prototype.group=function(t,n,r,i,o){var s=e.prototype.group.call(this,t,n,r,i);return x(s,o),s},t.prototype.alias=function(t,n,r,i,o){var s=e.prototype.alias.call(this,t,n,r,i);return x(s,o),s},t}(function(){function e(e){this.settings=new T(e)}return e.prototype.track=function(e,t,n,r){return this.settings.onEventMethodCall({type:"track",options:n}),this.normalize((0,o.pi)((0,o.pi)({},this.baseEvent()),{event:e,type:"track",properties:null!=t?t:{},options:(0,o.pi)({},n),integrations:(0,o.pi)({},r)}))},e.prototype.page=function(e,t,n,r,i){this.settings.onEventMethodCall({type:"page",options:r});var s,a={type:"page",properties:(0,o.pi)({},n),options:(0,o.pi)({},r),integrations:(0,o.pi)({},i)};return null!==e&&(a.category=e,a.properties=null!==(s=a.properties)&&void 0!==s?s:{},a.properties.category=e),null!==t&&(a.name=t),this.normalize((0,o.pi)((0,o.pi)({},this.baseEvent()),a))},e.prototype.screen=function(e,t,n,r,i){this.settings.onEventMethodCall({type:"screen",options:r});var s={type:"screen",properties:(0,o.pi)({},n),options:(0,o.pi)({},r),integrations:(0,o.pi)({},i)};return null!==e&&(s.category=e),null!==t&&(s.name=t),this.normalize((0,o.pi)((0,o.pi)({},this.baseEvent()),s))},e.prototype.identify=function(e,t,n,r){return this.settings.onEventMethodCall({type:"identify",options:n}),this.normalize((0,o.pi)((0,o.pi)({},this.baseEvent()),{type:"identify",userId:e,traits:null!=t?t:{},options:(0,o.pi)({},n),integrations:r}))},e.prototype.group=function(e,t,n,r){return this.settings.onEventMethodCall({type:"group",options:n}),this.normalize((0,o.pi)((0,o.pi)({},this.baseEvent()),{type:"group",traits:null!=t?t:{},options:(0,o.pi)({},n),integrations:(0,o.pi)({},r),groupId:e}))},e.prototype.alias=function(e,t,n,r){this.settings.onEventMethodCall({type:"alias",options:n});var i={userId:e,type:"alias",options:(0,o.pi)({},n),integrations:(0,o.pi)({},r)};return(null!==t&&(i.previousId=t),void 0===e)?this.normalize((0,o.pi)((0,o.pi)({},i),this.baseEvent())):this.normalize((0,o.pi)((0,o.pi)({},this.baseEvent()),i))},e.prototype.baseEvent=function(){return{integrations:{},options:{}}},e.prototype.context=function(e){var t,n=["userId","anonymousId","timestamp","messageId"];delete e.integrations;var r=Object.keys(e),i=null!==(t=e.context)&&void 0!==t?t:{},o={};return r.forEach(function(t){"context"!==t&&(n.includes(t)?(0,O.N)(o,t,e[t]):(0,O.N)(i,t,e[t]))}),[i,o]},e.prototype.normalize=function(e){var t,n,r,i,s=Object.keys(null!==(r=e.integrations)&&void 0!==r?r:{}).reduce(function(t,n){var r,i;return(0,o.pi)((0,o.pi)({},t),((r={})[n]=!!(null===(i=e.integrations)||void 0===i?void 0:i[n]),r))},{});e.options=(t=e.options||{},n=function(e,t){return void 0!==t},Object.keys(t).filter(function(e){return n(e,t[e])}).reduce(function(e,n){return e[n]=t[n],e},{}));var a=(0,o.pi)((0,o.pi)({},s),null===(i=e.options)||void 0===i?void 0:i.integrations),u=e.options?this.context(e.options):[],c=u[0],d=u[1],h=e.options,f=(0,o._T)(e,["options"]),p=(0,o.pi)((0,o.pi)((0,o.pi)((0,o.pi)({timestamp:new Date},f),{context:c,integrations:a}),d),{messageId:h.messageId||this.settings.createMessageId()});return this.settings.onFinishedEvent(p),function(e){if(!(0,l.Gg)(e))throw new P("Event","is nil");if("object"!=typeof e)throw new P("Event",D)}(p),function(e){if(!(0,l.HD)(e.type))throw new P(".type",k)}(p),function(e){if(!(0,l.HD)(e.messageId))throw new P(".messageId",k)}(p),"track"===p.type&&(function(e){if(!(0,l.HD)(e.event))throw new P(".event",k)}(p),function(e){if(!(0,l.PO)(e.properties))throw new P(".properties",D)}(p)),["group","identify"].includes(p.type)&&function(e){if(!(0,l.PO)(e.traits))throw new P(".traits",D)}(p),p},e}()),A=function(e){return"addMiddleware"in e&&"destination"===e.type},j=n(14883),R=n(19203),L=n(23790),N=function(){var e,t,n=0;return{done:function(){return e},run:function(r){var i=r();return"object"==typeof i&&null!==i&&"then"in i&&"function"==typeof i.then&&(1==++n&&(e=new Promise(function(e){return t=e})),i.finally(function(){return 0==--n&&t()})),i}}},F=n(24147),q=function(e){function t(t){return e.call(this,"string"==typeof t?new j.$(4,t):t)||this}return(0,o.ZT)(t,e),t.prototype.flush=function(){return(0,o.mG)(this,void 0,void 0,function(){return(0,o.Jh)(this,function(t){return(0,v.s)()?[2,[]]:[2,e.prototype.flush.call(this)]})})},t}(function(e){function t(t){var n=e.call(this)||this;return n.criticalTasks=N(),n.plugins=[],n.failedInitializations=[],n.flushing=!1,n.queue=t,n.queue.on(R.M,function(){n.scheduleFlush(0)}),n}return(0,o.ZT)(t,e),t.prototype.register=function(e,t,n){return(0,o.mG)(this,void 0,void 0,function(){var r,i,s=this;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(this.plugins.push(t),r=function(n){s.failedInitializations.push(t.name),s.emit("initialization_failure",t),console.warn(t.name,n),e.log("warn","Failed to load destination",{plugin:t.name,error:n}),s.plugins=s.plugins.filter(function(e){return e!==t})},!("destination"===t.type&&"Segment.io"!==t.name))return[3,1];return t.load(e,n).catch(r),[3,4];case 1:return o.trys.push([1,3,,4]),[4,t.load(e,n)];case 2:return o.sent(),[3,4];case 3:return i=o.sent(),r(i),[3,4];case 4:return[2]}})})},t.prototype.deregister=function(e,t,n){return(0,o.mG)(this,void 0,void 0,function(){var r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:if(i.trys.push([0,3,,4]),!t.unload)return[3,2];return[4,Promise.resolve(t.unload(e,n))];case 1:i.sent(),i.label=2;case 2:return this.plugins=this.plugins.filter(function(e){return e.name!==t.name}),[3,4];case 3:return r=i.sent(),e.log("warn","Failed to unload destination",{plugin:t.name,error:r}),[3,4];case 4:return[2]}})})},t.prototype.dispatch=function(e){return(0,o.mG)(this,void 0,void 0,function(){var t;return(0,o.Jh)(this,function(n){return e.log("debug","Dispatching"),e.stats.increment("message_dispatched"),this.queue.push(e),t=this.subscribeToDelivery(e),this.scheduleFlush(0),[2,t]})})},t.prototype.subscribeToDelivery=function(e){return(0,o.mG)(this,void 0,void 0,function(){var t=this;return(0,o.Jh)(this,function(n){return[2,new Promise(function(n){var r=function(i,o){i.isSame(e)&&(t.off("flush",r),n(i))};t.on("flush",r)})]})})},t.prototype.dispatchSingle=function(e){return(0,o.mG)(this,void 0,void 0,function(){var t=this;return(0,o.Jh)(this,function(n){return e.log("debug","Dispatching"),e.stats.increment("message_dispatched"),this.queue.updateAttempts(e),e.attempts=1,[2,this.deliver(e).catch(function(n){return t.enqueuRetry(n,e)?t.subscribeToDelivery(e):(e.setFailedDelivery({reason:n}),e)})]})})},t.prototype.isEmpty=function(){return 0===this.queue.length},t.prototype.scheduleFlush=function(e){var t=this;void 0===e&&(e=500),this.flushing||(this.flushing=!0,setTimeout(function(){t.flush().then(function(){setTimeout(function(){t.flushing=!1,t.queue.length&&t.scheduleFlush(0)},0)})},e))},t.prototype.deliver=function(e){return(0,o.mG)(this,void 0,void 0,function(){var t,n,r,i;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return[4,this.criticalTasks.done()];case 1:o.sent(),t=Date.now(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.flushOne(e)];case 3:return e=o.sent(),n=Date.now()-t,this.emit("delivery_success",e),e.stats.gauge("delivered",n),e.log("debug","Delivered",e.event),[2,e];case 4:throw i=r=o.sent(),e.log("error","Failed to deliver",i),this.emit("delivery_failure",e,i),e.stats.increment("delivery_failed"),r;case 5:return[2]}})})},t.prototype.enqueuRetry=function(e,t){return(!(e instanceof L.Y)||!!e.retry)&&this.queue.pushWithBackoff(t)},t.prototype.flush=function(){return(0,o.mG)(this,void 0,void 0,function(){var e,t;return(0,o.Jh)(this,function(n){switch(n.label){case 0:if(0===this.queue.length||!(e=this.queue.pop()))return[2,[]];e.attempts=this.queue.getAttempts(e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.deliver(e)];case 2:return e=n.sent(),this.emit("flush",e,!0),[3,4];case 3:return t=n.sent(),this.enqueuRetry(t,e)||(e.setFailedDelivery({reason:t}),this.emit("flush",e,!1)),[2,[]];case 4:return[2,[e]]}})})},t.prototype.isReady=function(){return!0},t.prototype.availableExtensions=function(e){var t,n,r=(t="type",n={},this.plugins.filter(function(t){if("destination"!==t.type&&"Segment.io"!==t.name)return!0;var n,r,i,o=void 0;return null===(n=t.alternativeNames)||void 0===n||n.forEach(function(t){void 0!==e[t]&&(o=e[t])}),null!==(i=null!==(r=e[t.name])&&void 0!==r?r:o)&&void 0!==i?i:!1!==("Segment.io"===t.name||e.All)}).forEach(function(e){var r,i=void 0;if("string"==typeof t){var s=e[t];i="string"!=typeof s?JSON.stringify(s):s}else t instanceof Function&&(i=t(e));void 0!==i&&(n[i]=(0,o.ev)((0,o.ev)([],null!==(r=n[i])&&void 0!==r?r:[],!0),[e],!1))}),n),i=r.before,s=r.enrichment,a=r.destination,u=r.after;return{before:void 0===i?[]:i,enrichment:void 0===s?[]:s,destinations:void 0===a?[]:a,after:void 0===u?[]:u}},t.prototype.flushOne=function(e){var t,n;return(0,o.mG)(this,void 0,void 0,function(){var r,i,s,a,u,c,l,d,h,f,p,v,g;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(!this.isReady())throw Error("Not ready");e.attempts>1&&this.emit("delivery_retry",e),i=(r=this.availableExtensions(null!==(t=e.event.integrations)&&void 0!==t?t:{})).before,s=r.enrichment,a=0,u=i,o.label=1;case 1:if(!(a<u.length))return[3,4];return c=u[a],[4,(0,F.z)(e,c)];case 2:(l=o.sent())instanceof L._&&(e=l),this.emit("message_enriched",e,c),o.label=3;case 3:return a++,[3,1];case 4:d=0,h=s,o.label=5;case 5:if(!(d<h.length))return[3,8];return f=h[d],[4,(0,F.a)(e,f)];case 6:(l=o.sent())instanceof L._&&(e=l),this.emit("message_enriched",e,f),o.label=7;case 7:return d++,[3,5];case 8:return v=(p=this.availableExtensions(null!==(n=e.event.integrations)&&void 0!==n?n:{})).destinations,g=p.after,[4,new Promise(function(t,n){setTimeout(function(){Promise.all(v.map(function(t){return(0,F.a)(e,t)})).then(t).catch(n)},0)})];case 9:return o.sent(),e.stats.increment("message_delivered"),this.emit("message_delivered",e),[4,Promise.all(g.map(function(t){return(0,F.a)(e,t)}))];case 10:return o.sent(),[2,e]}})})},t}(m.Q));function B(e){for(var t=e.constructor.prototype,n=0,r=Object.getOwnPropertyNames(t);n<r.length;n++){var i=r[n];if("constructor"!==i){var o=Object.getOwnPropertyDescriptor(e.constructor.prototype,i);o&&"function"==typeof o.value&&(e[i]=e[i].bind(e))}}return e}var G={Cookie:"cookie",LocalStorage:"localStorage",Memory:"memory"},J=function(e,t,n,r){console.warn("".concat(e.constructor.name,": Can't ").concat(t,' key "').concat(n,'" | Err: ').concat(r))},U=function(){function e(e){this.stores=e}return e.prototype.get=function(e){for(var t=null,n=0,r=this.stores;n<r.length;n++){var i=r[n];try{if(null!=(t=i.get(e)))return t}catch(t){J(i,"get",e,t)}}return null},e.prototype.set=function(e,t){this.stores.forEach(function(n){try{n.set(e,t)}catch(t){J(n,"set",e,t)}})},e.prototype.clear=function(e){this.stores.forEach(function(t){try{t.remove(e)}catch(n){J(t,"remove",e,n)}})},e.prototype.getAndSync=function(e){var t=this.get(e),n="number"==typeof t?t.toString():t;return this.set(e,n),n},e}(),z=function(){function e(){this.cache={}}return e.prototype.get=function(e){var t;return null!==(t=this.cache[e])&&void 0!==t?t:null},e.prototype.set=function(e,t){this.cache[e]=t},e.prototype.remove=function(e){delete this.cache[e]},e}();function W(e){return e&&e.stores&&Array.isArray(e.stores)&&e.stores.every(function(e){return Object.values(G).includes(e)})}function K(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var $=function e(t,n){function r(e,r,i){if("undefined"!=typeof document){"number"==typeof(i=K({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var s in i)i[s]&&(o+="; "+s,!0!==i[s]&&(o+="="+i[s].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+o}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},i=0;i<n.length;i++){var o=n[i].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(r[a]=t.read(s,a),e===a)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){r(e,"",K({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,K({},this.attributes,t))},withConverter:function(t){return e(K({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});function H(e){var t=function(e){try{return new URL(e)}catch(e){return}}(e);if(t)for(var n=function(e){var t=e.hostname.split("."),n=t[t.length-1],r=[];if(4===t.length&&parseInt(n,10)>0||t.length<=1)return r;for(var i=t.length-2;i>=0;--i)r.push(t.slice(i).join("."));return r}(t),r=0;r<n.length;++r){var i="__tld__",o=n[r],s={domain:"."+o};try{if($.set(i,"1",s),$.get(i))return $.remove(i,s),o}catch(e){return}}}var V=function(){function e(t){void 0===t&&(t=e.defaults),this.options=(0,o.pi)((0,o.pi)({},e.defaults),t)}return Object.defineProperty(e,"defaults",{get:function(){return{maxage:365,domain:H(window.location.href),path:"/",sameSite:"Lax"}},enumerable:!1,configurable:!0}),e.prototype.opts=function(){return{sameSite:this.options.sameSite,expires:this.options.maxage,domain:this.options.domain,path:this.options.path,secure:this.options.secure}},e.prototype.get=function(e){var t;try{var n=$.get(e);if(null==n)return null;try{return null!==(t=JSON.parse(n))&&void 0!==t?t:null}catch(e){return null!=n?n:null}}catch(e){return null}},e.prototype.set=function(e,t){"string"==typeof t?$.set(e,t,this.opts()):null===t?$.remove(e,this.opts()):$.set(e,JSON.stringify(t),this.opts())},e.prototype.remove=function(e){return $.remove(e,this.opts())},e}(),Z=function(){function e(){}return e.prototype.localStorageWarning=function(e,t){console.warn("Unable to access ".concat(e,", localStorage may be ").concat(t))},e.prototype.get=function(e){var t;try{var n=localStorage.getItem(e);if(null===n)return null;try{return null!==(t=JSON.parse(n))&&void 0!==t?t:null}catch(e){return null!=n?n:null}}catch(t){return this.localStorageWarning(e,"unavailable"),null}},e.prototype.set=function(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(t){this.localStorageWarning(e,"full")}},e.prototype.remove=function(e){try{return localStorage.removeItem(e)}catch(t){this.localStorageWarning(e,"unavailable")}},e}();function Q(e){return e.map(function(e){var t,n;switch("object"==typeof e&&void 0!==e.name?(t=e.name,n=e.settings):t=e,t){case G.Cookie:return new V(n);case G.LocalStorage:return new Z;case G.Memory:return new z;default:throw Error("Unknown Store Type: ".concat(e))}})}function X(e,t){return e.map(function(e){return t&&e===G.Cookie?{name:e,settings:t}:e})}var Y={persist:!0,cookie:{key:"ajs_user_id",oldKey:"ajs_user"},localStorage:{key:"ajs_user_traits"}},ee=function(){function e(e,t){void 0===e&&(e=Y);var n,r,i,s,a=this;this.options={},this.id=function(e){if(a.options.disable)return null;var t=a.identityStore.getAndSync(a.idKey);void 0!==e&&(a.identityStore.set(a.idKey,e),e!==t&&null!==t&&null!==e&&a.anonymousId(null));var n=a.identityStore.getAndSync(a.idKey);if(n)return n;var r=a.legacyUserStore.get(Y.cookie.oldKey);return r?"object"==typeof r?r.id:r:null},this.anonymousId=function(e){var t,n;if(a.options.disable)return null;if(void 0===e){var r=null!==(t=a.identityStore.getAndSync(a.anonKey))&&void 0!==t?t:null===(n=a.legacySIO())||void 0===n?void 0:n[0];if(r)return r}return null===e?a.identityStore.set(a.anonKey,null):a.identityStore.set(a.anonKey,null!=e?e:(0,b.v4)()),a.identityStore.getAndSync(a.anonKey)},this.traits=function(e){var t;if(!a.options.disable)return null===e&&(e={}),e&&a.traitsStore.set(a.traitsKey,null!=e?e:{}),null!==(t=a.traitsStore.get(a.traitsKey))&&void 0!==t?t:{}},this.options=(0,o.pi)((0,o.pi)({},Y),e),this.cookieOptions=t,this.idKey=null!==(r=null===(n=e.cookie)||void 0===n?void 0:n.key)&&void 0!==r?r:Y.cookie.key,this.traitsKey=null!==(s=null===(i=e.localStorage)||void 0===i?void 0:i.key)&&void 0!==s?s:Y.localStorage.key,this.anonKey="ajs_anonymous_id",this.identityStore=this.createStorage(this.options,t),this.legacyUserStore=this.createStorage(this.options,t,function(e){return e===G.Cookie}),this.traitsStore=this.createStorage(this.options,t,function(e){return e!==G.Cookie});var u=this.legacyUserStore.get(Y.cookie.oldKey);u&&"object"==typeof u&&(u.id&&this.id(u.id),u.traits&&this.traits(u.traits)),B(this)}return e.prototype.legacySIO=function(){var e=this.legacyUserStore.get("_sio");if(!e)return null;var t=e.split("----");return[t[0],t[1]]},e.prototype.identify=function(e,t){if(!this.options.disable){t=null!=t?t:{};var n=this.id();(null===n||n===e)&&(t=(0,o.pi)((0,o.pi)({},this.traits()),t)),e&&this.id(e),this.traits(t)}},e.prototype.logout=function(){this.anonymousId(null),this.id(null),this.traits({})},e.prototype.reset=function(){this.logout(),this.identityStore.clear(this.idKey),this.identityStore.clear(this.anonKey),this.traitsStore.clear(this.traitsKey)},e.prototype.load=function(){return new e(this.options,this.cookieOptions)},e.prototype.save=function(){return!0},e.prototype.createStorage=function(e,t,n){var r=[G.LocalStorage,G.Cookie,G.Memory];return e.disable?new U([]):e.persist?(void 0!==e.storage&&null!==e.storage&&W(e.storage)&&(r=e.storage.stores),e.localStorageFallbackDisabled&&(r=r.filter(function(e){return e!==G.LocalStorage})),n&&(r=r.filter(n)),new U(Q(X(r,t)))):new U([new z])},e.defaults=Y,e}(),et={persist:!0,cookie:{key:"ajs_group_id"},localStorage:{key:"ajs_group_properties"}},en=function(e){function t(t,n){void 0===t&&(t=et);var r=e.call(this,(0,o.pi)((0,o.pi)({},et),t),n)||this;return r.anonymousId=function(e){},B(r),r}return(0,o.ZT)(t,e),t}(ee),er=n(78353),ei=n(30339),eo=n(97608),es=function(e,t,n){n.getCalls(e).forEach(function(e){ep(t,e).catch(console.error)})},ea=es.bind(void 0,"on"),eu=es.bind(void 0,"setAnonymousId"),ec=function(e,t){t.toArray().forEach(function(t){setTimeout(function(){ep(e,t).catch(console.error)},0)})},el=function(e){if(ed(e))return E(e.pop())},ed=function(e){return function(e){if(!(0,l.PO)(e)||"bpc"!==e.__t)return!1;for(var t in e)if(!S.includes(t))return!1;return!0}(e[e.length-1])},eh=function(e,t,n,r){void 0===n&&(n=function(){}),void 0===r&&(r=console.error),this.method=e,this.resolve=n,this.reject=r,this.called=!1,this.args=t},ef=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._callMap={},this.push.apply(this,e)}return Object.defineProperty(e.prototype,"calls",{get:function(){return this._pushSnippetWindowBuffer(),this._callMap},set:function(e){this._callMap=e},enumerable:!1,configurable:!0}),e.prototype.getCalls=function(e){var t;return null!==(t=this.calls[e])&&void 0!==t?t:[]},e.prototype.push=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach(function(t){["track","screen","alias","group","page","identify"].includes(t.method)&&!ed(t.args)&&(t.args=(0,o.ev)((0,o.ev)([],t.args,!0),[C()],!1)),e.calls[t.method]?e.calls[t.method].push(t):e.calls[t.method]=[t]})},e.prototype.clear=function(){this._pushSnippetWindowBuffer(),this.calls={}},e.prototype.toArray=function(){var e;return(e=[]).concat.apply(e,Object.values(this.calls))},e.prototype._pushSnippetWindowBuffer=function(){var e=(0,eo.wI)();if(Array.isArray(e)){var t=e.splice(0,e.length).map(function(e){return new eh(e[0],e.slice(1))});this.push.apply(this,t)}},e}();function ep(e,t){return(0,o.mG)(this,void 0,void 0,function(){var n,r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:var o;if(i.trys.push([0,3,,4]),t.called)return[2,void 0];if(t.called=!0,!("object"==typeof(o=n=e[t.method].apply(e,t.args))&&null!==o&&"then"in o&&"function"==typeof o.then))return[3,2];return[4,n];case 1:i.sent(),i.label=2;case 2:return t.resolve(n),[3,4];case 3:return r=i.sent(),t.reject(r),[3,4];case 4:return[2]}})})}var ev=function(){function e(e){var t=this;this.trackSubmit=this._createMethod("trackSubmit"),this.trackClick=this._createMethod("trackClick"),this.trackLink=this._createMethod("trackLink"),this.pageView=this._createMethod("pageview"),this.identify=this._createMethod("identify"),this.reset=this._createMethod("reset"),this.group=this._createMethod("group"),this.track=this._createMethod("track"),this.ready=this._createMethod("ready"),this.alias=this._createMethod("alias"),this.debug=this._createChainableMethod("debug"),this.page=this._createMethod("page"),this.once=this._createChainableMethod("once"),this.off=this._createChainableMethod("off"),this.on=this._createChainableMethod("on"),this.addSourceMiddleware=this._createMethod("addSourceMiddleware"),this.setAnonymousId=this._createMethod("setAnonymousId"),this.addDestinationMiddleware=this._createMethod("addDestinationMiddleware"),this.screen=this._createMethod("screen"),this.register=this._createMethod("register"),this.deregister=this._createMethod("deregister"),this.user=this._createMethod("user"),this.VERSION=er.i,this._preInitBuffer=new ef,this._promise=e(this._preInitBuffer),this._promise.then(function(e){var n=e[0],r=e[1];t.instance=n,t.ctx=r}).catch(function(){})}return e.prototype.then=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._promise).then.apply(e,t)},e.prototype.catch=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._promise).catch.apply(e,t)},e.prototype.finally=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._promise).finally.apply(e,t)},e.prototype._createMethod=function(e){var t=this;return function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return t.instance?Promise.resolve((n=t.instance)[e].apply(n,r)):new Promise(function(n,i){t._preInitBuffer.push(new eh(e,r,n,i))})}},e.prototype._createChainableMethod=function(e){var t=this;return function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return t.instance?(n=t.instance)[e].apply(n,r):t._preInitBuffer.push(new eh(e,r)),t}},e}(),eg="This is being deprecated and will be not be available in future releases of Analytics JS",ey=(0,ei.R)(),em=null==ey?void 0:ey.analytics,eb=function(e){var t;this.timeout=300,this.writeKey=e.writeKey,this.cdnSettings=null!==(t=e.cdnSettings)&&void 0!==t?t:{integrations:{},edgeFunction:{}}};function ew(){console.warn(eg)}var eS=function(e){function t(t,n,r,i,s){var a,u,c,l,d,h,f=this;(f=e.call(this)||this)._debug=!1,f.initialized=!1,f.user=function(){return f._user},f.init=f.initialize.bind(f),f.log=ew,f.addIntegrationMiddleware=ew,f.listeners=ew,f.addEventListener=ew,f.removeAllListeners=ew,f.removeListener=ew,f.removeEventListener=ew,f.hasListeners=ew,f.add=ew,f.addIntegration=ew;var p=null==n?void 0:n.cookie,v=null!==(d=null==n?void 0:n.disableClientPersistence)&&void 0!==d&&d;f.settings=new eb(t),f.queue=null!=r?r:(a="".concat(t.writeKey,":event-queue"),void 0===(u=null==n?void 0:n.retryQueue)&&(u=!1),void 0===(c=v)&&(c=!1),l=u?10:1,new q(c?new R.Z(l,[]):new j.$(l,a)));var g=null==n?void 0:n.storage;return f._universalStorage=f.createStore(v,g,p),f._user=null!=i?i:new ee((0,o.pi)({persist:!v,storage:null==n?void 0:n.storage},null==n?void 0:n.user),p).load(),f._group=null!=s?s:new en((0,o.pi)({persist:!v,storage:null==n?void 0:n.storage},null==n?void 0:n.group),p).load(),f.eventFactory=new M(f._user),f.integrations=null!==(h=null==n?void 0:n.integrations)&&void 0!==h?h:{},f.options=null!=n?n:{},B(f),f}return(0,o.ZT)(t,e),t.prototype.createStore=function(e,t,n){return new U(e?[new z]:t&&W(t)?Q(X(t.stores,n)):Q([G.LocalStorage,{name:G.Cookie,settings:n},G.Memory]))},Object.defineProperty(t.prototype,"storage",{get:function(){return this._universalStorage},enumerable:!1,configurable:!0}),t.prototype.track=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.mG)(this,void 0,void 0,function(){var t,n,r,i,s,a,u,c=this;return(0,o.Jh)(this,function(o){return t=el(e),r=(n=d.apply(void 0,e))[0],i=n[1],s=n[2],a=n[3],u=this.eventFactory.track(r,i,s,this.integrations,t),[2,this._dispatch(u,a).then(function(e){return c.emit("track",r,e.event.properties,e.event.options),e})]})})},t.prototype.page=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.mG)(this,void 0,void 0,function(){var t,n,r,i,s,a,u,c,l=this;return(0,o.Jh)(this,function(o){return t=el(e),r=(n=h.apply(void 0,e))[0],i=n[1],s=n[2],a=n[3],u=n[4],c=this.eventFactory.page(r,i,s,a,this.integrations,t),[2,this._dispatch(c,u).then(function(e){return l.emit("page",r,i,e.event.properties,e.event.options),e})]})})},t.prototype.identify=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.mG)(this,void 0,void 0,function(){var t,n,r,i,s,a,u,c=this;return(0,o.Jh)(this,function(o){return t=el(e),r=(n=f(this._user).apply(void 0,e))[0],i=n[1],s=n[2],a=n[3],this._user.identify(r,i),u=this.eventFactory.identify(this._user.id(),this._user.traits(),s,this.integrations,t),[2,this._dispatch(u,a).then(function(e){return c.emit("identify",e.event.userId,e.event.traits,e.event.options),e})]})})},t.prototype.group=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=el(t);if(0===t.length)return this._group;var i=f(this._group).apply(void 0,t),o=i[0],s=i[1],a=i[2],u=i[3];this._group.identify(o,s);var c=this._group.id(),l=this._group.traits(),d=this.eventFactory.group(c,l,a,this.integrations,r);return this._dispatch(d,u).then(function(t){return e.emit("group",t.event.groupId,t.event.traits,t.event.options),t})},t.prototype.alias=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.mG)(this,void 0,void 0,function(){var t,n,r,i,s,a,u,c=this;return(0,o.Jh)(this,function(o){return t=el(e),r=(n=p.apply(void 0,e))[0],i=n[1],s=n[2],a=n[3],u=this.eventFactory.alias(r,i,s,this.integrations,t),[2,this._dispatch(u,a).then(function(e){return c.emit("alias",r,i,e.event.options),e})]})})},t.prototype.screen=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.mG)(this,void 0,void 0,function(){var t,n,r,i,s,a,u,c,l=this;return(0,o.Jh)(this,function(o){return t=el(e),r=(n=h.apply(void 0,e))[0],i=n[1],s=n[2],a=n[3],u=n[4],c=this.eventFactory.screen(r,i,s,a,this.integrations,t),[2,this._dispatch(c,u).then(function(e){return l.emit("screen",r,i,e.event.properties,e.event.options),e})]})})},t.prototype.trackClick=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.mG)(this,void 0,void 0,function(){var t;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return[4,n.e(8119).then(n.bind(n,86404))];case 1:return[2,(t=r.sent().link).call.apply(t,(0,o.ev)([this],e,!1))]}})})},t.prototype.trackLink=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.mG)(this,void 0,void 0,function(){var t;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return[4,n.e(8119).then(n.bind(n,86404))];case 1:return[2,(t=r.sent().link).call.apply(t,(0,o.ev)([this],e,!1))]}})})},t.prototype.trackSubmit=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.mG)(this,void 0,void 0,function(){var t;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return[4,n.e(8119).then(n.bind(n,86404))];case 1:return[2,(t=r.sent().form).call.apply(t,(0,o.ev)([this],e,!1))]}})})},t.prototype.trackForm=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.mG)(this,void 0,void 0,function(){var t;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return[4,n.e(8119).then(n.bind(n,86404))];case 1:return[2,(t=r.sent().form).call.apply(t,(0,o.ev)([this],e,!1))]}})})},t.prototype.register=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.mG)(this,void 0,void 0,function(){var t,n=this;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return t=g._.system(),[4,Promise.all(e.map(function(e){return n.queue.register(t,e,n)}))];case 1:return r.sent(),[2,t]}})})},t.prototype.deregister=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.mG)(this,void 0,void 0,function(){var t,n=this;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return t=g._.system(),[4,Promise.all(e.map(function(e){var r=n.queue.plugins.find(function(t){return t.name===e});if(r)return n.queue.deregister(t,r,n);t.log("warn","plugin ".concat(e," not found"))}))];case 1:return r.sent(),[2,t]}})})},t.prototype.debug=function(e){return!1===e&&localStorage.getItem("debug")&&localStorage.removeItem("debug"),this._debug=e,this},t.prototype.reset=function(){this._user.reset(),this._group.reset(),this.emit("reset")},t.prototype.timeout=function(e){this.settings.timeout=e},t.prototype._dispatch=function(e,t){return(0,o.mG)(this,void 0,void 0,function(){var n;return(0,o.Jh)(this,function(r){return(n=new g._(e),(0,v.s)()&&!this.options.retryQueue)?[2,n]:[2,function(e,t,n,r){return(0,o.mG)(this,void 0,void 0,function(){var i,s;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(n.emit("dispatch_start",e),i=Date.now(),!t.isEmpty())return[3,2];return[4,t.dispatchSingle(e)];case 1:return s=o.sent(),[3,4];case 2:return[4,t.dispatch(e)];case 3:s=o.sent(),o.label=4;case 4:var a,u;if(!(null==r?void 0:r.callback))return[3,6];return[4,(0,y.UI)(s,r.callback,(a=i,Math.max((null!=(u=r.timeout)?u:300)-(Date.now()-a),0)))];case 5:s=o.sent(),o.label=6;case 6:return(null==r?void 0:r.debug)&&s.flush(),[2,s]}})})}(n,this.queue,this,{callback:t,debug:this._debug,timeout:this.settings.timeout})]})})},t.prototype.addSourceMiddleware=function(e){return(0,o.mG)(this,void 0,void 0,function(){var t=this;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return[4,this.queue.criticalTasks.run(function(){return(0,o.mG)(t,void 0,void 0,function(){var t,r,i;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return[4,Promise.resolve().then(n.bind(n,55217))];case 1:return t=o.sent().sourceMiddlewarePlugin,r={},this.queue.plugins.forEach(function(e){if("destination"===e.type)return r[e.name]=!0}),i=t(e,r),[4,this.register(i)];case 2:return o.sent(),[2]}})})})];case 1:return r.sent(),[2,this]}})})},t.prototype.addDestinationMiddleware=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.queue.plugins.filter(A).forEach(function(n){("*"===e||n.name.toLowerCase()===e.toLowerCase())&&n.addMiddleware.apply(n,t)}),Promise.resolve(this)},t.prototype.setAnonymousId=function(e){return this._user.anonymousId(e)},t.prototype.queryString=function(e){return(0,o.mG)(this,void 0,void 0,function(){return(0,o.Jh)(this,function(t){switch(t.label){case 0:if(!1===this.options.useQueryString)return[2,[]];return[4,n.e(3096).then(n.bind(n,29164))];case 1:return[2,(0,t.sent().queryString)(this,e)]}})})},t.prototype.use=function(e){return e(this),this},t.prototype.ready=function(e){return void 0===e&&(e=function(e){return e}),(0,o.mG)(this,void 0,void 0,function(){return(0,o.Jh)(this,function(t){return[2,Promise.all(this.queue.plugins.map(function(e){return e.ready?e.ready():Promise.resolve()})).then(function(t){return e(t),t})]})})},t.prototype.noConflict=function(){return console.warn(eg),(0,eo.ql)(null!=em?em:this),this},t.prototype.normalize=function(e){return console.warn(eg),this.eventFactory.normalize(e)},Object.defineProperty(t.prototype,"failedInitializations",{get:function(){return console.warn(eg),this.queue.failedInitializations},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"VERSION",{get:function(){return er.i},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e,t){return(0,o.mG)(this,void 0,void 0,function(){return(0,o.Jh)(this,function(e){return console.warn(eg),[2,Promise.resolve(this)]})})},t.prototype.pageview=function(e){return(0,o.mG)(this,void 0,void 0,function(){return(0,o.Jh)(this,function(t){switch(t.label){case 0:return console.warn(eg),[4,this.page({path:e})];case 1:return t.sent(),[2,this]}})})},Object.defineProperty(t.prototype,"plugins",{get:function(){var e;return console.warn(eg),null!==(e=this._plugins)&&void 0!==e?e:{}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Integrations",{get:function(){return console.warn(eg),this.queue.plugins.filter(function(e){return"destination"===e.type}).reduce(function(e,t){var n="".concat(t.name.toLowerCase().replace(".","").split(" ").join("-"),"Integration"),r=window[n];if(!r)return e;var i=r.Integration;return i?e[t.name]=i:e[t.name]=r,e},{})},enumerable:!1,configurable:!0}),t.prototype.push=function(e){var t=e.shift();(!t||this[t])&&this[t].apply(this,e)},t}(m.Q),e_=function(e){function t(){var t=e.call(this,{writeKey:""},{disableClientPersistence:!0})||this;return t.initialized=!0,t}return(0,o.ZT)(t,e),t}(eS),eI=n(70900),eE=n(94730),eC=n(59400),ex=n(43051),eO=function(e){try{var t=new URLSearchParams;return Object.entries(e).forEach(function(e){var n=e[0],r=e[1];Array.isArray(r)?r.forEach(function(e){return t.append(n,e)}):t.append(n,r)}),t.toString()}catch(e){return""}},eP=new function(){var e=this;this.name="Page Enrichment",this.type="before",this.version="0.1.0",this.isLoaded=function(){return!0},this.load=function(t,n){return(0,o.mG)(e,void 0,void 0,function(){var e;return(0,o.Jh)(this,function(t){switch(t.label){case 0:this.instance=n,t.label=1;case 1:return t.trys.push([1,3,,4]),e=this,[4,function(e){return(0,o.mG)(this,void 0,void 0,function(){var t;return(0,o.Jh)(this,function(n){return(t=navigator.userAgentData)?e?[2,t.getHighEntropyValues(e).catch(function(){return t.toJSON()})]:[2,t.toJSON()]:[2,void 0]})})}(this.instance.options.highEntropyValuesClientHints)];case 2:return e.userAgentData=t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:return[2,Promise.resolve()]}})})},this.enrich=function(t){var n,i,s,a,u,c,l,d=t.event.context,h=d.page.search||"",f="object"==typeof h?eO(h):h;d.userAgent=navigator.userAgent,d.userAgentData=e.userAgentData;var p=navigator.userLanguage||navigator.language;void 0===d.locale&&void 0!==p&&(d.locale=p),null!==(c=d.library)&&void 0!==c||(d.library={name:"analytics.js",version:"".concat("web"===(0,eC.B)()?"next":"npm:next","-").concat(er.i)}),f&&!d.campaign&&(d.campaign=((u=f).startsWith("?")&&(u=u.substring(1)),(u=u.replace(/\?/g,"&")).split("&").reduce(function(e,t){var n=t.split("="),r=n[0],i=n[1];if(r.includes("utm_")&&r.length>4){var o=r.slice(4);"campaign"===o&&(o="name"),e[o]=(0,ex.a)(void 0===i?"":i)}return e},{})));var v=function(){var e=$.get("_ga");if(e&&e.startsWith("amp"))return e}();v&&(d.amp={id:v}),s=(i=new U(null!==(l=e.instance.options.disableClientPersistence)&&void 0!==l&&l?[]:[new V(function(){if(r)return r;var e=H(window.location.href);return r={expires:31536e6,secure:!1,path:"/"},e&&(r.domain=e),r}())])).get("s:context.referrer"),(a=null!==(n=function(e){var t={btid:"dataxu",urid:"millennial-media"};e.startsWith("?")&&(e=e.substring(1));for(var n=(e=e.replace(/\?/g,"&")).split("&"),r=0;r<n.length;r++){var i=n[r].split("="),o=i[0],s=i[1];if(t[o])return{id:s,type:t[o]}}}(f))&&void 0!==n?n:s)&&(d&&(d.referrer=(0,o.pi)((0,o.pi)({},d.referrer),a)),i.set("s:context.referrer",a));try{d.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}return t},this.track=this.enrich,this.identify=this.enrich,this.page=this.enrich,this.group=this.enrich,this.alias=this.enrich,this.screen=this.enrich},ek=n(18140),eD=n(55217),eT=n(95329),eM=function(){function e(e,t){this.version="1.0.0",this.alternativeNames=[],this.loadPromise=(0,eE.d)(),this.middleware=[],this.alias=this._createMethod("alias"),this.group=this._createMethod("group"),this.identify=this._createMethod("identify"),this.page=this._createMethod("page"),this.screen=this._createMethod("screen"),this.track=this._createMethod("track"),this.action=t,this.name=e,this.type=t.type,this.alternativeNames.push(t.name)}return e.prototype.addMiddleware=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];"destination"===this.type&&(e=this.middleware).push.apply(e,t)},e.prototype.transform=function(e){return(0,o.mG)(this,void 0,void 0,function(){var t;return(0,o.Jh)(this,function(n){switch(n.label){case 0:return[4,(0,eD.applyDestinationMiddleware)(this.name,e.event,this.middleware)];case 1:return null===(t=n.sent())&&e.cancel(new L.Y({retry:!1,reason:"dropped by destination middleware"})),[2,new g._(t)]}})})},e.prototype._createMethod=function(e){var t=this;return function(n){return(0,o.mG)(t,void 0,void 0,function(){var t,r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:if(!this.action[e])return[2,n];if(t=n,"destination"!==this.type)return[3,2];return[4,this.transform(n)];case 1:t=i.sent(),i.label=2;case 2:return i.trys.push([2,5,,6]),[4,this.ready()];case 3:if(!i.sent())throw Error("Something prevented the destination from getting ready");return(0,eT.z)(n,{integrationName:this.action.name,methodName:e,type:"action"}),[4,this.action[e](t)];case 4:return i.sent(),[3,6];case 5:throw r=i.sent(),(0,eT.z)(n,{integrationName:this.action.name,methodName:e,type:"action",didError:!0}),r;case 6:return[2,n]}})})}},e.prototype.isLoaded=function(){return this.action.isLoaded()},e.prototype.ready=function(){return(0,o.mG)(this,void 0,void 0,function(){return(0,o.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.loadPromise.promise];case 1:return e.sent(),[2,!0];case 2:return e.sent(),[2,!1];case 3:return[2]}})})},e.prototype.load=function(e,t){return(0,o.mG)(this,void 0,void 0,function(){var n,r,i,s;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(this.loadPromise.isSettled())return[2,this.loadPromise.promise];o.label=1;case 1:return o.trys.push([1,3,,4]),(0,eT.z)(e,{integrationName:this.action.name,methodName:"load",type:"action"}),n=this.action.load(e,t),i=(r=this.loadPromise).resolve,[4,n];case 2:return i.apply(r,[o.sent()]),[2,n];case 3:throw s=o.sent(),(0,eT.z)(e,{integrationName:this.action.name,methodName:"load",type:"action",didError:!0}),this.loadPromise.reject(s),s;case 4:return[2]}})})},e.prototype.unload=function(e,t){var n,r;return null===(r=(n=this.action).unload)||void 0===r?void 0:r.call(n,e,t)},e}(),eA=n(96526),ej=function(e){var t=!1;window.addEventListener("pagehide",function(){t||e(t=!0)}),document.addEventListener("visibilitychange",function(){if("hidden"==document.visibilityState){if(t)return;t=!0}else t=!1;e(t)})};function eR(e){return(encodeURI(JSON.stringify(e)).split(/%..|./).length-1)/1024}var eL=n(4488);function eN(e,t,n,r){var i=this;e||setTimeout(function(){return(0,o.mG)(i,void 0,void 0,function(){var e,i;return(0,o.Jh)(this,function(s){switch(s.label){case 0:return e=!0,[4,function(e,t){return(0,o.mG)(this,void 0,void 0,function(){var n,r=this;return(0,o.Jh)(this,function(i){switch(i.label){case 0:if(n=[],(0,v.s)())return[2,t];return[4,(0,eL.x)(function(){return t.length>0&&!(0,v.s)()},function(){return(0,o.mG)(r,void 0,void 0,function(){var r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:if(!(r=t.pop()))return[2];return[4,(0,F.a)(r,e)];case 1:return i.sent() instanceof g._||n.push(r),[2]}})})})];case 1:return i.sent(),n.map(function(e){return t.pushWithBackoff(e)}),[2,t]}})})}(n,t)];case 1:return i=s.sent(),e=!1,t.todo>0&&r(e,i,n,r),[2]}})})},5e3*Math.random())}var eF=n(23192),eq=(0,ei.R)(),eB=null!==(i=eq.__SEGMENT_INSPECTOR__)&&void 0!==i?i:eq.__SEGMENT_INSPECTOR__={},eG=function(e){var t;return null===(t=eB.attach)||void 0===t?void 0:t.call(eB,e)},eJ=n(95424),eU=function(e){function t(){var t=this,r=(0,eE.d)(),i=r.promise,s=r.resolve;return(t=e.call(this,function(e){return i.then(function(t){return function(e,t,r){var i,s,l,d,h,f,p,y,m,b;return void 0===t&&(t={}),(0,o.mG)(this,void 0,void 0,function(){var w,S,_,I,E,C,x,O,P,k,D;return(0,o.Jh)(this,function(T){var M,A,L,N;switch(T.label){case 0:if(!0===t.disable)return[2,[new e_,g._.system()]];if(t.globalAnalyticsKey&&(0,eo.jV)(t.globalAnalyticsKey),e.cdnURL&&(0,u.UH)(e.cdnURL),t.initialPageview&&r.push(new eh("page",[])),!(null!==(i=e.cdnSettings)&&void 0!==i))return[3,1];return S=i,[3,3];case 1:return[4,(M=e.writeKey,L=null!=(A=e.cdnURL)?A:(0,u.Vl)(),(0,c.h)("".concat(L,"/v1/projects/").concat(M,"/settings")).then(function(e){return e.ok?e.json():e.text().then(function(e){throw Error(e)})}).catch(function(e){throw console.error(e.message),e}))];case 2:S=T.sent(),T.label=3;case 3:if(w=S,t.updateCDNSettings&&(w=t.updateCDNSettings(w)),"function"!=typeof t.disable)return[3,5];return[4,t.disable(w)];case 4:if(T.sent())return[2,[new e_,g._.system()]];T.label=5;case 5:return _=null===(l=null===(s=w.integrations["Segment.io"])||void 0===s?void 0:s.retryQueue)||void 0===l||l,t=(0,o.pi)({retryQueue:_},t),eG(I=new eS((0,o.pi)((0,o.pi)({},e),{cdnSettings:w}),t)),E=null!==(d=e.plugins)&&void 0!==d?d:[],C=null!==(h=e.classicIntegrations)&&void 0!==h?h:[],x=null===(f=t.integrations)||void 0===f?void 0:f["Segment.io"],eJ.j.initRemoteMetrics((0,o.pi)((0,o.pi)({},w.metrics),{host:null!==(p=null==x?void 0:x.apiHost)&&void 0!==p?p:null===(y=w.metrics)||void 0===y?void 0:y.host,protocol:null==x?void 0:x.protocol})),eu(N=I,r),ea(N,r),[4,function(e,t,r,i,s,l){var d,h,f;return void 0===s&&(s=[]),(0,o.mG)(this,void 0,void 0,function(){var p,g,y,m,b,w,S,_,I,E,C,x,O,P,k=this;return(0,o.Jh)(this,function(D){var T,M,A;switch(D.label){case 0:if(p=null==s?void 0:s.filter(function(e){return"object"==typeof e}),g=null==s?void 0:s.filter(function(e){return"function"==typeof e&&"string"==typeof e.pluginName}),"test"===a().NODE_ENV||!((null!==(A=null===(M=null===(T=t.middlewareSettings)||void 0===T?void 0:T.routingRules)||void 0===M?void 0:M.length)&&void 0!==A?A:0)>0))return[3,2];return[4,n.e(4604).then(n.bind(n,44027)).then(function(e){return e.tsubMiddleware(t.middlewareSettings.routingRules)})];case 1:return m=D.sent(),[3,3];case 2:m=void 0,D.label=3;case 3:if(y=m,("test"===a().NODE_ENV||!(Object.keys(t.integrations).length>1))&&!(l.length>0))return[3,5];return[4,n.e(9464).then(n.bind(n,60253)).then(function(n){return n.ajsDestinations(e,t,r.integrations,i,y,l)})];case 4:return w=D.sent(),[3,6];case 5:w=[],D.label=6;case 6:if(b=w,!t.legacyVideoPluginsEnabled)return[3,8];return[4,n.e(8150).then(n.bind(n,82730)).then(function(e){return e.loadLegacyVideoPlugins(r)})];case 7:D.sent(),D.label=8;case 8:if(!(null===(d=i.plan)||void 0===d?void 0:d.track))return[3,10];return[4,n.e(7493).then(n.bind(n,86398)).then(function(e){var n;return e.schemaFilter(null===(n=i.plan)||void 0===n?void 0:n.track,t)})];case 9:return _=D.sent(),[3,11];case 10:_=void 0,D.label=11;case 11:return S=_,I=(0,eI.o)(t,i),[4,(function(e,t,n,r,i,s){var a,c,l;return(0,o.mG)(this,void 0,void 0,function(){var d,h,f=this;return(0,o.Jh)(this,function(p){switch(p.label){case 0:return d=[],h=null!==(c=null===(a=e.middlewareSettings)||void 0===a?void 0:a.routingRules)&&void 0!==c?c:[],[4,Promise.all((null!==(l=e.remotePlugins)&&void 0!==l?l:[]).map(function(e){return(0,o.mG)(f,void 0,void 0,function(){var a,c,l,f,p;return(0,o.Jh)(this,function(v){switch(v.label){case 0:var g,y;if(g=t[e.creationName],y=t[e.name],!1===t.All&&!g&&!y||!1===g||!1===y)return[2];v.label=1;case 1:if(v.trys.push([1,6,,7]),c=null==s?void 0:s.find(function(t){return t.pluginName===e.name}))return[3,3];return[4,function(e,t){return(0,o.mG)(this,void 0,void 0,function(){var n,r,i,s,a;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(n=RegExp("https://cdn.segment.(com|build)"),r=(0,u.Vl)(),!t)return[3,6];s=(i=e.url.split("/"))[i.length-2],a=e.url.replace(s,btoa(s).replace(/=/g,"")),o.label=1;case 1:return o.trys.push([1,3,,5]),[4,(0,ek.v)(a.replace(n,r))];case 2:case 4:return o.sent(),[3,5];case 3:return o.sent(),[4,(0,ek.v)(e.url.replace(n,r))];case 5:return[3,8];case 6:return[4,(0,ek.v)(e.url.replace(n,r))];case 7:o.sent(),o.label=8;case 8:if("function"==typeof window[e.libraryName])return[2,window[e.libraryName]];return[2]}})})}(e,null==r?void 0:r.obfuscate)];case 2:c=v.sent(),v.label=3;case 3:if(!(a=c))return[3,5];return[4,a((0,o.pi)((0,o.pi)({},e.settings),n[e.name]))];case 4:(function(e){if(!Array.isArray(e))throw Error("Not a valid list of plugins");var t=["load","isLoaded","name","version","type"];e.forEach(function(e){t.forEach(function(t){var n;if(void 0===e[t])throw Error("Plugin: ".concat(null!==(n=e.name)&&void 0!==n?n:"unknown"," missing required function ").concat(t))})})})(f=Array.isArray(l=v.sent())?l:[l]),p=h.filter(function(t){return t.destinationName===e.creationName}),f.forEach(function(t){var n=new eM(e.creationName,t);p.length&&i&&n.addMiddleware(i),d.push(n)}),v.label=5;case 5:return[3,7];case 6:return console.warn("Failed to load Remote Plugin",v.sent()),[3,7];case 7:return[2]}})})}))];case 1:return p.sent(),[2,d.filter(Boolean)]}})})})(t,r.integrations,I,i,y,g).catch(function(){return[]})];case 12:if(E=D.sent(),C=(0,o.ev)((0,o.ev)((0,o.ev)([eP],p,!0),b,!0),E,!0),S&&C.push(S),(null===(h=i.integrations)||void 0===h?void 0:h.All)===!1&&!i.integrations["Segment.io"]||i.integrations&&!1===i.integrations["Segment.io"])return[3,14];return O=(x=C).push,[4,function(e,t,n){window.addEventListener("pagehide",function(){l.push.apply(l,Array.from(d)),d.clear()});var r,i,s,a,u=null!==(i=null==t?void 0:t.apiKey)&&void 0!==i?i:"",l=e.options.disableClientPersistence?new R.Z(e.queue.queue.maxAttempts,[]):new j.$(e.queue.queue.maxAttempts,"".concat(u,":dest-Segment.io")),d=new Set,h=null!==(s=null==t?void 0:t.apiHost)&&void 0!==s?s:eF.U,f=null!==(a=null==t?void 0:t.protocol)&&void 0!==a?a:"https",p="".concat(f,"://").concat(h),g=null==t?void 0:t.deliveryStrategy,y=(null==g?void 0:g.strategy)==="batching"?function(e,t){var n,r,i,s=[],a=!1,u=null!==(n=null==t?void 0:t.size)&&void 0!==n?n:10,l=null!==(r=null==t?void 0:t.timeout)&&void 0!==r?r:5e3;function d(n){if(0!==n.length){var r,i=null===(r=n[0])||void 0===r?void 0:r.writeKey,s=n.map(function(e){return e.sentAt,(0,o._T)(e,["sentAt"])});return(0,c.h)("https://".concat(e,"/b"),{keepalive:(null==t?void 0:t.keepalive)||a,headers:{"Content-Type":"text/plain"},method:"post",body:JSON.stringify({writeKey:i,batch:s,sentAt:new Date().toISOString()})})}}function h(){return(0,o.mG)(this,void 0,void 0,function(){var e;return(0,o.Jh)(this,function(t){return s.length?(e=s,s=[],[2,d(e)]):[2]})})}return ej(function(e){if((a=e)&&s.length){var t,n;Promise.all((t=[],n=0,s.forEach(function(e){eR(t[n])>=64&&n++,t[n]?t[n].push(e):t[n]=[e]}),t).map(d)).catch(console.error)}}),{dispatch:function(e,n){return(0,o.mG)(this,void 0,void 0,function(){return(0,o.Jh)(this,function(e){return s.push(n),[2,s.length>=u||eR(s)>=450||(null==t?void 0:t.keepalive)&&eR(s)>=54||a?h():void(i||(i=setTimeout(function(){i=void 0,h().catch(console.error)},l)))]})})}}}(h,g.config):(r=null==g?void 0:g.config,{dispatch:function(e,t){return(0,c.h)(e,{keepalive:null==r?void 0:r.keepalive,headers:{"Content-Type":"text/plain"},method:"post",body:JSON.stringify(t)})}});function m(r){return(0,o.mG)(this,void 0,void 0,function(){var i,s;return(0,o.Jh)(this,function(a){if((0,v.s)())return l.push(r),eN(!1,l,b,eN),[2,r];if(d.add(r),i=r.event.type.charAt(0),s=(0,eA.D)(r.event).json(),"track"===r.event.type&&delete s.traits,"alias"===r.event.type){var u,c,h,f,g,m;u=s,m=e.user(),u.previousId=null!==(f=null!==(h=null!==(c=u.previousId)&&void 0!==c?c:u.from)&&void 0!==h?h:m.id())&&void 0!==f?f:m.anonymousId(),u.userId=null!==(g=u.userId)&&void 0!==g?g:u.to,delete u.from,delete u.to,s=u}return[2,y.dispatch("".concat(p,"/").concat(i),function(e,t,n,r){var i,s=e.user();delete t.options,t.writeKey=null==n?void 0:n.apiKey,t.userId=t.userId||s.id(),t.anonymousId=t.anonymousId||s.anonymousId(),t.sentAt=new Date;var a=e.queue.failedInitializations||[];a.length>0&&(t._metadata={failedInitializations:a});var u=[],c=[];for(var l in r){var d=r[l];"Segment.io"===l&&u.push(l),"bundled"===d.bundlingStatus&&u.push(l),"unbundled"===d.bundlingStatus&&c.push(l)}for(var h=0,f=(null==n?void 0:n.unbundledIntegrations)||[];h<f.length;h++){var p=f[h];c.includes(p)||c.push(p)}var v=null!==(i=null==n?void 0:n.maybeBundledConfigIds)&&void 0!==i?i:{},g=[];return u.sort().forEach(function(e){var t;(null!==(t=v[e])&&void 0!==t?t:[]).forEach(function(e){g.push(e)})}),(null==n?void 0:n.addBundledMetadata)!==!1&&(t._metadata=(0,o.pi)((0,o.pi)({},t._metadata),{bundled:u.sort(),unbundled:c.sort(),bundledIds:g})),t}(e,s,t,n)).then(function(){return r}).catch(function(){return l.pushWithBackoff(r),eN(!1,l,b,eN),r}).finally(function(){d.delete(r)})]})})}var b={name:"Segment.io",type:"destination",version:"0.1.0",isLoaded:function(){return!0},load:function(){return Promise.resolve()},track:m,identify:m,page:m,alias:m,group:m,screen:m};return l.todo&&eN(!1,l,b,eN),b}(r,I["Segment.io"],t.integrations)];case 13:O.apply(x,[D.sent()]),D.label=14;case 14:return[4,r.register.apply(r,C)];case 15:if(P=D.sent(),!Object.entries(null!==(f=t.enabledMiddleware)&&void 0!==f?f:{}).some(function(e){return e[1]}))return[3,17];return[4,n.e(9214).then(n.bind(n,2575)).then(function(e){var n=e.remoteMiddlewares;return(0,o.mG)(k,void 0,void 0,function(){return(0,o.Jh)(this,function(e){switch(e.label){case 0:return[4,n(P,t,i.obfuscate)];case 1:return[2,Promise.all(e.sent().map(function(e){return r.addSourceMiddleware(e)}))]}})})})];case 16:D.sent(),D.label=17;case 17:return[2,P]}})})}(e.writeKey,w,I,t,E,C)];case 6:if(O=T.sent(),P=null!==(m=window.location.search)&&void 0!==m?m:"",k=null!==(b=window.location.hash)&&void 0!==b?b:"",!(D=P.length?P:k.replace(/(?=#).*(?=\?)/,"")).includes("ajs_"))return[3,8];return[4,I.queryString(D).catch(console.error)];case 7:T.sent(),T.label=8;case 8:return I.initialized=!0,I.emit("initialize",e,t),[4,function(e,t){return(0,o.mG)(this,void 0,void 0,function(){return(0,o.Jh)(this,function(n){switch(n.label){case 0:return[4,(0,o.mG)(void 0,void 0,void 0,function(){var n,r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:n=0,r=t.getCalls("addSourceMiddleware"),i.label=1;case 1:if(!(n<r.length))return[3,4];return[4,ep(e,r[n]).catch(console.error)];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})];case 1:return n.sent(),ec(e,t),t.clear(),[2]}})})}(I,r)];case 9:return T.sent(),[2,[I,O]]}})})}(t[0],t[1],e)})})||this)._resolveLoadStart=function(e,t){return s([e,t])},t}return(0,o.ZT)(t,e),t.prototype.load=function(e,t){return void 0===t&&(t={}),this._resolveLoadStart(e,t),this},t.load=function(e,n){return void 0===n&&(n={}),new t().load(e,n)},t.standalone=function(e,n){return t.load({writeKey:e},n).then(function(e){return e[0]})},t}(ev)},88775:function(e,t,n){"use strict";n.d(t,{G:function(){return i},s:function(){return o}});var r=n(82836);function i(){return!(0,r.j)()||window.navigator.onLine}function o(){return!i()}},23192:function(e,t,n){"use strict";n.d(t,{U:function(){return r}});var r="api.segment.io/v1"},52322:function(e,t,n){"use strict";n.d(t,{_:function(){return s}});var r=n(5853),i=n(23790),o=n(95424),s=function(e){function t(t,n){return e.call(this,t,n,new o.j)||this}return(0,r.ZT)(t,e),t.system=function(){return new this({type:"track",event:"system"})},t}(i._)},82836:function(e,t,n){"use strict";function r(){return"undefined"!=typeof window}function i(){return!r()}n.d(t,{j:function(){return r},s:function(){return i}})},43051:function(e,t,n){"use strict";function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}}n.d(t,{a:function(){return r}})},95424:function(e,t,n){"use strict";n.d(t,{j:function(){return f}});var r,i=n(5853),o=n(23990),s=n(74683),a=n(78353),u=n(59400),c=n(23192),l=function(e,t,n){var r=t.reduce(function(e,t){var n=t.split(":"),r=n[0],i=n[1];return e[r]=i,e},{});return{type:"Counter",metric:e,value:1,tags:(0,i.pi)((0,i.pi)({},r),{library:"analytics.js",library_version:"web"===n?"next-".concat(a.i):"npm:next-".concat(a.i)})}};function d(e){console.error("Error sending segment performance metrics",e)}var h=function(){function e(e){var t,n,r,i,o,s=this;if(this.host=null!==(t=null==e?void 0:e.host)&&void 0!==t?t:c.U,this.sampleRate=null!==(n=null==e?void 0:e.sampleRate)&&void 0!==n?n:1,this.flushTimer=null!==(r=null==e?void 0:e.flushTimer)&&void 0!==r?r:3e4,this.maxQueueSize=null!==(i=null==e?void 0:e.maxQueueSize)&&void 0!==i?i:20,this.protocol=null!==(o=null==e?void 0:e.protocol)&&void 0!==o?o:"https",this.queue=[],this.sampleRate>0){var a=!1,u=function(){a||(a=!0,s.flush().catch(d),a=!1,setTimeout(u,s.flushTimer))};u()}}return e.prototype.increment=function(e,t){if(!(!e.includes("analytics_js.")||0===t.length||Math.random()>this.sampleRate)&&!(this.queue.length>=this.maxQueueSize)){var n=l(e,t,(0,u.B)());this.queue.push(n),e.includes("error")&&this.flush().catch(d)}},e.prototype.flush=function(){return(0,i.mG)(this,void 0,void 0,function(){var e=this;return(0,i.Jh)(this,function(t){switch(t.label){case 0:if(this.queue.length<=0)return[2];return[4,this.send().catch(function(t){d(t),e.sampleRate=0})];case 1:return t.sent(),[2]}})})},e.prototype.send=function(){return(0,i.mG)(this,void 0,void 0,function(){var e,t,n;return(0,i.Jh)(this,function(r){return e={series:this.queue},this.queue=[],t={"Content-Type":"text/plain"},n="".concat(this.protocol,"://").concat(this.host,"/m"),[2,(0,s.h)(n,{headers:t,body:JSON.stringify(e),method:"POST"})]})})},e}(),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.initRemoteMetrics=function(e){r=new h(e)},t.prototype.increment=function(t,n,i){e.prototype.increment.call(this,t,n,i),null==r||r.increment(t,null!=i?i:[])},t}(o.s)},95329:function(e,t,n){"use strict";function r(e,t){var n=t.methodName,r=t.integrationName,i=t.type,o=t.didError;e.stats.increment("analytics_js.integration.invoke".concat(void 0!==o&&o?".error":""),1,["method:".concat(n),"integration_name:".concat(r),"type:".concat(i)])}n.d(t,{z:function(){return r}})},78353:function(e,t,n){"use strict";n.d(t,{i:function(){return r}});var r="1.72.1"},74683:function(e,t,n){"use strict";n.d(t,{h:function(){return s}});var r=n(52423),i=n.n(r),o=n(30339),s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,o.R)();return(n&&n.fetch||i()).apply(void 0,e)}},30339:function(e,t,n){"use strict";n.d(t,{R:function(){return r}});var r=function(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:null}},97608:function(e,t,n){"use strict";n.d(t,{jV:function(){return o},ql:function(){return s},wI:function(){return i}});var r="analytics";function i(){return window[r]}function o(e){r=e}function s(e){window[r]=e}},18140:function(e,t,n){"use strict";function r(e){return Array.prototype.slice.call(window.document.querySelectorAll("script")).find(function(t){return t.src===e})}function i(e,t){var n=r(e);if(void 0!==n){var i=null==n?void 0:n.getAttribute("status");if("loaded"===i)return Promise.resolve(n);if("loading"===i)return new Promise(function(e,t){n.addEventListener("load",function(){return e(n)}),n.addEventListener("error",function(e){return t(e)})})}return new Promise(function(n,r){var i,o=window.document.createElement("script");o.type="text/javascript",o.src=e,o.async=!0,o.setAttribute("status","loading");for(var s=0,a=Object.entries(null!=t?t:{});s<a.length;s++){var u=a[s],c=u[0],l=u[1];o.setAttribute(c,l)}o.onload=function(){o.onerror=o.onload=null,o.setAttribute("status","loaded"),n(o)},o.onerror=function(){o.onerror=o.onload=null,o.setAttribute("status","error"),r(Error("Failed to load ".concat(e)))};var d=window.document.getElementsByTagName("script")[0];null===(i=d.parentElement)||void 0===i||i.insertBefore(o,d)})}function o(e){var t=r(e);return void 0!==t&&t.remove(),Promise.resolve()}n.d(t,{t:function(){return o},v:function(){return i}})},70900:function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var r=n(5853);function i(e,t){var n,i=Object.entries(null!==(n=t.integrations)&&void 0!==n?n:{}).reduce(function(e,t){var n,i,o=t[0],s=t[1];return"object"==typeof s?(0,r.pi)((0,r.pi)({},e),((n={})[o]=s,n)):(0,r.pi)((0,r.pi)({},e),((i={})[o]={},i))},{});return Object.entries(e.integrations).reduce(function(e,t){var n,o=t[0],s=t[1];return(0,r.pi)((0,r.pi)({},e),((n={})[o]=(0,r.pi)((0,r.pi)({},s),i[o]),n))},{})}},4488:function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var r=n(5853),i=function(e,t){return(0,r.mG)(void 0,void 0,void 0,function(){var n;return(0,r.Jh)(this,function(i){return[2,(n=function(i){return(0,r.mG)(void 0,void 0,void 0,function(){var o;return(0,r.Jh)(this,function(r){switch(r.label){case 0:if(!e(i))return[3,2];return o=n,[4,t()];case 1:return[2,o.apply(void 0,[r.sent()])];case 2:return[2]}})})})(void 0)]})})}},45481:function(e,t,n){"use strict";n.d(t,{Kg:function(){return l},UH:function(){return u},Vl:function(){return c}});var r,i=n(97608),o=/(https:\/\/.*)\/analytics\.js\/v1\/(?:.*?)\/(?:platform|analytics.*)?/,s=function(){var e;return Array.prototype.slice.call(document.querySelectorAll("script")).forEach(function(t){var n,r=null!==(n=t.getAttribute("src"))&&void 0!==n?n:"",i=o.exec(r);i&&i[1]&&(e=i[1])}),e},a=function(){var e;return null!=r?r:null===(e=(0,i.wI)())||void 0===e?void 0:e._cdn},u=function(e){var t=(0,i.wI)();t&&(t._cdn=e),r=e},c=function(){var e=a();return e?e:s()||"https://cdn.segment.com"},l=function(){var e=c();return"".concat(e,"/next-integrations")}},14883:function(e,t,n){"use strict";n.d(t,{$:function(){return h}});var r=n(5853),i=n(19203),o=n(52322),s=n(82836),a={getItem:function(){},setItem:function(){},removeItem:function(){}};try{a=(0,s.j)()&&window.localStorage?window.localStorage:a}catch(e){console.warn("Unable to access localStorage",e)}function u(e){var t=a.getItem(e);return(t?JSON.parse(t):[]).map(function(e){return new o._(e.event,e.id)})}function c(e){var t=a.getItem(e);return t?JSON.parse(t):{}}function l(e){a.removeItem(e)}function d(e,t,n){void 0===n&&(n=0);var r="persisted-queue:v1:".concat(e,":lock"),i=a.getItem(r),o=i?JSON.parse(i):null,s=null===o||new Date().getTime()>o;if(s){a.setItem(r,JSON.stringify(new Date().getTime()+50)),t(),a.removeItem(r);return}!s&&n<3?setTimeout(function(){d(e,t,n+1)},50):console.error("Unable to retrieve lock")}var h=function(e){function t(t,n){var i=e.call(this,t,[])||this,o="persisted-queue:v1:".concat(n,":items"),s="persisted-queue:v1:".concat(n,":seen"),h=[],f={};return d(n,function(){try{h=u(o),f=c(s),l(o),l(s),i.queue=(0,r.ev)((0,r.ev)([],h,!0),i.queue,!0),i.seen=(0,r.pi)((0,r.pi)({},f),i.seen)}catch(e){console.error(e)}}),window.addEventListener("pagehide",function(){if(i.todo>0){var e=(0,r.ev)((0,r.ev)([],i.queue,!0),i.future,!0);try{d(n,function(){var t,n,l,d;t=u(o),n=(0,r.ev)((0,r.ev)([],e,!0),t,!0).reduce(function(e,t){var n;return(0,r.pi)((0,r.pi)({},e),((n={})[t.id]=t,n))},{}),a.setItem(o,JSON.stringify(Object.values(n))),l=i.seen,d=c(s),a.setItem(s,JSON.stringify((0,r.pi)((0,r.pi)({},d),l)))})}catch(e){console.error(e)}}}),i}return(0,r.ZT)(t,e),t}(i.Z)},96526:function(e,t,n){"use strict";n.d(t,{D:function(){return i}});var r=n(1963);function i(e,t){var n=new r.Facade(e,t);return"track"===e.type&&(n=new r.Track(e,t)),"identify"===e.type&&(n=new r.Identify(e,t)),"page"===e.type&&(n=new r.Page(e,t)),"alias"===e.type&&(n=new r.Alias(e,t)),"group"===e.type&&(n=new r.Group(e,t)),"screen"===e.type&&(n=new r.Screen(e,t)),Object.defineProperty(n,"obj",{value:e,writable:!0}),n}},59400:function(e,t,n){"use strict";function r(){return"npm"}n.d(t,{B:function(){return r}})},55217:function(e,t,n){"use strict";n.r(t),n.d(t,{applyDestinationMiddleware:function(){return s},sourceMiddlewarePlugin:function(){return a}});var r=n(5853),i=n(23790),o=n(96526);function s(e,t,n){return(0,r.mG)(this,void 0,void 0,function(){var i,s,a,u,c;return(0,r.Jh)(this,function(l){switch(l.label){case 0:i=(0,o.D)(t,{clone:!0,traverse:!1}).rawEvent(),s=0,a=n,l.label=1;case 1:if(!(s<a.length))return[3,4];return u=a[s],[4,function(t,n){return(0,r.mG)(this,void 0,void 0,function(){var i,s,a;return(0,r.Jh)(this,function(u){switch(u.label){case 0:return i=!1,s=null,[4,n({payload:(0,o.D)(t,{clone:!0,traverse:!1}),integration:e,next:function(e){i=!0,null===e&&(s=null),e&&(s=e.obj)}})];case 1:return u.sent(),i||null===s||(s.integrations=(0,r.pi)((0,r.pi)({},t.integrations),((a={})[e]=!1,a))),[2,s]}})})}(i,u)];case 2:if(null===(c=l.sent()))return[2,null];i=c,l.label=3;case 3:return s++,[3,1];case 4:return[2,i]}})})}function a(e,t){function n(n){return(0,r.mG)(this,void 0,void 0,function(){var s;return(0,r.Jh)(this,function(r){switch(r.label){case 0:return s=!1,[4,e({payload:(0,o.D)(n.event,{clone:!0,traverse:!1}),integrations:null!=t?t:{},next:function(e){s=!0,e&&(n.event=e.obj)}})];case 1:if(r.sent(),!s)throw new i.Y({retry:!1,type:"middleware_cancellation",reason:"Middleware `next` function skipped"});return[2,n]}})})}return{name:"Source Middleware ".concat(e.name),type:"before",version:"0.1.0",isLoaded:function(){return!0},load:function(e){return Promise.resolve(e)},track:n,page:n,identify:n,alias:n,group:n}}},6528:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(92870));function o(e,t){return function(){var n=this.traits(),r=this.properties?this.properties():{};return i.default(n,"address."+e)||i.default(n,e)||(t?i.default(n,"address."+t):null)||(t?i.default(n,t):null)||i.default(r,"address."+e)||i.default(r,e)||(t?i.default(r,"address."+t):null)||(t?i.default(r,t):null)}}t.default=function(e){e.zip=o("postalCode","zip"),e.country=o("country"),e.street=o("street"),e.state=o("state"),e.city=o("city"),e.region=o("region")}},15422:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Alias=void 0;var i=r(n(96902)),o=n(97556);function s(e,t){o.Facade.call(this,e,t)}t.Alias=s,i.default(s,o.Facade),s.prototype.action=function(){return"alias"},s.prototype.type=s.prototype.action,s.prototype.previousId=function(){return this.field("previousId")||this.field("from")},s.prototype.from=s.prototype.previousId,s.prototype.userId=function(){return this.field("userId")||this.field("to")},s.prototype.to=s.prototype.userId},63571:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function e(t){if("object"!=typeof t)return t;if("[object Object]"===Object.prototype.toString.call(t)){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=e(t[r]));return n}return Array.isArray(t)?t.map(e):t}},37355:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Delete=void 0;var i=r(n(96902)),o=n(97556);function s(e,t){o.Facade.call(this,e,t)}t.Delete=s,i.default(s,o.Facade),s.prototype.type=function(){return"delete"}},97556:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Facade=void 0;var i=r(n(6528)),o=n(63571),s=r(n(28496)),a=r(n(85655)),u=r(n(92870)),c=r(n(37182));function l(e,t){t=t||{},this.raw=o.clone(e),"clone"in t||(t.clone=!0),t.clone&&(e=o.clone(e)),"traverse"in t||(t.traverse=!0),"timestamp"in e?e.timestamp=a.default(e.timestamp):e.timestamp=new Date,t.traverse&&c.default(e),this.opts=t,this.obj=e}t.Facade=l;var d=l.prototype;function h(e){return o.clone(e)}d.proxy=function(e){var t,n=e.split("."),r=this[e=n.shift()]||this.obj[e];return r?("function"==typeof r&&(r=r.call(this)||{}),0===n.length||(r=u.default(r,n.join("."))),this.opts.clone?(t=r,o.clone(t)):r):r},d.field=function(e){var t,n=this.obj[e];return this.opts.clone?(t=n,o.clone(t)):n},l.proxy=function(e){return function(){return this.proxy(e)}},l.field=function(e){return function(){return this.field(e)}},l.multi=function(e){return function(){var t=this.proxy(e+"s");if(Array.isArray(t))return t;var n=this.proxy(e);return n&&(n=[this.opts.clone?o.clone(n):n]),n||[]}},l.one=function(e){return function(){var t=this.proxy(e);if(t)return t;var n=this.proxy(e+"s");if(Array.isArray(n))return n[0]}},d.json=function(){var e=this.opts.clone?o.clone(this.obj):this.obj;return this.type&&(e.type=this.type()),e},d.rawEvent=function(){return this.raw},d.options=function(e){var t=this.obj.options||this.obj.context||{},n=this.opts.clone?o.clone(t):t;if(!e)return n;if(this.enabled(e)){var r=this.integrations(),i=r[e]||u.default(r,e);return"object"!=typeof i&&(i=u.default(this.options(),e)),"object"==typeof i?i:{}}},d.context=d.options,d.enabled=function(e){var t=this.proxy("options.providers.all");"boolean"!=typeof t&&(t=this.proxy("options.all")),"boolean"!=typeof t&&(t=this.proxy("integrations.all")),"boolean"!=typeof t&&(t=!0);var n=t&&s.default(e),r=this.integrations();if(r.providers&&r.providers.hasOwnProperty(e)&&(n=r.providers[e]),r.hasOwnProperty(e)){var i=r[e];n="boolean"!=typeof i||i}return!!n},d.integrations=function(){return this.obj.integrations||this.proxy("options.providers")||this.options()},d.active=function(){var e=this.proxy("options.active");return null==e&&(e=!0),e},d.anonymousId=function(){return this.field("anonymousId")||this.field("sessionId")},d.sessionId=d.anonymousId,d.groupId=l.proxy("options.groupId"),d.traits=function(e){var t=this.proxy("options.traits")||{},n=this.userId();for(var r in e=e||{},n&&(t.id=n),e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=null==this[r]?this.proxy("options.traits."+r):this[r]();if(null==i)continue;t[e[r]]=i,delete t[r]}return t},d.library=function(){var e=this.proxy("options.library");return e?"string"==typeof e?{name:e,version:null}:e:{name:"unknown",version:null}},d.device=function(){var e=this.proxy("context.device");("object"!=typeof e||null===e)&&(e={});var t=this.library().name;return e.type||(t.indexOf("ios")>-1&&(e.type="ios"),t.indexOf("android")>-1&&(e.type="android")),e},d.userAgent=l.proxy("context.userAgent"),d.timezone=l.proxy("context.timezone"),d.timestamp=l.field("timestamp"),d.channel=l.field("channel"),d.ip=l.proxy("context.ip"),d.userId=l.field("userId"),i.default(d)},5525:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Group=void 0;var i=r(n(96902)),o=r(n(22408)),s=r(n(85655)),a=n(97556);function u(e,t){a.Facade.call(this,e,t)}t.Group=u,i.default(u,a.Facade);var c=u.prototype;c.action=function(){return"group"},c.type=c.action,c.groupId=a.Facade.field("groupId"),c.created=function(){var e=this.proxy("traits.createdAt")||this.proxy("traits.created")||this.proxy("properties.createdAt")||this.proxy("properties.created");if(e)return s.default(e)},c.email=function(){var e=this.proxy("traits.email");if(e)return e;var t=this.groupId();if(o.default(t))return t},c.traits=function(e){var t=this.properties(),n=this.groupId();for(var r in e=e||{},n&&(t.id=n),e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=null==this[r]?this.proxy("traits."+r):this[r]();if(null==i)continue;t[e[r]]=i,delete t[r]}return t},c.name=a.Facade.proxy("traits.name"),c.industry=a.Facade.proxy("traits.industry"),c.employees=a.Facade.proxy("traits.employees"),c.properties=function(){return this.field("traits")||this.field("properties")||{}}},75216:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Identify=void 0;var i=n(97556),o=r(n(92870)),s=r(n(96902)),a=r(n(22408)),u=r(n(85655)),c=function(e){return e.trim()};function l(e,t){i.Facade.call(this,e,t)}t.Identify=l,s.default(l,i.Facade);var d=l.prototype;d.action=function(){return"identify"},d.type=d.action,d.traits=function(e){var t=this.field("traits")||{},n=this.userId();for(var r in e=e||{},n&&(t.id=n),e){var i=null==this[r]?this.proxy("traits."+r):this[r]();null!=i&&(t[e[r]]=i,r!==e[r]&&delete t[r])}return t},d.email=function(){var e=this.proxy("traits.email");if(e)return e;var t=this.userId();if(a.default(t))return t},d.created=function(){var e=this.proxy("traits.created")||this.proxy("traits.createdAt");if(e)return u.default(e)},d.companyCreated=function(){var e=this.proxy("traits.company.created")||this.proxy("traits.company.createdAt");if(e)return u.default(e)},d.companyName=function(){return this.proxy("traits.company.name")},d.name=function(){var e=this.proxy("traits.name");if("string"==typeof e)return c(e);var t=this.firstName(),n=this.lastName();if(t&&n)return c(t+" "+n)},d.firstName=function(){var e=this.proxy("traits.firstName");if("string"==typeof e)return c(e);var t=this.proxy("traits.name");if("string"==typeof t)return c(t).split(" ")[0]},d.lastName=function(){var e=this.proxy("traits.lastName");if("string"==typeof e)return c(e);var t=this.proxy("traits.name");if("string"==typeof t){var n=c(t).indexOf(" ");if(-1!==n)return c(t.substr(n+1))}},d.uid=function(){return this.userId()||this.username()||this.email()},d.description=function(){return this.proxy("traits.description")||this.proxy("traits.background")},d.age=function(){var e=this.birthday(),t=o.default(this.traits(),"age");return null!=t?t:e instanceof Date?new Date().getFullYear()-e.getFullYear():void 0},d.avatar=function(){var e=this.traits();return o.default(e,"avatar")||o.default(e,"photoUrl")||o.default(e,"avatarUrl")},d.position=function(){var e=this.traits();return o.default(e,"position")||o.default(e,"jobTitle")},d.username=i.Facade.proxy("traits.username"),d.website=i.Facade.one("traits.website"),d.websites=i.Facade.multi("traits.website"),d.phone=i.Facade.one("traits.phone"),d.phones=i.Facade.multi("traits.phone"),d.address=i.Facade.proxy("traits.address"),d.gender=i.Facade.proxy("traits.gender"),d.birthday=i.Facade.proxy("traits.birthday")},1963:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.Delete=t.Screen=t.Page=t.Track=t.Identify=t.Group=t.Alias=t.Facade=void 0;var i=n(97556);Object.defineProperty(t,"Facade",{enumerable:!0,get:function(){return i.Facade}});var o=n(15422);Object.defineProperty(t,"Alias",{enumerable:!0,get:function(){return o.Alias}});var s=n(5525);Object.defineProperty(t,"Group",{enumerable:!0,get:function(){return s.Group}});var a=n(75216);Object.defineProperty(t,"Identify",{enumerable:!0,get:function(){return a.Identify}});var u=n(38004);Object.defineProperty(t,"Track",{enumerable:!0,get:function(){return u.Track}});var c=n(81146);Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return c.Page}});var l=n(44794);Object.defineProperty(t,"Screen",{enumerable:!0,get:function(){return l.Screen}});var d=n(37355);Object.defineProperty(t,"Delete",{enumerable:!0,get:function(){return d.Delete}}),t.default=r(r({},i.Facade),{Alias:o.Alias,Group:s.Group,Identify:a.Identify,Track:u.Track,Page:c.Page,Screen:l.Screen,Delete:d.Delete})},22408:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/.+\@.+\..+/;t.default=function(e){return n.test(e)}},28496:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={Salesforce:!0};t.default=function(e){return!n[e]}},81146:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Page=void 0;var i=r(n(96902)),o=n(97556),s=n(38004),a=r(n(22408));function u(e,t){o.Facade.call(this,e,t)}t.Page=u,i.default(u,o.Facade);var c=u.prototype;c.action=function(){return"page"},c.type=c.action,c.category=o.Facade.field("category"),c.name=o.Facade.field("name"),c.title=o.Facade.proxy("properties.title"),c.path=o.Facade.proxy("properties.path"),c.url=o.Facade.proxy("properties.url"),c.referrer=function(){return this.proxy("context.referrer.url")||this.proxy("context.page.referrer")||this.proxy("properties.referrer")},c.properties=function(e){var t=this.field("properties")||{},n=this.category(),r=this.name();for(var i in e=e||{},n&&(t.category=n),r&&(t.name=r),e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=null==this[i]?this.proxy("properties."+i):this[i]();if(null==o)continue;t[e[i]]=o,i!==e[i]&&delete t[i]}return t},c.email=function(){var e=this.proxy("context.traits.email")||this.proxy("properties.email");if(e)return e;var t=this.userId();if(a.default(t))return t},c.fullName=function(){var e=this.category(),t=this.name();return t&&e?e+" "+t:t},c.event=function(e){return e?"Viewed "+e+" Page":"Loaded a Page"},c.track=function(e){var t=this.json();return t.event=this.event(e),t.timestamp=this.timestamp(),t.properties=this.properties(),new s.Track(t,this.opts)}},44794:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Screen=void 0;var i=r(n(96902)),o=n(81146),s=n(38004);function a(e,t){o.Page.call(this,e,t)}t.Screen=a,i.default(a,o.Page),a.prototype.action=function(){return"screen"},a.prototype.type=a.prototype.action,a.prototype.event=function(e){return e?"Viewed "+e+" Screen":"Loaded a Screen"},a.prototype.track=function(e){var t=this.json();return t.event=this.event(e),t.timestamp=this.timestamp(),t.properties=this.properties(),new s.Track(t,this.opts)}},38004:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Track=void 0;var i=r(n(96902)),o=n(97556),s=n(75216),a=r(n(22408)),u=r(n(92870));function c(e,t){o.Facade.call(this,e,t)}t.Track=c,i.default(c,o.Facade);var l=c.prototype;l.action=function(){return"track"},l.type=l.action,l.event=o.Facade.field("event"),l.value=o.Facade.proxy("properties.value"),l.category=o.Facade.proxy("properties.category"),l.id=o.Facade.proxy("properties.id"),l.productId=function(){return this.proxy("properties.product_id")||this.proxy("properties.productId")},l.promotionId=function(){return this.proxy("properties.promotion_id")||this.proxy("properties.promotionId")},l.cartId=function(){return this.proxy("properties.cart_id")||this.proxy("properties.cartId")},l.checkoutId=function(){return this.proxy("properties.checkout_id")||this.proxy("properties.checkoutId")},l.paymentId=function(){return this.proxy("properties.payment_id")||this.proxy("properties.paymentId")},l.couponId=function(){return this.proxy("properties.coupon_id")||this.proxy("properties.couponId")},l.wishlistId=function(){return this.proxy("properties.wishlist_id")||this.proxy("properties.wishlistId")},l.reviewId=function(){return this.proxy("properties.review_id")||this.proxy("properties.reviewId")},l.orderId=function(){return this.proxy("properties.id")||this.proxy("properties.order_id")||this.proxy("properties.orderId")},l.sku=o.Facade.proxy("properties.sku"),l.tax=o.Facade.proxy("properties.tax"),l.name=o.Facade.proxy("properties.name"),l.price=o.Facade.proxy("properties.price"),l.total=o.Facade.proxy("properties.total"),l.repeat=o.Facade.proxy("properties.repeat"),l.coupon=o.Facade.proxy("properties.coupon"),l.shipping=o.Facade.proxy("properties.shipping"),l.discount=o.Facade.proxy("properties.discount"),l.shippingMethod=function(){return this.proxy("properties.shipping_method")||this.proxy("properties.shippingMethod")},l.paymentMethod=function(){return this.proxy("properties.payment_method")||this.proxy("properties.paymentMethod")},l.description=o.Facade.proxy("properties.description"),l.plan=o.Facade.proxy("properties.plan"),l.subtotal=function(){var e=u.default(this.properties(),"subtotal"),t=this.total()||this.revenue();if(e)return e;if(!t)return 0;if(this.total()){var n=this.tax();n&&(t-=n),(n=this.shipping())&&(t-=n),(n=this.discount())&&(t+=n)}return t},l.products=function(){var e=this.properties(),t=u.default(e,"products");return Array.isArray(t)?t.filter(function(e){return null!==e}):[]},l.quantity=function(){return(this.obj.properties||{}).quantity||1},l.currency=function(){return(this.obj.properties||{}).currency||"USD"},l.referrer=function(){return this.proxy("context.referrer.url")||this.proxy("context.page.referrer")||this.proxy("properties.referrer")},l.query=o.Facade.proxy("options.query"),l.properties=function(e){var t=this.field("properties")||{};for(var n in e=e||{})if(Object.prototype.hasOwnProperty.call(e,n)){var r=null==this[n]?this.proxy("properties."+n):this[n]();if(null==r)continue;t[e[n]]=r,delete t[n]}return t},l.username=function(){return this.proxy("traits.username")||this.proxy("properties.username")||this.userId()||this.sessionId()},l.email=function(){var e=this.proxy("traits.email")||this.proxy("properties.email")||this.proxy("options.traits.email");if(e)return e;var t=this.userId();if(a.default(t))return t},l.revenue=function(){var e=this.proxy("properties.revenue"),t=this.event();return!e&&t&&t.match(/^[ _]?completed[ _]?order[ _]?|^[ _]?order[ _]?completed[ _]?$/i)&&(e=this.proxy("properties.total")),function(e){if(e&&("number"==typeof e||"string"==typeof e&&!isNaN(e=parseFloat(e=e.replace(/\$/g,"")))))return e}(e)},l.cents=function(){var e=this.revenue();return"number"!=typeof e?this.value()||0:100*e},l.identify=function(){var e=this.json();return e.traits=this.traits(),new s.Identify(e,this.opts)}},96902:function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},37182:function(e,t,n){"use strict";var r=n(62244);e.exports=function e(t,n){var i,o;return(void 0===n&&(n=!0),t&&"object"==typeof t)?(i=n,Object.keys(t).forEach(function(n){t[n]=e(t[n],i)}),t):Array.isArray(t)?(o=n,t.forEach(function(n,r){t[r]=e(n,o)}),t):r.is(t,n)?r.parse(t):t}},62244:function(e,t){"use strict";var n=/^(\d{4})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:([ T])(\d{2}):?(\d{2})(?::?(\d{2})(?:[,\.](\d{1,}))?)?(?:(Z)|([+\-])(\d{2})(?::?(\d{2}))?)?)?$/;t.parse=function(e){var t=[1,5,6,7,11,12],r=n.exec(e),i=0;if(!r)return new Date(e);for(var o,s=0;o=t[s];s++)r[o]=parseInt(r[o],10)||0;return r[2]=parseInt(r[2],10)||1,r[3]=parseInt(r[3],10)||1,r[2]--,r[8]=r[8]?(r[8]+"00").substring(0,3):0," "===r[4]?i=new Date().getTimezoneOffset():"Z"!==r[9]&&r[10]&&(i=60*r[11]+r[12],"+"===r[10]&&(i=0-i)),new Date(Date.UTC(r[1],r[2],r[3],r[5],r[6]+i,r[7],r[8]))},t.is=function(e,t){return"string"==typeof e&&(!t||!1!==/^\d{4}-\d{2}-\d{2}/.test(e))&&n.test(e)}},85655:function(e,t,n){"use strict";var r=n(62244),i=n(81477),o=n(15009),s=Object.prototype.toString;e.exports=function(e){return"[object Date]"===s.call(e)?e:"[object Number]"===s.call(e)?new Date(e<315576e5?1e3*e:e):r.is(e)?r.parse(e):i.is(e)?i.parse(e):o.is(e)?o.parse(e):new Date(e)}},81477:function(e,t){"use strict";var n=/\d{13}/;t.is=function(e){return n.test(e)},t.parse=function(e){return new Date(e=parseInt(e,10))}},15009:function(e,t){"use strict";var n=/\d{10}/;t.is=function(e){return n.test(e)},t.parse=function(e){return new Date(1e3*parseInt(e,10))}},52423:function(e){"use strict";let t=self.fetch.bind(self);e.exports=t,e.exports.default=e.exports},92870:function(e){function t(e){return function(t,n,r,o){var s,a=o&&"function"==typeof o.normalizer?o.normalizer:i;n=a(n);for(var u=!1;!u;)!function(){for(s in t){var e=a(s);if(0===n.indexOf(e)){var r=n.substr(e.length);if("."===r.charAt(0)||0===r.length){n=r.substr(1);var i=t[s];if(null==i||!n.length){u=!0;return}t=i;return}}}s=void 0,u=!0}();if(s)return null==t?t:e(t,s,r)}}function n(e,t){return e.hasOwnProperty(t)&&delete e[t],e}function r(e,t,n){return e.hasOwnProperty(t)&&(e[t]=n),e}function i(e){return e.replace(/[^a-zA-Z0-9\.]+/g,"").toLowerCase()}e.exports=t(function(e,t){if(e.hasOwnProperty(t))return e[t]}),e.exports.find=e.exports,e.exports.replace=function(e,n,i,o){return t(r).call(this,e,n,i,o),e},e.exports.del=function(e,r,i){return t(n).call(this,e,r,null,i),e}},25566:function(e){var t,n,r,i=e.exports={};function o(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var u=[],c=!1,l=-1;function d(){c&&r&&(c=!1,r.length?u=r.concat(u):l=-1,u.length&&h())}function h(){if(!c){var e=a(d);c=!0;for(var t=u.length;t;){for(r=u,u=[];++l<t;)r&&r[l].run();l=-1,t=u.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new f(e,t)),1!==u.length||c||a(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}},64801:function(e,t,n){"use strict";let r,i,o;n.d(t,{Jn:function(){return L},qX:function(){return A},Xd:function(){return M},Mq:function(){return F},ZF:function(){return N},KN:function(){return q}});var s=n(78965),a=n(18667),u=n(40230);let c=(e,t)=>t.some(t=>e instanceof t),l=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap,p=new WeakMap,v={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return d.get(e);if("objectStoreNames"===t)return e.objectStoreNames||h.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return g(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function g(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(g(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(t=>{t instanceof IDBCursor&&l.set(t,e)}).catch(()=>{}),p.set(t,e),t}(e);if(f.has(e))return f.get(e);let n="function"==typeof(t=e)?t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(y(this),e),g(l.get(this))}:function(...e){return g(t.apply(y(this),e))}:function(e,...n){let r=t.call(y(this),e,...n);return h.set(r,e.sort?e.sort():[e]),g(r)}:(t instanceof IDBTransaction&&function(e){if(d.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});d.set(e,t)}(t),c(t,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,v):t;return n!==e&&(f.set(e,n),p.set(n,e)),n}let y=e=>p.get(e),m=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],w=new Map;function S(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(w.get(t))return w.get(t);let n=t.replace(/FromIndex$/,""),r=t!==n,i=b.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||m.includes(n)))return;let o=async function(e,...t){let o=this.transaction(e,i?"readwrite":"readonly"),s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&o.done]))[0]};return w.set(t,o),o}v={...o=v,get:(e,t,n)=>S(e,t)||o.get(e,t,n),has:(e,t)=>!!S(e,t)||o.has(e,t)};class _{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(!function(e){let t=e.getComponent();return(null==t?void 0:t.type)==="VERSION"}(e))return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}let I="@firebase/app",E="0.10.18",C=new a.Yd("@firebase/app"),x="[DEFAULT]",O={[I]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},P=new Map,k=new Map,D=new Map;function T(e,t){try{e.container.addComponent(t)}catch(n){C.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function M(e){let t=e.name;if(D.has(t))return C.debug(`There were multiple attempts to register component ${t}.`),!1;for(let n of(D.set(t,e),P.values()))T(n,e);for(let t of k.values())T(t,e);return!0}function A(e,t){let n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}let j=new u.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class R{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new s.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw j.create("app-deleted",{appName:this._name})}}let L="11.2.0";function N(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});let r=Object.assign({name:x,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw j.create("bad-app-name",{appName:String(i)});if(n||(n=(0,u.aH)()),!n)throw j.create("no-options");let o=P.get(i);if(o){if((0,u.vZ)(n,o.options)&&(0,u.vZ)(r,o.config))return o;throw j.create("duplicate-app",{appName:i})}let a=new s.H0(i);for(let e of D.values())a.addComponent(e);let c=new R(n,r,a);return P.set(i,c),c}function F(e=x){let t=P.get(e);if(!t&&e===x&&(0,u.aH)())return N();if(!t)throw j.create("no-app",{appName:e});return t}function q(e,t,n){var r;let i=null!==(r=O[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);let o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){let e=[`Unable to register library "${i}" with version "${t}":`];o&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),C.warn(e.join(" "));return}M(new s.wA(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}let B="firebase-heartbeat-store",G=null;function J(){return G||(G=(function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){let s=indexedDB.open(e,1),a=g(s);return r&&s.addEventListener("upgradeneeded",e=>{r(g(s.result),e.oldVersion,e.newVersion,g(s.transaction),e)}),n&&s.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a})("firebase-heartbeat-database",0,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(B)}catch(e){console.warn(e)}}}).catch(e=>{throw j.create("idb-open",{originalErrorMessage:e.message})})),G}async function U(e){try{let t=(await J()).transaction(B),n=await t.objectStore(B).get(W(e));return await t.done,n}catch(e){if(e instanceof u.ZR)C.warn(e.message);else{let t=j.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});C.warn(t.message)}}}async function z(e,t){try{let n=(await J()).transaction(B,"readwrite"),r=n.objectStore(B);await r.put(t,W(e)),await n.done}catch(e){if(e instanceof u.ZR)C.warn(e.message);else{let t=j.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});C.warn(t.message)}}}function W(e){return`${e.name}!${e.options.appId}`}class K{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new H(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{let n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=$();if((null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{let t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}catch(e){C.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)==null||0===this._heartbeatsCache.heartbeats.length)return"";let t=$(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){let n=[],r=e.slice();for(let i of e){let e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),V(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),V(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=(0,u.L)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return C.warn(e),""}}}function $(){return new Date().toISOString().substring(0,10)}class H{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,u.hl)()&&(0,u.eu)().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await U(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let n=await this.read();return z(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){let n=await this.read();return z(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function V(e){return(0,u.L)(JSON.stringify({version:2,heartbeats:e})).length}M(new s.wA("platform-logger",e=>new _(e),"PRIVATE")),M(new s.wA("heartbeat",e=>new K(e),"PRIVATE")),q(I,E,""),q(I,E,"esm2017"),q("fire-js","")},78965:function(e,t,n){"use strict";n.d(t,{H0:function(){return a},wA:function(){return i}});var r=n(40230);class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let o="[DEFAULT]";class s{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new r.BH;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:o})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let n=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=o){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=o){return this.instances.has(e)}getOptions(e=o){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(let[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;let r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);let o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let n=this.onInitCallbacks.get(t);if(n)for(let r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:e===o?void 0:e,options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}return n||null}normalizeInstanceIdentifier(e=o){return this.component?this.component.multipleInstances?e:o:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new s(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},18667:function(e,t,n){"use strict";var r,i;n.d(t,{Yd:function(){return l},in:function(){return r}});let o=[];(i=r||(r={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";let s={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},a=r.INFO,u={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},c=(e,t,...n)=>{if(t<e.logLevel)return;let r=new Date().toISOString(),i=u[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class l{constructor(e){this.name=e,this._logLevel=a,this._logHandler=c,this._userLogHandler=null,o.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...e),this._logHandler(this,r.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...e),this._logHandler(this,r.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,r.INFO,...e),this._logHandler(this,r.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,r.WARN,...e),this._logHandler(this,r.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...e),this._logHandler(this,r.ERROR,...e)}}},58590:function(e,t,n){"use strict";n.d(t,{v4:function(){return s}});for(var r,i=256,o=[];i--;)o[i]=(i+256).toString(16).substring(1);function s(){var e,t=0,n="";if(!r||i+16>256){for(r=Array(t=256);t--;)r[t]=256*Math.random()|0;t=i=0}for(;t<16;t++)e=r[i+t],6==t?n+=o[15&e|64]:8==t?n+=o[63&e|128]:n+=o[e],1&t&&t>1&&t<11&&(n+="-");return i++,n}},91938:function(e,t,n){"use strict";function r(e,t,n){t.split&&(t=t.split("."));for(var r,i,o=0,s=t.length,a=e;o<s&&"__proto__"!=(i=""+t[o++])&&"constructor"!==i&&"prototype"!==i;)a=a[i]=o===s?n:typeof(r=a[i])==typeof t?r:0*t[o]!=0||~(""+t[o]).indexOf(".")?{}:[]}n.d(t,{N:function(){return r}})},738:function(e,t,n){"use strict";n.d(t,{ZF:function(){return r.ZF}});var r=n(64801);(0,r.KN)("firebase","11.2.0","app")},17292:function(e,t,n){"use strict";n.d(t,{N8:function(){return r.N8},iH:function(){return r.iH},jM:function(){return r.jM}});var r=n(92529)},68838:function(e,t,n){"use strict";n.d(t,{Fm:function(){return o}});var r,i=/bot|crawl|http|lighthouse|scan|search|spider/i;function o(e){return!!e&&(function(){if(r instanceof RegExp)return r;try{r=RegExp(" daum[ /]| deusu/| yadirectfetcher|(?:^|[^g])news(?!sapphire)|(?<! (?:channel/|google/))google(?!(app|/google| pixel))|(?<! cu)bots?(?:\\b|_)|(?<!(?:lib))http|(?<![hg]m)score|@[a-z][\\w-]+\\.|\\(\\)|\\.com\\b|\\btime/|^<|^[\\w \\.\\-\\(?:\\):]+(?:/v?\\d+(?:\\.\\d+)?(?:\\.\\d{1,10})*?)?(?:,|$)|^[^ ]{50,}$|^\\d+\\b|^\\w*search\\b|^\\w+/[\\w\\(\\)]*$|^active|^ad muncher|^amaya|^avsdevicesdk/|^biglotron|^bot|^bw/|^clamav[ /]|^client/|^cobweb/|^custom|^ddg[_-]android|^discourse|^dispatch/\\d|^downcast/|^duckduckgo|^facebook|^getright/|^gozilla/|^hobbit|^hotzonu|^hwcdn/|^jeode/|^jetty/|^jigsaw|^microsoft bits|^movabletype|^mozilla/5\\.0\\s[a-z\\.-]+$|^mozilla/\\d\\.\\d \\(compatible;?\\)$|^mozilla/\\d\\.\\d \\w*$|^navermailapp|^netsurf|^offline|^owler|^php|^postman|^python|^rank|^read|^reed|^rest|^rss|^snapchat|^space bison|^svn|^swcd |^taringa|^thumbor/|^track|^valid|^w3c|^webbandit/|^webcopier|^wget|^whatsapp|^wordpress|^xenu link sleuth|^yahoo|^yandex|^zdm/\\d|^zoom marketplace/|^{{.*}}$|adscanner/|analyzer|archive|ask jeeves/teoma|bit\\.ly/|bluecoat drtr|browsex|burpcollaborator|capture|catch|check\\b|checker|chrome-lighthouse|chromeframe|classifier|cloudflare|convertify|crawl|cypress/|dareboost|datanyze|dejaclick|detect|dmbrowser|download|evc-batch/|exaleadcloudview|feed|firephp|functionize|gomezagent|headless|httrack|hubspot marketing grader|hydra|ibisbrowser|images|infrawatch|insight|inspect|iplabel|ips-agent|java(?!;)|jsjcw_scanner|library|linkcheck|mail\\.ru/|manager|measure|neustar wpm|node|nutch|offbyone|optimize|pageburst|pagespeed|parser|perl|phantomjs|pingdom|powermarks|preview|proxy|ptst[ /]\\d|reputation|resolver|retriever|rexx;|rigor|rss\\b|scanner\\.|scrape|server|sogou|sparkler/|speedcurve|spider|splash|statuscake|supercleaner|synapse|synthetic|tools|torrent|trace|transcoder|url|virtuoso|wappalyzer|webglance|webkit2png|whatcms/|zgrab","i")}catch(e){r=i}return r})().test(e)}},64131:function(e,t,n){"use strict";function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}n.d(t,{Z:function(){return i}});var i=function e(t,n){function i(e,i,o){if("undefined"!=typeof document){"number"==typeof(o=r({},n,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in o)o[a]&&(s+="; "+a,!0!==o[a]&&(s+="="+o[a].split(";")[0]));return document.cookie=e+"="+t.write(i,e)+s}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},i=0;i<n.length;i++){var o=n[i].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(r[a]=t.read(s,a),e===a)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){i(e,"",r({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,r({},this.attributes,t))},withConverter:function(t){return e(r({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},5853:function(e,t,n){"use strict";n.d(t,{CR:function(){return l},Jh:function(){return u},XA:function(){return c},ZT:function(){return i},_T:function(){return s},ev:function(){return d},mG:function(){return a},pi:function(){return o}});var r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function a(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})}function u(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function d(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError}}]);